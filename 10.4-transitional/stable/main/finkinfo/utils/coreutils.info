Package: coreutils
Version: 5.96
Revision: 3
BuildDepends: expat, help2man, libgettext3-dev, gettext-bin, gettext-tools, libiconv-dev
Depends: libgettext3-shlibs, libiconv
NoSetLDFLAGS: true
SetLIBS: -L%p/lib
Source: mirror:gnu:%n/%n-%v.tar.bz2
Source-MD5: bf55d069d82128fd754a090ce8b5acff
Patch: %n.patch
ConfigureParams: --bindir=%p/lib/%N/bin --mandir=%p/lib/%N/share/man --infodir=%p/share/info
CompileScript: <<
  ./configure %c
  make
  case `uname -r` in [1-7].*) ;; *) make check;; esac
<<
InstallScript: <<
  #!/bin/sh
  set -e
  go() { echo "$@"; "$@"; }

  go make install DESTDIR=%d
  go rm -f %i/lib/charset.alias
  go rm -f %i/lib/%N/bin/su %i/lib/%N/bin/users %i/lib/%N/bin/who
  go ln -s share/man %i/lib/%N/man

  for d in bin share/man/man1; do
    dd=`echo "$d" | sed 's,[^/]*,..,g'`/lib/%N/$d
    go mkdir -p "%I/$d"
    go cd "%I/$d"
    for f in "$dd/"*; do
      ff=`basename "$f"`
      case $ff in
        \[) ;;
        *) go ln -s "$f" "g$ff";;
      esac
    done
  done
<<
DocFiles: COPYING README
Description: GNU flavoured basic commands
DescDetail: <<
The GNU Core Utilities are the basic file, shell and text manipulation
utilities of the GNU operating system.  These are the core utilities
which are expected to exist on every operating system.

Previously these utilities were offered as three individual sets of
GNU utilities, fileutils, shellutils, and textutils. Those three have
been combined into a single set of utilities called the coreutils.

The commands are named with 'g' prefix like 'gls' or 'gcp'. If you want
to use them as 'ls' or 'cp', add %p/lib/coreutils/bin to your PATH
or install the coreutils-default package.
<<
DescPort: <<
The exotic commands like mknod may or may not work in a useful manner
on Darwin. Following commands are removed due to their breakage:
- su
- users
- who

charset.alias is deleted because it is empty on Darwin anyway and
causes unnecessary conflicts between packages.
The make check fails on MacOS X <= 10.3 due to lack of lchown().
<<
SplitOff: <<
  Package: coreutils-default
  Description: GNU flavoured basic commands without 'g' prefix
  Depends: coreutils (>= %v-%r)
  Conflicts: fileutils (<< 5), textutils (<< 5), shellutils (<< 5)
  Replaces: fileutils (<< 5), textutils (<< 5), shellutils (<< 5)
  Provides: fileutils, textutils, shellutils
  DescDetail: << 
The GNU Core Utilities are the basic file, shell and text manipulation
utilities of the GNU operating system.  These are the core utilities
which are expected to exist on every operating system.

This package serves the commands without 'g' prefix like 'ls' or 'cp'.
  <<
  DescPort: <<
Symlinks to md5sum and readlink are not created, they are already
contained in the dpkg package.

Symlink to tsort (topological sort) is not created because it breaks
other packages. The GNU version of tsort doesn't output files that are
part of a cycle, while the BSD tsort that ships with Darwin does.
  <<
  InstallScript: <<
    #!/bin/sh
    set -e
    go() { echo "$@"; "$@"; }

    for d in bin share/man/man1; do
      dd=`echo "$d" | sed 's,[^/]*,..,g'`/lib/%N/$d
      go mkdir -p "%i/$d"
      go cd "%I/$d"
      for f in "$dd/"*; do
        ff=`basename "$f"`
        case $ff in
          md5sum*|readlink*|tsort*) ;;
          *) go ln -s "$f" "%i/$d/$ff";;
        esac
      done
    done

    go mkdir -p %i/share/doc/installed-packages
    go touch %i/share/doc/installed-packages/%n
    go ln -s %N %i/share/doc/%n
  <<
<<
SplitOff2: <<
  Package: fileutils
  Description: Placeholder to help migration coreutils
  Depends: coreutils-default (>= %v-%r)
  InstallScript: <<
    mkdir -p %i/share/doc
    ln -s %N %i/share/doc/%n
  <<
<<
SplitOff3: <<
  Package: textutils
  Description: Placeholder to help migration coreutils
  Depends: coreutils-default (>= %v-%r)
  InstallScript: <<
    mkdir -p %i/share/doc
    ln -s %N %i/share/doc/%n
  <<
<<
SplitOff4: <<
  Package: shellutils
  Description: Placeholder to help migration coreutils
  Depends: coreutils-default (>= %v-%r)
  InstallScript: <<
    mkdir -p %i/share/doc
    ln -s %N %i/share/doc/%n
  <<
<<
License: GPL
Maintainer: AIDA Shinra <shinra@j10n.org>
Homepage: http://www.gnu.org/software/coreutils/
