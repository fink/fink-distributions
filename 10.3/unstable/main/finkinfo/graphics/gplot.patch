--- Makefile.orig	Thu Feb 19 11:35:31 2004
+++ Makefile	Thu Feb 19 11:37:59 2004
@@ -55,26 +55,26 @@
 #               lvr.o lvr_io.o  sony laser video disk recorder controller
 #               dq.o            diaquest controller          
 
-DRV_FLAGS = -Dincps -Dinctek -Dinccgmc -Dinccgmb 
+DRV_FLAGS = -Dinctty -Dincxws -Dincps -Dinccgmc
 
-CTR_FLAGS = -O -Dinctty
+CTR_FLAGS = -Dinctty -Dincxws -Dincps -Dinccgmc
 CTR_OBJ = tty.o
 
 XWS_OBJ = xws_cla.o xws_color.o xws_delim.o xws_marker.o xws_polygon.o \
 	xws_polyline.o xws_setup.o xws_text.o drvcla.o
-DRV_OBJ = ps.o tek.o cgmc.o cgmb.o 
+DRV_OBJ = ps.o cgmc.o $(XWS_OBJ)
 #
 # These lines should not be modified.
 DCGM_PATH = drawcgm/
 MACHINE_DEFS = $(DCGM_PATH)unix_defs.h
-F_LINK = f77
+F_LINK = /usr/bin/g77
 AR = ar -ru
-RANLIB =  echo 'fake-ranlib'
+RANLIB =  ranlib
 
 
 # To include the XWS, XLib drivers, or GPLOTAW (athena widget) interface, 
 # uncomment the next line.
-#XLIBS = -lXaw -lXmu -lXt -lX11 
+#XLIBS = -L/usr/X11/lib -lXaw -lXmu -lXt -lX11 
 
 # To include the Decwindows interface, uncomment the next line.
 #DLIBS = -ldwt -lXt -lX11
@@ -83,12 +83,13 @@
 # Note:  The Xt and X11 libraries might be in a different directory on 
 #        your system, so check with your system administrator, and make 
 #        the appropriate changes.
-#MLIBS = -lXm -lXt -lX11
+#MLIBS = /usr/X11R6/lib/libXm.a /usr/X11R6/lib/libXmu.a /usr/X11R6/lib/libXp.a /usr/X11R6/lib/libXt.a /usr/X11R6/lib/libSM.a /usr/X11R6/lib/libICE.a /usr/X11R6/lib/libXext.a /usr/X11R6/lib/libX11.a
+MLIBS = -L/usr/X11R6/lib -lXp -lXpm -lXaw -lXmu -lXext -lXt -lX11
 
 # To build this software on a Sun workstation, uncomment the next lines.
-#AR = ar ru
-#F_LINK = f77
-#RANLIB = ranlib
+AR = ar ru
+F_LINK = g77
+RANLIB = ranlib
 # To include the Sunview driver and gplottool interface, uncomment SVLIBS.
 # To include the Sun CGI B&W driver, uncomment SLIBS.
 # NOTE: Uncomment only one of the following two lines.
@@ -133,15 +134,17 @@
 # To build this software on a Cray, delete the entry $(XLIBS) from the
 # next line.
 LIBS =	$(XLIBS) $(DLIBS) $(MLIBS) $(SLIBS) $(SVLIBS) $(ILIBS) \
-	$(MACHINE_LIBS) -lm 
+	$(MACHINE_LIBS) -lc
 
 FONTS = hload.o
 
 # To add debugging information, uncomment the next line.
-#CFLAGS = -g
+#CFLAGS = -g -I/usr/local
 # To build Gplot on the IRIS, uncomment the next line.
-#CFLAGS = -cckr
-CFLAGS =
+CC = gcc -ansi -bind_at_load -w -I/usr/X11R6/include
+#CC = gcc -g -O2 -DLINUX -ansi -fall-virtual -fcond-mismatch -fdollars-in-identifiers -fenum-int-equiv -fexternal-templates -fno-asm -fno-builtin -fno-strict-prototype -fsigned-bitfields -fsigned-char -fthis-is-variable -funsigned-bitfields -funsigned-char -fwritable-strings -trigraphs
+CFLAGS = $(DEBUG)
+#CFLAGS =
 
 #  ******************************************************************
 #
@@ -162,32 +165,32 @@
 	utils.o carray.o io.o $(FONTS) devices.o emul.o
 
 gplot: $(GPT_OBJ) $(CTR_OBJ) $(DRV_OBJ) $(MACHINE_OBJ)
-	cc  -o $@ $(GPT_OBJ) $(CTR_OBJ) $(DRV_OBJ) $(MACHINE_OBJ) $(LIBS)
+	$(CC) $(DEBUG) -o $@ $(GPT_OBJ) $(CTR_OBJ) $(DRV_OBJ) $(MACHINE_OBJ) $(LIBS)
 
 gtex: $(GTEX_OBJ) ps.o tek.o qms.o cgmb.o cgmc.o tty.o
-	cc -o $@ $(GTEX_OBJ) ps.o tek.o qms.o cgmb.o cgmc.o tty.o -lm 
+	$(CC) -o $@ $(GTEX_OBJ) ps.o tek.o qms.o cgmb.o cgmc.o tty.o /usr/lib/libc.a
 
 gplottool: gplot_suntool.o wint.o ccgm.o cgm.o utils.o io.o carray.o \
 	hload.o emul.o sv.o
-	cc -o $@ gplot_suntool.o wint.o cgm.o utils.o io.o carray.o ccgm.o \
+	$(CC) -o $@ gplot_suntool.o wint.o cgm.o utils.o io.o carray.o ccgm.o \
 	hload.o emul.o sv.o $(LIBS)
 
 # To use the xws driver for gplotdw, include $(XWS_OBJ) instead of xl.o
 gplotdw: gplotdw.o wint.o cgm.o utils.o io.o carray.o ccgm.o emul.o \
 	hload.o xl.o
-	cc -o $@ gplotdw.o wint.o cgm.o utils.o io.o carray.o ccgm.o emul.o \
+	$(CC) -o $@ gplotdw.o wint.o cgm.o utils.o io.o carray.o ccgm.o emul.o \
 	hload.o xl.o $(LIBS)
 
 # To use the xws driver for gplotaw, include $(XWS_OBJ) instead of xl.o
 gplotaw: gplotaw.o wint.o cgm.o ccgm.o utils.o io.o carray.o \
 	hload.o emul.o xl.o $(MACHINE_OBJ)
-	cc -o $@ gplotaw.o wint.o cgm.o ccgm.o utils.o io.o carray.o \
+	$(CC) -o $@ gplotaw.o wint.o cgm.o ccgm.o utils.o io.o carray.o \
 	hload.o emul.o xl.o $(MACHINE_OBJ) $(LIBS)
 
 # To use the xws driver for gplotm, include $(XWS_OBJ) instead of xl.o
 gplotm: gplotm.o wint.o cgm.o utils.o io.o carray.o ccgm.o emul.o \
 	hload.o xl.o $(MACHINE_OBJ)
-	cc -o $@ gplotm.o wint.o cgm.o utils.o io.o carray.o ccgm.o emul.o \
+	$(CC) $(DEBUG) -o $@ gplotm.o wint.o cgm.o utils.o io.o carray.o ccgm.o emul.o \
 	hload.o xl.o $(MACHINE_OBJ) $(LIBS)
 
 drawcgm: $(DCGM_PATH)drawcgm.a
@@ -203,8 +206,8 @@
           drawcgm/Makefile drawcgm/*.h drawcgm/*.f drawcgm/*.doc \
 		drawcgm/*.jbl 
 
-clean: 
-	rm *.o ; rm drawcgm/*.o
+clean:
+	rm -f ./gplot ./gplotm ./*.o
 
 $(DCGM_PATH)drawcgm_test: $(DCGM_PATH)drawcgm_test.o $(DCGM_PATH)drawcgm.a
 	$(F_LINK) -o $@ $(DCGM_PATH)drawcgm_test.o $(DCGM_PATH)drawcgm.a \
@@ -230,25 +233,25 @@
 
 # controlling GPLOT program
 gplot.o: gplot.c defs.h
-	cc -c $(CFLAGS) gplot.c
+	$(CC) -c $(CFLAGS) gplot.c
 
 # controlling GPLOT program for the SUNview driver
 gplot_suntool.o: gplot_suntool.c defs.h
-	cc -c $(CFLAGS) gplot_suntool.c
+	$(CC) -c $(CFLAGS) gplot_suntool.c
 
 # controlling GPLOTAW program for Athena Widgets
 gplotaw.o: gplotaw.c
 # To make gplotaw (xl) compile on the Cray, uncomment the next line
-#       cc -c -DR3_INTRINSICS gplotaw.c
+#       $(CC) -c -DR3_INTRINSICS gplotaw.c
 # To make gplotaw (xws) compile on the Cray, uncomment the next line
-#       cc -c -DR3_INTRINSICS -Dincxws gplotaw.c
+#       $(CC) -c -DR3_INTRINSICS -Dincxws gplotaw.c
 # To use the xws driver for gplotaw, uncomment the next line
-#	cc -c $(CFLAGS) -Dincxws gplotaw.c
+#	$(CC) -c $(CFLAGS) -Dincxws gplotaw.c
 
 # controlling GPLOTDW program for Decwindows 
 gplotdw.o: gplotdw.c defs.h
 # To use the xws driver for gplotdw, uncomment the next line
-#	cc -c $(CFLAGS) -Dincxws gplotdw.c
+#	$(CC) -c $(CFLAGS) -Dincxws gplotdw.c
 
 # controlling GPLOTM program for Motif 
 gplotm.o: gplotm.c defs.h
@@ -257,50 +260,50 @@
 
 # window interface module
 wint.o: wint.c defs.h
-	cc -c $(CFLAGS) wint.c
+	$(CC) -c $(CFLAGS) wint.c
 
 # controlling GTEX program
 gtex.o: gtex.c defs.h
-	cc -c $(CFLAGS) -Dincps -Dincqms gtex.c
+	$(CC) -c $(CFLAGS) -Dincps -Dincqms gtex.c
 
 # all of the cgm specific stuff
 cgm.o: cgm.c defs.h
-	cc -c $(CFLAGS) cgm.c
+	$(CC) -c $(CFLAGS) cgm.c
 
 # all of the clear text cgm specific stuff
 ccgm.o: ccgm.c defs.h ccdefs.h
-	cc -c $(CFLAGS) ccgm.c 
+	$(CC) -c $(CFLAGS) ccgm.c 
 
 # utility functions
 utils.o: utils.c defs.h
-	cc -c $(CFLAGS) -Dinchershey utils.c
+	$(CC) -c $(CFLAGS) -Dinchershey utils.c
 # if we wanted PK fonts also, it would be
-#       cc -c $(CFLAGS) -Dinchershey -Dincpkras utils.c
+#       $(CC) -c $(CFLAGS) -Dinchershey -Dincpkras utils.c
 
 # I/O routines
 io.o: io.c defs.h
-	cc -c $(CFLAGS) $(CTR_FLAGS) io.c   
+	$(CC) -c $(CFLAGS) $(CTR_FLAGS) io.c   
 # To get a gplot usage log file on Unix, uncomment the next line
-#	cc -c $(CTR_FLAGS) -DUSAGE_NAME=\"gplot_usage.log\" io.c 
+#	$(CC) -c $(CTR_FLAGS) -DUSAGE_NAME=\"gplot_usage.log\" io.c 
 
 # devices interface
 devices.o: devices.c defs.h
-	cc -c $(CFLAGS) $(CTR_FLAGS) $(DRV_FLAGS) devices.c
+	$(CC) -c $(CFLAGS) $(CTR_FLAGS) $(DRV_FLAGS) devices.c
 
 # Cell Array libraries
 carray.o: carray.c defs.h
-	cc -c $(CFLAGS) carray.c
+	$(CC) -c $(CFLAGS) carray.c
 
 drvcla.o: drvcla.c defs.h
-	cc -c $(CFLAGS) drvcla.c
+	$(CC) -c $(CFLAGS) drvcla.c
 
 # Emulation package
 emul.o: emul.c defs.h
-	cc -c $(CFLAGS) emul.c
+	$(CC) -c $(CFLAGS) emul.c
 
 # Hershey font support
 hload.o: hload.c hload.h defs.h
-	cc -c $(CFLAGS) hload.c
+	$(CC) -c $(CFLAGS) hload.c
 
 # decoding for the PK format files
 # if fonts are available we must say here where they are
@@ -309,100 +312,100 @@
 # (1000 implies 10 point fonts at 300 pt/in), e.g.,
 # /usr/staff/andrews/pk/1000/cmr10.pk
 pkras.o: pkras.c defs.h
-	cc -c -DUNIXFONTS=\"/usr/staff/andrews/pk\" pkras.c
+	$(CC) -c -DUNIXFONTS=\"/usr/staff/andrews/pk\" pkras.c
 
 #TTY controller
 tty.o: tty.c defs.h
-	cc -c $(CFLAGS) tty.c
+	$(CC) -c $(CFLAGS) tty.c
 
 # LVR controller
 lvr.o: lvr.c lvr_defines.h defs.h
-	cc -c $(CFLAGS) lvr.c
+	$(CC) -c $(CFLAGS) lvr.c
 #       to change audit file name, lvr port
-#       cc -c -DAUDIT_FILE="lvr.dat" -DDEFAULT_PORT="ttyd2" lvr.c
+#       $(CC) -c -DAUDIT_FILE="lvr.dat" -DDEFAULT_PORT="ttyd2" lvr.c
 
 dq.o: dq.c defs.h
-	cc -c $(CFLAGS) dq.c
+	$(CC) -c $(CFLAGS) dq.c
 
 lvr_io.o: lvr_io.c lvr_defines.h
-	cc -c $(CFLAGS) lvr_io.c
+	$(CC) -c $(CFLAGS) lvr_io.c
 #       to turn on debug I/O printout
-#       cc -c -DDEBUG_IO lvr_io.c
+#       $(CC) -c -DDEBUG_IO lvr_io.c
 
 # Postscript device
 ps.o: ps.c defs.h
-	cc -c $(CFLAGS) ps.c
+	$(CC) -c $(CFLAGS) ps.c
 
 # Tektronix devices
 tek.o: tek.c defs.h
-	cc -c $(CFLAGS) tek.c
+	$(CC) -c $(CFLAGS) tek.c
 
 # Clear text CGM driver
 cgmc.o: cgmc.c defs.h
-	cc -c $(CFLAGS) cgmc.c
+	$(CC) -c $(CFLAGS) cgmc.c
 
 # Binary CGM driver
 cgmb.o: cgmb.c defs.h
-	cc -c $(CFLAGS) cgmb.c
+	$(CC) -c $(CFLAGS) cgmb.c
 
 # Sun CGI driver
 sundriv.o: sundriv.c defs.h
-	cc -c $(CFLAGS) sundriv.c
+	$(CC) -c $(CFLAGS) sundriv.c
 
 # Silicon Graphics GI driver
 igl.o:	igl.c defs.h
-	cc -c $(CFLAGS) igl.c
+	$(CC) -c $(CFLAGS) igl.c
 
 # the sunview driver
 sv.o:	sv.c defs.h
-	cc -c $(CFLAGS) sv.c
+	$(CC) -c $(CFLAGS) sv.c
 
 # the Xlib driver
 xl.o:	xl.c defs.h
-	cc -c $(CFLAGS) xl.c
+	$(CC) -c $(CFLAGS) xl.c
 
 
 #-------------- X Window System driver (xws) --------------------------
 
 xws_setup.o:	/usr/include/stdio.h \
 		/usr/include/strings.h \
-		/usr/include/X11/Intrinsic.h \
-		/usr/include/X11/StringDefs.h \
-		/usr/include/X11/Xutil.h \
-		/usr/include/X11/cursorfont.h \
+		/usr/X11R6/include/X11/Intrinsic.h \
+		/usr/X11R6/include/X11/StringDefs.h \
+		/usr/X11R6/include/X11/Xutil.h \
+		/usr/X11R6/include/X11/cursorfont.h \
 		defs.h xws_defs.h
 
 xws_delim.o:    /usr/include/stdio.h \
 		/usr/include/strings.h \
-		/usr/include/X11/Intrinsic.h \
-		/usr/include/X11/Xutil.h \
+		/usr/X11R6/include/X11/Intrinsic.h \
+		/usr/X11R6/include/X11/Xutil.h \
 		defs.h xws_defs.h
 
 xws_color.o:	/usr/include/stdio.h \
 		/usr/include/math.h \
-		/usr/include/X11/Intrinsic.h \
-		/usr/include/X11/Xutil.h \
-		/usr/include/X11/Xatom.h \
+		/usr/X11R6/include/X11/Intrinsic.h \
+		/usr/X11R6/include/X11/Xutil.h \
+		/usr/X11R6/include/X11/Xatom.h \
 		defs.h xws_defs.h xws_color.h
 
-xws_polyline.o:/usr/include/X11/Intrinsic.h \
+xws_polyline.o:/usr/X11R6/include/X11/Intrinsic.h \
 		defs.h xws_defs.h
 
 xws_polygon.o:	/usr/include/stdio.h \
-		/usr/include/X11/Intrinsic.h \
+		/usr/X11R6/include/X11/Intrinsic.h \
 		defs.h xws_defs.h xws_fill.h
 
-xws_marker.o:	/usr/include/X11/Intrinsic.h \
+xws_marker.o:	/usr/X11R6/include/X11/Intrinsic.h \
 		defs.h xws_defs.h
 
 xws_text.o:	/usr/include/strings.h \
-		/usr/include/X11/Intrinsic.h \
-		/usr/include/X11/Xatom.h \
+		/usr/X11R6/include/X11/Intrinsic.h \
+		/usr/X11R6/include/X11/Xatom.h \
 		defs.h xws_defs.h
 
 xws_cla.o:      /usr/include/stdio.h \
 		/usr/include/math.h \
-		/usr/include/X11/Intrinsic.h \
+		/usr/X11R6/include/X11/Intrinsic.h \
 		defs.h xws_defs.h xws_color.h
 #-----------------------------------------------------------------------------
 # DrawCGM and CGMGen, and test routines
--- utils.c.orig	Thu Feb 19 11:38:55 2004
+++ utils.c	Thu Feb 19 11:38:59 2004
@@ -10,6 +10,7 @@
 #include time
 static tbuffer_t time_b;
 #else
+/*PCMDI - changed from <sys/types.h> to <sys/types.h> */
 #include <sys/types.h>
 #include <sys/times.h>
 #ifdef CRAY1
@@ -57,6 +58,8 @@
 {
   char buffer[80];
   
+  return (1);
+/* DNW - return without printing any information 
   times(&time_b);
 #ifdef VAXC
   proc_used = time_b.proc_user_time * 0.01 - proc_used;
@@ -70,10 +73,11 @@
 #ifndef VAXC
   fprintf(stderr, "\n");
 #endif
-  /* and put it in the log file (if it exists) */
+  * and put it in the log file (if it exists) *
   sprintf(buffer, "%.2f %d %d", proc_used, elaps_time, pages_done);
   log_line(buffer, 0, NULL, 1, 0, 3);
   return(1);
+*/
 }
 
 /* take care of necessary memory, note must clear by hand for compatibility */
@@ -242,7 +246,7 @@
 #endif
     init_check(eject, "eject", 'E', onoff, "0");
     init_check(copies, "copies", 'c', integer, "1");
-    init_check(debug, "debug", 'D', onoff, "0");
+    /*init_check(debug, "debug", 'D', onoff, "0"); DNW - turn debugging off */
     init_check(list, "list", 'l', onoff, "0");
     init_check(pxl_in, "pxl_in", 'P', real, "0.0");
     init_check(ypxl_in, "ypxl_in", 'Q',	real, "0.0");
@@ -287,7 +291,9 @@
     }
   }
   /* set the other arguments */
-  *to_screen = opt[(int) screen].set;
+  /* DNW - remove all output to the screen */
+  /**to_screen = opt[(int) screen].set;*/
+  *to_screen = 1;
   *do_list = opt[(int) list].set;
   
   /* now send off info to the logging line routine */
@@ -302,7 +308,7 @@
 #define may_override(name) if (opt[(int) name].set) switch (opt[(int) name].tag) {	    \
 											    case integer: out_info->name = opt[(int) name].val.i; break;			    \
 											    case real: out_info->name = opt[(int) name].val.r; break;			    \
-											    case lst: case str: strcpy(out_info->name, opt[(int) name].val.str); break;}
+											    case lst: case str: strcpy(&out_info->name, opt[(int) name].val.str); break;}
 {
   /* and now overide the device if the command line wants us to */
   may_override(pxl_in);
@@ -363,7 +369,8 @@
   c1->ind_prec		= 16;
   c1->col_prec		= 8;
   c1->col_i_prec		= 8;
-  c1->max_c_index		= 63;
+/*  c1->max_c_index		= 63;		RLM 12oct94*/
+  c1->max_c_index		= 255;
   for (i=0; i<3; ++i) {
     c1->c_v_extent.min[i] = 0;
     c1->c_v_extent.max[i] = 255;
