Package: libgeotiff2-shlibs
Version: 1.4.3
Revision: 5
Description: GeoTIFF handling library
License: BSD
Homepage: http://trac.osgeo.org/geotiff/
Maintainer: BABA Yoshihiko <babayoshihiko@mac.com>
Source: http://download.osgeo.org/geotiff/libgeotiff/libgeotiff-%v.tar.gz
Source-Checksum: SHA256(b8510d9b968b5ee899282cdd5bef13fd02d5a4c19f664553f81e31127bc47265)

Depends: <<
	libjpeg9-shlibs,
	libproj19-shlibs,
	libtiff6-shlibs
<<
BuildDepends: <<
	fink (>= 0.32),
	fink-package-precedence,
	flag-sort,
	libjpeg9,
	libproj19,
	libtiff6
<<
Replaces: libgeotiff2-bin

# using flag-sort to circumvent a bug in upstream code (confusion between
# CFLAGS and CPPFLAGS) - see https://github.com/OSGeo/libgeotiff/issues/52
SetCC: flag-sort -r gcc
SetCXX: flag-sort -r g++
SetCPPFLAGS: -Os -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
ConfigureParams: <<
	--with-zip=/usr/include \
	--with-jpeg=%p/include \
	--with-libtiff=%p/include \
	--enable-incode-epsg
<<
PatchScript: <<
	# Patch configure not to link like Puma on Yosemite
	perl -pi -e 's/(10\.\[012\])(\*)/\1\,.\2/' configure
<<
CompileScript: <<
	%{default_script}
	fink-package-precedence --prohibit-bdep=libgeotiff2 .
<<
InstallScript: <<
#!/bin/sh -xe
  make install prefix=%i
<<
DocFiles: AUTHORS COPYING ChangeLog INSTALL LICENSE NEWS README README_BIN
Shlibs: %p/lib/libgeotiff.2.dylib 5.0.0 %n (>= 1.4.3-1)

SplitOff: <<
	Package: libgeotiff2
	Depends: %N (= %v-%r)
	Conflicts: <<
		libgeotiff,
		libgeotiff2,
		libgeotiff5
	<<
	Replaces: <<
		libgeotiff,
		libgeotiff2,
		libgeotiff5
	<<
	BuildDependsOnly: True
	Files: <<
		include
		lib/libgeotiff.{a,dylib,la}
	<<
	DocFiles: AUTHORS COPYING ChangeLog INSTALL LICENSE NEWS README README_BIN
<<

SplitOff2: <<
	Package: libgeotiff-bin
	Depends: <<
  		%N (>= %v-%r),
  		libjpeg9-shlibs,
  		libproj19-shlibs,
  		libtiff6-shlibs
	<<
	Replaces: <<
		libgeotiff,
		libgeotiff2,
		libgeotiff2-bin,
		libgeotiff5-bin
	<<
	Files: <<
		bin
		share/man
	<<
	DocFiles: AUTHORS COPYING ChangeLog INSTALL LICENSE NEWS README README_BIN
<<

SplitOff3: <<
	Package: libgeotiff2-bin
	Description: OBSOLETE: use 'libgeotiff-bin' instead
	RuntimeDepends: <<
		libgeotiff-bin (>= %v-%r),
		fink-obsolete-packages
	<<
	InstallScript: <<
		mkdir -p %i/share/doc/installed-packages
		touch %i/share/doc/installed-packages/%n
	<<
<<
