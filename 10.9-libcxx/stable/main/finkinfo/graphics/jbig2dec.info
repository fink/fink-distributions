Package: jbig2dec
Version: 0.17
Revision: 1
Maintainer: Daniel Johnson <daniel@daniel-johnson.org>

Description: Decoder for JBIG2 image compression format
DescDetail: <<
	JBIG2 is designed for lossy or lossless encoding of 'bilevel' (1-bit
	monochrome) images at moderately high resolution, and in particular
	scanned paper documents. In this domain it is very efficient, offering
	compression ratios on the order of 100:1.

	This is a decoder only implementation, and currently is in the alpha
	stage, meaning it doesn't completely work yet. However, we are
	maintaining parity with available encoders, so it is useful for real
	work.
<<
License: GPL
Homepage: http://jbig2dec.sourceforge.net/

Depends: <<
	lib%N-shlibs (= %v-%r),
	libpng16-shlibs,
	libgettext8-shlibs
<<
BuildDepends: <<
	libpng16, 
	libgettext8-dev,
	libiconv-dev,
	autoconf2.6,
	automake1.15,
	libtool2
<<
SourceRename: %n-%v.tar.gz
Source: https://github.com/ArtifexSoftware/%n/archive/%v.tar.gz
Source-Checksum: SHA256(fc9e0a53b7fa7e8c62098ff270707abf83989deb6b9f7d34d83bb77241af962c)

PatchScript: <<
	%{default_script}
	sed -i.bak 's|not result|0|g' test_jbig2dec.py
<<

ConfigureParams: --disable-dependency-tracking --disable-static --with-libpng=%p
CompileScript: <<
	#!/bin/sh -ev
	./autogen.sh
	%{default_script}
<<

SetCFLAGS: -Os
SetLDFLAGS: -lintl -Wl,-dead_strip_dylibs

InfoTest: TestScript: make check || exit 2

InstallScript: <<
	make install DESTDIR=%d
<<

DocFiles: CHANGES COPYING LICENSE README

SplitOff: <<
	Package: lib%N-shlibs
	Depends: libpng16-shlibs
	Files: lib/*.*.dylib
	Shlibs: <<
		%p/lib/lib%N.0.dylib 1.0.0 %n (>= 0.9-1)
	<<
	DocFiles: CHANGES COPYING LICENSE README
<<

SplitOff2: <<
	Package: lib%N-dev
	Depends: lib%N-shlibs (= %v-%r)
	Files: include lib
	DocFiles: CHANGES COPYING LICENSE README
	BuildDependsOnly: true
<<

DescPackaging: <<
	Since 0.17 the tarball is retrieved from the jbig2dec GitHub archive
	which requires automake, autoconf, and libtool2 called by the
	autogen.sh script; with this previous patches to configure are no
	longer needed.
<<
