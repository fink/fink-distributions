Package: libjpeg8-turbo
Version: 2.1.4
Revision: 1
Description: Vectorised high speed libjpeg
DescDetail: <<
	libjpeg-turbo is a high-speed version of libjpeg for x86, x86-64,
	powerpc, arm processors which uses SIMD instructions (MMX, SSE2, AVX2
	Altivec, Neon etc.) to accelerate baseline JPEG compression and
	decompression. libjpeg-turbo is generally 2-4x as fast as the unmodified
	version of libjpeg, all else being equal.

	libjpeg-turbo was originally based on libjpeg/SIMD by Miyasaka Masaru,
	but the TigerVNC and VirtualGL projects made numerous enhancements to
	the codec, including improved support for Mac OS X, 64-bit support,
	support for 32-bit and big endian pixel formats (RGBA, ABGR, etc.),
	accelerated Huffman encoding/decoding, and various bug fixes. The goal
	was to produce a fully open source codec that could replace the
	partially closed source TurboJPEG/IPP codec used by VirtualGL and
	TurboVNC. libjpeg-turbo generally achieves 80-120% of the performance
	of TurboJPEG/IPP. It is faster in some areas but slower in others.
<<
DescPackaging: <<
	libjpeg8-turbo is API/ABI compatible with libjpeg8 and can be used anywhere
	libjpeg.8.dylib is used. It's buried in %p/lib/%n to avoid 
	conflicts so packages need to be told to look there to use it.
	No longer trying to emulate <1.2.90 as no version-info in CMakefiles.
	Fixing @rpath install names to get Shlibs right.
<<

License: BSD
Homepage: http://www.libjpeg-turbo.org/
Maintainer: Daniel Johnson <daniel@daniel-johnson.org>

Source: mirror:sourceforge:libjpeg-turbo/libjpeg-turbo-%v.tar.gz
Source-Checksum: SHA256(d3ed26a1131a13686dfca4935e520eb7c90ae76fbc45d98bb50a8dc86230342b)

Depends: %n-shlibs (= %v-%r)
BuildDepends: cmake, nasm (>= 2.09-1)
BuildDependsOnly: true
Conflicts: %n-shlibs (<< 2.0.0)

CompileScript: <<
	cmake -G'Unix Makefiles' -DWITH_JPEG8=1 -DWITH_JAVA=0 -DENABLE_STATIC=0 -DCMAKE_INSTALL_PREFIX=%p/lib/%n .
	make
	fink-package-precedence --depfile-ext='\.d' --prohibit-bdep %n .
<<

InfoTest: TestScript: make test || exit 2

InstallScript: <<
	make install DESTDIR=%d
	install_name_tool -id %p/lib/%N/lib/libjpeg.8.2.2.dylib %i/lib/%N/lib/libjpeg.8.2.2.dylib
	install_name_tool -id %p/lib/%N/lib/libturbojpeg.0.2.0.dylib %i/lib/%N/lib/libturbojpeg.0.2.0.dylib
<<

DocFiles: change.log ChangeLog.md libjpeg.txt LICENSE.md README.ijg README.md structure.txt usage.txt wizard.txt

SplitOff: <<
	Package: %N-shlibs
	
	Files: lib/%N/lib/libjpeg.*.*.dylib lib/%N/lib/libturbojpeg.*.*.dylib
	Shlibs: <<
		%p/lib/%N/lib/libjpeg.8.2.2.dylib 8.0.0 %n (>= 2.1.4-1)
		%p/lib/%N/lib/libturbojpeg.0.2.0.dylib 0.0.0 %n (>= 1.0.90-1)
	<<
	
	DocFiles: change.log ChangeLog.md libjpeg.txt LICENSE.md README.ijg README.md structure.txt usage.txt wizard.txt doc/html
<<
