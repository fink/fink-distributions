Info2: <<
Package: fortune-mod
Version: 3.24.0
Revision: 1
Epoch: 1
Type: testperl (5.34.1)
Description: Fortune cookies on demand
Maintainer: None <fink-devel@lists.sourceforge.net>
License: BSD
DescDetail: <<
 The fortune package displays epigrams selected randomly from a
 selection of fortune files. This is an enhanced version of the BSD
 program. The data files (which can be shared) are contained in the
 'fortunes-min', 'fortunes', and 'fortunes-off' packages.

 These are the machine-dependent parts of the fortune package,
 i.e. the fortune program and the programs used for generating the
 data files.
<<
DescUsage: <<
 To see a new fortune every time a Terminal window is opened, add the
 following line to ~/.login or ~/.bashrc:

 %p/bin/fortune
<<
HomePage: https://www.shlomifish.org/open-source/projects/fortune-mod/
BuildDepends: <<
	cmake,
	fink (>= 0.32),
	fink-buildenv-modules,
	fink-package-precedence,
	recode3-dev,
	rinutils
<<
Depends: recode3-shlibs
Recommends: fortunes-min, fortunes
Suggests: fortune-cookie-db
Source: https://www.shlomifish.org/open-source/projects/fortune-mod/arcs/%n-%v.tar.xz
Source-Checksum: SHA256(1f387877254e95eab61f937257b42609f29b994ef0571531655bbfc3a2ac74ac)
# Self-test rebuilds this thing using cmake...yikes!
# Test::Valgrind not available through Fink.
PatchFile: %n.patch
PatchFile-MD5: a857c11640fc81239b182add221f987c
PatchScript: <<
#!/bin/sh -ev
	. %p/sbin/fink-buildenv-cmake.sh
	# Hardcode a specific perl (in .patch) to avoid needing a
	# systemperl suite of .info just for self-test purposes.
	quoted_args=`echo "$FINK_CMAKE_ARGS" | sed 's/ /", "/g'`
	sed "s|@FINK_PREFIX@|%p|g; s|@FINK_CMAKE_ARGS@|\"$quoted_args\"|" < %{PatchFile} | patch -p1
	# If we don't have that one in %p but we do have the
	# perlXXX-core dependency satisfied, then assume that's what
	# version system-perl is (hate apple's non-teeny-version
	# naming).
	if [ -x %p/bin/perl%type_raw[testperl] ]; then
		perl -pi -e 's,"/usr/bin/perl","%p/bin/perl%type_raw[testperl]",' CMakeLists.txt
	fi
<<
CompileScript: <<
#!/bin/sh -ev
	. %p/sbin/fink-buildenv-cmake.sh
	mkdir finkbuild
	pushd finkbuild
	cmake $FINK_CMAKE_ARGS \
		-DCMAKE_C_FLAGS="-MD -I%p/include" \
		-DCOOKIEDIR=%p/share/fortunes \
		-DLOCALDIR=%p/share/fortunes ..
	make all generate_man_page
	popd
	#/usr/bin/perl fortune/gen-fortune-man-page.pl --cookiedir %p/share/fortunes --ocookiedir %p/share/fortunes/off --output fortune/fortune.6
	fink-package-precedence --depfile-ext='\.d' .
<<
# Tests are a complicated pile recompiling without propagation of
# flags, installing the whole binary suite in separate testing
# locations via hard-to-trace flags, and sporadic hangs. The 'fortune'
# binary seems to work, so we'll say that's good enough for now.
#InfoTest: <<
#	TestDepends: <<
#		perl%type_pkg[testperl]-core,
#		path-tiny-pm%type_pkg[testperl],
#		file-find-object-pm%type_pkg[testperl],
#		test-differences-pm
#	<<
#	TestScript: <<
#	#!/bin/sh -ev
#		pushd finkbuild
#			make check || exit 2
#		popd
#	<<
#<<
InstallScript: <<
#!/bin/sh -ev
	pushd finkbuild
		make install DESTDIR=%d
		mv %i/games/* %i/bin
		rmdir %i/games
	popd
	gzip -6  %i/share/man/man1/strfile.1
<<
PostInstScript: <<
 echo
 echo " * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *"
 echo "NOTE:"
 echo
 echo "At least one of the following additional packages MUST be"
 echo "installed before fortune-mod can provide fortune cookies:"
 echo
 echo " fortunes-min"
 echo " fortunes"
 echo " fortunes-de"
 echo " fortunes-off"
 echo
 echo " * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *"
<<
DocFiles: <<
 ChangeLog cookie-files COPYING.txt INDEX Notes Offensive README
  TODO
<<
Splitoff: <<
 Package: fortunes-off
 Description: Files of offensive fortune cookies
 DescDetail: <<
  This package contains 'fortune cookies' which some may consider to
  be offensive. Please do not install this package if you or your
  users are easily offended. You'll need the fortune-mod package to
  display the cookies.
 <<
 Provides: fortune-cookie-db
 Recommends: %N
 Files: share/fortunes/off
 DocFiles: <<
 ChangeLog cookie-files COPYING.txt INDEX Notes Offensive README
  TODO
 <<
<<
Splitoff2: <<
 Package: fortunes-min
 Description: Files of the basic fortune cookie set
 DescDetail: <<
  This package contains a small number of 'fortune cookies' for the
  bandwidth conscious. There are over 15000 different 'fortune cookies'
  in the fortunes package. You'll need the fortune-mod package to display
  the cookies.
 <<
 Provides: fortune-cookie-db
 Recommends: %N
 Files: <<
  share/fortunes/fortunes
  share/fortunes/fortunes.dat
  share/fortunes/fortunes.u8
  share/fortunes/literature
  share/fortunes/literature.dat
  share/fortunes/literature.u8
  share/fortunes/riddles
  share/fortunes/riddles.dat
  share/fortunes/riddles.u8
  <<
 DocFiles: <<
 ChangeLog cookie-files COPYING.txt INDEX Notes Offensive README
  TODO
 <<
<<
Splitoff3: <<
 Package: fortunes
 Description: Data files containing fortune cookies
 DescDetail: <<
  There are by far over 15000 different 'fortune cookies' in this
  package. You'll need the fortune-mod package to display the cookies.
 <<
 Provides: fortune-cookie-db
 Recommends: %N
 Files: share/fortunes
 DocFiles: <<
 ChangeLog cookie-files COPYING.txt INDEX Notes Offensive README
  TODO
 <<
<<
DescPackaging: <<
  Original maintainer: Carsten Klapp <carstenklapp@users.sourceforge.net>
<<
<<
