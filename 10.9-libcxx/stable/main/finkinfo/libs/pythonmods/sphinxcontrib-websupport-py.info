Info2: <<

Package: sphinxcontrib-websupport-py%type_pkg[python]
Version: 1.1.0
Revision: 1
License: OSI-Approved
Type: python (2.7 3.4 3.5 3.6 3.7 3.8)

Depends: python%type_pkg[python]
BuildDepends: setuptools-tng-py%type_pkg[python]

Source: https://files.pythonhosted.org/packages/source/s/sphinxcontrib-websupport/sphinxcontrib-websupport-%v.tar.gz
Source-MD5: ca6435e7b4eb9408df4f54972361e9d3

PatchFile: %{Ni}.patch
PatchFile-MD5: 41244ce9987e3306cb263474098329e4
PatchScript: sed -e 's|@FINK_PREFIX@|%p|g' -e 's|@FINK_BUILDDIR@|%b|g' <  %{PatchFile} | patch -p1

CompileScript: %p/bin/python%type_raw[python] setup.py build

InstallScript: %p/bin/python%type_raw[python] setup.py install --root=%d

DocFiles: CHANGES LICENSE PKG-INFO README.rst

InfoTest: <<
  # Needs sphinx and xapianXX-py to run tests (circular dependency)
  #  sphinx-py%type_pkg[python] (>= 1.8.2),
  #  (%type_pkg[python]  = 27) xapian22-py%type_pkg[python],
  #  (%type_pkg[python] >= 34) xapian30-py%type_pkg[python]
  TestDepends: <<
    mock-py%type_pkg[python],
    pytest-py%type_pkg[python],
    six-py%type_pkg[python],
    sqlalchemy-py%type_pkg[python],
    whoosh-py%type_pkg[python]
  <<
  TestScript: <<
    #!/bin/sh -ev
    # check for presence of sphinx-build and %v >= 1.8.2
    export SPHINX_VERSION=`%p/bin/sphinx-build%type_raw[python] --version 2>&1`
    if [ ! -x %p/bin/sphinx-build%type_raw[python] ] ; then
      echo '\nNot running tests because sphinx-py%type_pkg[python] is not installed.\n'
      exit 0;
    else
      # sphinx-build must be >= 1.8.2
      # sphinx-1.4 and sphinx-1.8 output --version differently.
      if dpkg --compare-versions ${SPHINX_VERSION: -5} lt 1.8.2 1>/dev/null; then
        echo '\nSphinx-%type_pkg[python] version less than 1.8.2. Not running tests.\n'
        exit 0
      fi
    fi
    # check for presence of xapian bindings
    if [ ! -x %p/lib/python%type_raw[python]/site-packages/xapian/_xapian.cpython-%type_pkg[python]m-darwin.so ] && [ ! -x %p/lib/python%type_raw[python]/site-packages/xapian/_xapian.so ]; then
      echo '\nNot running tests because xapian-py bindings are not installed.\n'
      exit 0;
    fi
    # only run tests if sphinx (>=1.8.2) and xapianNN-pyXX are present.
    #%p/bin/tox-py%type_pkg[python] -e py%type_pkg[python] || exit 2
    %p/bin/python%type_raw[python] -m pytest tests/ -v || exit 2
  <<
<<

Description: Sphinx documentation for web applications
DescPort: <<
	PatchFile is upstream commits after v1.1.0.
<<
Homepage: http://www.sphinx-doc.org
Maintainer: Karl-Michael Schindler <karl-michael.schindler@web.de>
# Info2
#		export PYTHONPATH=%b/build/lib
#		%p/bin/tox-py%type_pkg[python] || exit 2

<<
