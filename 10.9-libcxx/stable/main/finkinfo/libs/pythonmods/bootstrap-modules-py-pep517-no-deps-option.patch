
--- pep517/build.py.orig	2023-11-08 06:08:41
+++ pep517/build.py	2025-12-22 22:35:13
@@ -54,14 +54,15 @@
     return system
 
 
-def _do_build(hooks, env, dist, dest):
+def _do_build(hooks, env, dist, dest, no_deps=False):
     get_requires_name = 'get_requires_for_build_{dist}'.format(**locals())
     get_requires = getattr(hooks, get_requires_name)
     reqs = get_requires({})
     log.info('Got build requires: %s', reqs)
 
-    env.pip_install(reqs)
-    log.info('Installed dynamic build dependencies')
+    if not no_deps:
+        env.pip_install(reqs)
+        log.info('Installed dynamic build dependencies')
 
     with tempfile.TemporaryDirectory() as td:
         log.info('Trying to build %s in %s', dist, td)
@@ -72,7 +73,7 @@
         shutil.move(source, os.path.join(dest, os.path.basename(filename)))
 
 
-def build(source_dir, dist, dest=None, system=None):
+def build(source_dir, dist, dest=None, system=None, no_deps=False):
     system = system or load_system(source_dir)
     dest = os.path.join(source_dir, dest or 'dist')
     os.makedirs(dest, exist_ok=True)
@@ -83,8 +84,9 @@
     )
 
     with BuildEnvironment() as env:
-        env.pip_install(system['requires'])
-        _do_build(hooks, env, dist, dest)
+        if not no_deps:
+            env.pip_install(system['requires'])
+        _do_build(hooks, env, dist, dest, no_deps=no_deps)
 
 
 parser = argparse.ArgumentParser()
@@ -103,6 +105,11 @@
     default=False,
 )
 parser.add_argument(
+    '--no-deps', '-n',
+    action='store_true',
+    default=False,
+)
+parser.add_argument(
     '--out-dir', '-o',
     help="Destination in which to save the builds relative to source dir",
 )
@@ -119,7 +126,7 @@
     )))
 
     for dist in dists:
-        build(args.source_dir, dist, args.out_dir)
+        build(args.source_dir, dist, args.out_dir, no_deps=args.no_deps)
 
 
 if __name__ == '__main__':
