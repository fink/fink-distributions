# -*- coding: ascii; tab-width: 4; x-counterpart: nbconvert-py.patch -*-
Info2: <<

Package: nbconvert-py%type_pkg[python]
Version: 5.5.0
Revision: 1
Maintainer: Derek Homeier <dhomeie@gwdg.de>
License: BSD
Type: python (2.7 3.5 3.6 3.7)
Homepage: https://pypi.python.org/pypi/nbconvert
# https://pypi.python.org/packages/source/n/nbconvert/nbconvert-4.1.0.tar.gz#md5=58ee16f5da0dd2976ff992511d6bfb43
Source: https://files.pythonhosted.org/packages/source/n/nbconvert/nbconvert-%v.tar.gz
Source-Checksum: SHA256(138381baa41d83584459b5cfecfc38c800ccf1f37d9ddd0bd440783346a4c39c)

Depends: <<
    python%type_pkg[python]-shlibs,
    bleach-py%type_pkg[python],
    defusedxml-py%type_pkg[python],
    entrypoints-py%type_pkg[python],
    jinja2-py%type_pkg[python],
    ipython-genutils-py%type_pkg[python],
    traitlets-py%type_pkg[python],
    jupyter-core-py%type_pkg[python],
    jupyter-client-py%type_pkg[python],
    nbformat-py%type_pkg[python],
    pandocfilters-py%type_pkg[python]
<<
BuildDepends: python%type_pkg[python], setuptools-tng-py%type_pkg[python]

Recommends: nbconvert-docs-py%type_pkg[python] (= %v-%r)

Description: Converting Jupyter Notebooks

DescDetail: <<
Jupyter nbconvert converts (ipython) notebooks to various other
formats via Jinja templates.
<<

CompileScript: %p/bin/python%type_raw[python] setup.py build

InfoTest: <<
    TestDepends: <<
        ipython-py%type_pkg[python],
        pytest-py%type_pkg[python],
        pytest-cov-py%type_pkg[python],
        pytest-mock-py%type_pkg[python]
    <<
    # in _try_markdown `AssertionError: '\\**test' not found in u'\\*\\*test'` (too old pandoc version?)
    # - more (pan)doc/xetex-related failures on 10.11...
    TestScript: <<
        #!/bin/sh -ev
        export LANG=en_US.UTF-8 PYTHONPATH=build/lib
        darwin_vers=$(uname -r | cut -d. -f1)
        test_excl='not test_markdown2rst'
        if [ $darwin_vers -le 15 ]; then
            test_excl='not test_markdown2rst and not test_run_notebooks and not test_filename_spaces and not test_pdf and not test_allow_errors'
            %p/bin/pytest-%type_raw[python] -k 'not test_export' nbconvert/exporters/tests/test_pdf.py || exit 2
        fi
        %p/bin/pytest-%type_raw[python] -k "$test_excl" || exit 2
        find nbconvert/tests -name '*.pyc' -delete
    <<
    TestSuiteSize: small
<<

InstallScript: <<
    #!/bin/sh -ev
    %p/bin/python%type_raw[python] setup.py install --root=%d
    for file in %i/bin/*; do
        echo mv ${file}{,-py%type_pkg[python]}
        mv ${file}{,-py%type_pkg[python]}
    done
<<

PostInstScript: <<
    # Remove the old if they exist
    update-alternatives --auto jupyter-nbconvert

    # Now the new setup
    update-alternatives --install %p/bin/jupyter-nbconvert jupyter-nbconvert %p/bin/jupyter-nbconvert-py%type_pkg[python] %type_pkg[python]
    echo "The script 'jupyter-nbconvert' installed in %p/bin/ is a symlink"
    echo "automatically updated by the update-alternatives utility."
    echo "If you install multiple flavours of nbconvert, the symlink"
    echo "will point to the higher flavour by default."
    echo "You can inspect the links by running:"
    echo "  update-alternatives --list jupyter-nbconvert"
    echo "  update-alternatives --display jupyter-nbconvert"
<<

PreRmScript: <<
    if [ $1 != "upgrade" ]; then
         update-alternatives --verbose --remove jupyter-nbconvert %p/bin/jupyter-nbconvert-py%type_pkg[python]
    else
        echo "Do not remove during upgrade"
    fi
<<

DocFiles: README.md CONTRIBUTING.md LICENSE PKG-INFO

DescPackaging: <<
Doc build sourced out to nbconvert-docs-py%type_pkg[python] package to avoid
circular build dependency with ipython-py%type_pkg[python] et al.
<<
# Info2
<<
