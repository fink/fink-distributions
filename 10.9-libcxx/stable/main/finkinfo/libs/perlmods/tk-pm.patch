diff -Nurd Tk-804.036.orig/Event/Event.xs Tk-804.036/Event/Event.xs
--- Tk-804.036.orig/Event/Event.xs	2021-02-07 11:34:03
+++ Tk-804.036/Event/Event.xs	2025-12-10 00:25:27
@@ -1137,7 +1137,7 @@
 #else
  if (PL_sighandlerp != handle_signal)
   {
-   old_handler    = PL_sighandlerp;
+   old_handler    = (void (*)())PL_sighandlerp;
    PL_sighandlerp = handle_signal;
   }
 #endif
diff -Nurd Tk-804.036.orig/Makefile.PL Tk-804.036/Makefile.PL
--- Tk-804.036.orig/Makefile.PL	2019-10-20 12:36:39
+++ Tk-804.036/Makefile.PL	2025-12-10 00:25:27
@@ -48,7 +48,7 @@
 else
  {
   my $plibs = $Config{'libs'};
-  my $libs  = "$xlib -lX11$xtra";   # Used to have -lpt in here as well.
+  my $libs  = "$xtra $xlib -lX11";  # Used to have -lpt in here as well.
   my @try   = qw(-lsocket -lnsl -lm);
   push(@try,'-lc') if $^O =~ /svr4/i;
   my $lib;
diff -Nurd Tk-804.036.orig/Tk/MMtry.pm Tk-804.036/Tk/MMtry.pm
--- Tk-804.036.orig/Tk/MMtry.pm	2020-11-22 10:23:54
+++ Tk-804.036/Tk/MMtry.pm	2025-12-10 00:25:27
@@ -26,7 +26,9 @@
  my $stderr_too = $VERBOSE ? '' : $stderr_too;
  my $out   = basename($file,'.c').$Config{'exe_ext'};
  warn "Test Compiling $file\n";
- my $msgs  = `$Config{'cc'} -o $out $Config{'ccflags'} @$inc $file $Config{ldflags} @$lib @$def $stderr_too`;
+ my $cmdline  = "$Config{'cc'} -o $out $Config{'ccflags'} @$inc $file $Config{ldflags} @$lib @$def $stderr_too";
+ warn $cmdline if $VERBOSE;
+ my $msgs  = `$cmdline`;
  my $ok = ($? == 0);
  warn "$msgs\n" if $VERBOSE && $msgs;
  unlink($out) if (-f $out);
@@ -43,6 +45,7 @@
  my $out   = basename($file,'.c').$Config{'exe_ext'};
  warn "Test Compile/Run $file\n";
  my $cmdline = "$Config{'cc'} -o $out $Config{'ccflags'} @$inc $file $Config{ldflags} @$lib @$def";
+ warn $cmdline if $VERBOSE;
  my $msgs  = `$cmdline $stderr_too`;
  my $ok = ($? == 0);
  warn "$cmdline:\n$msgs\n" if $VERBOSE && $msgs;
diff -Nurd Tk-804.036.orig/myConfig Tk-804.036/myConfig
--- Tk-804.036.orig/myConfig	2021-02-07 11:34:04
+++ Tk-804.036/myConfig	2025-12-10 00:25:44
@@ -1,8 +1,5 @@
 # -*- cperl -*-
 require 5.00404;
-my $path = "$Config{'archlibexp'}/CORE/perl.h";
-die "Cannot find '$path' have you installed $^X?\n" unless (-r $path);
-print "$^X is installed in $Config{'archlibexp'} okay\n";
 use Config;
 use Cwd;
 use Tk::MMtry;
@@ -430,7 +427,7 @@
     $gccopt .= " -isystem $1";
    }
 
-  $inc = ($xinc eq "-I/usr/include") ? "" : $xinc;
+  $inc .= " " . ($xinc eq "-I/usr/include") ? "" : $xinc;
 
   if (!defined $XFT)
    {
@@ -440,7 +437,7 @@
    {
     # Found basic X libraries now see if we can find -lXft
 
-    my $ftinc = Ift("/usr/include","/usr/local/include",$X11INC||(),"/opt/X11/include");
+    my $ftinc = Ift("/usr/local/include");
     if ($ftinc)
      {
       print "xlib='$xlib' xinc='$xinc'\n";
@@ -449,10 +446,11 @@
       # on an old RedHat 8.0 system
       for my $def ([], ["-DNEED_FT2BUILD_H"])
        {
+	$ftinc .= ' -I/usr/local/include'; # XXX needed if freetype and xlibs are in different header directories, but should probably check if this is necessary
 	my $ftlib = '-L/usr/local/lib'; # XXX needed if freetype and xlibs are in different lib directories, but should probably check if this is necessary
-	if (try_run("config/xft.c",[$xinc,$ftinc],[$xlib,$ftlib,'-lXft','-lfontconfig'],$def))
+	if (try_run("config/xft.c",[$ftinc,$xinc],[$ftlib,$xlib,'-lXft','-lfontconfig'],$def))
          {
-          $inc .= " $ftinc";
+          $inc = "$ftinc $inc";
           warn "Seem to have -lXft\n";
           $define{USE_XFT_FONTS} = 1;
           $xlib .= " -lXft";
@@ -509,7 +507,7 @@
 } elsif ($IsWin32 or $^O eq 'cygwin') {
   $inc = '-I$(TKDIR) -I$(TKDIR)/pTk/mTk/xlib';
 }
-
+$inc = "$inc $xinc";  # lots of submodules need X11 headers
 
 if ($Config{'osname'} eq 'solaris' && $xlib =~ /\bopenwin\b/ )
  {
diff -Nurd Tk-804.036.orig/pTk/Makefile.PL Tk-804.036/pTk/Makefile.PL
--- Tk-804.036.orig/pTk/Makefile.PL	2013-11-15 18:50:03
+++ Tk-804.036/pTk/Makefile.PL	2025-12-10 00:25:27
@@ -13,7 +13,7 @@
     'OBJECT'	=> '$(O_FILES)',
     macro	=> { WINARCH     => $win_arch },
     'DEFINE'	=> $define,
-    'INC'	=> "$inc -I. -Ibitmaps",
+    'INC'	=> "-I. -Ibitmaps $inc",
     'SKIP'	=> [qw( distclean dist makeaperl xs_o)],
     'clean'	=> {'FILES' => 'libpTk$(LIB_EXT)'}
 );
