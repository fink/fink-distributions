diff -Nurd serf-1.3.10.orig/SConstruct serf-1.3.10/SConstruct
--- serf-1.3.10.orig/SConstruct	2023-05-18 05:33:55
+++ serf-1.3.10/SConstruct	2025-11-08 23:14:39
@@ -225,9 +225,9 @@
 # from current_version, so don't use the PATCH level to avoid that build and
 # runtime patch levels have to be identical.
 if sys.platform != 'sunos5':
-  env['SHLIBVERSION'] = '%d.%d.%d' % (MAJOR, MINOR, 0)
+  env['SHLIBVERSION'] = '%d.%d.%d' % (MAJOR+3, MINOR, 0)
 
-LIBNAME = 'libserf-%d' % (MAJOR,)
+LIBNAME = 'libserf-%d.0' % (MAJOR,)
 if sys.platform != 'win32':
   LIBNAMESTATIC = LIBNAME
 else:
@@ -238,7 +238,7 @@
 
 if sys.platform == 'darwin':
 #  linkflags.append('-Wl,-install_name,@executable_path/%s.dylib' % (LIBNAME,))
-  env.Append(LINKFLAGS=['-Wl,-install_name,%s/%s.dylib' % (thisdir, LIBNAME,)])
+  env.Append(LINKFLAGS='-Wl,-install_name,%s/%s.dylib,-compatibility_version,%s,-current_version,%s' % (thisdir, LIBNAME, env['SHLIBVERSION'], env['SHLIBVERSION'],))
 
 if sys.platform != 'win32':
   def CheckGnuCC(context):
diff -Nurd serf-1.3.10.orig/buckets/aggregate_buckets.c serf-1.3.10/buckets/aggregate_buckets.c
--- serf-1.3.10.orig/buckets/aggregate_buckets.c	2015-09-17 08:46:24
+++ serf-1.3.10/buckets/aggregate_buckets.c	2025-11-08 23:14:39
@@ -154,6 +154,8 @@
     new_list->bucket = prepend_bucket;
     new_list->next = ctx->list;
 
+    if (ctx->list == NULL)
+        ctx->last = new_list;
     ctx->list = new_list;
 }
 
@@ -283,6 +285,8 @@
 
             /* If we have no more in our list, return EOF. */
             if (!ctx->list) {
+                ctx->last = NULL;
+
                 if (ctx->hold_open) {
                     return ctx->hold_open(ctx->hold_open_baton, bucket);
                 }
@@ -395,6 +399,8 @@
 
             /* If we have no more in our list, return EOF. */
             if (!ctx->list) {
+                ctx->last = NULL;
+
                 if (ctx->hold_open) {
                     return ctx->hold_open(ctx->hold_open_baton, bucket);
                 }
diff -Nurd serf-1.3.10.orig/buckets/ssl_buckets.c serf-1.3.10/buckets/ssl_buckets.c
--- serf-1.3.10.orig/buckets/ssl_buckets.c	2023-05-18 05:33:55
+++ serf-1.3.10/buckets/ssl_buckets.c	2025-11-08 23:15:03
@@ -567,7 +567,7 @@
             switch (nm->type) {
                 case GEN_DNS:
                     if (copy_action == ErrorOnNul &&
-                        strlen(nm->d.ia5->data) != nm->d.ia5->length)
+                        strlen((const char *)nm->d.ia5->data) != nm->d.ia5->length)
                         return SERF_ERROR_SSL_CERT_FAILED;
                     if (san_arr && *san_arr)
                         p = pstrdup_escape_nul_bytes((const char *)nm->d.ia5->data,
diff -Nurd serf-1.3.10.orig/test/server/test_server.c serf-1.3.10/test/server/test_server.c
--- serf-1.3.10.orig/test/server/test_server.c	2023-04-21 06:34:44
+++ serf-1.3.10/test/server/test_server.c	2025-11-08 23:14:39
@@ -318,7 +318,7 @@
         }
         else if (action->kind == PROXY_FORWARD) {
             apr_size_t len;
-            char *buf;
+            const char *buf;
 
             if (!servctx->proxy_client_sock) {
                 serf__log(TEST_VERBOSE, __FILE__, "Proxy: setting up connection "
@@ -405,7 +405,7 @@
 
     if (rtnevents & APR_POLLOUT) {
         apr_size_t len;
-        char *buf;
+        const char *buf;
 
         serf__log(TEST_VERBOSE, __FILE__, "proxy_replay: POLLOUT\n");
         /* Send all data received from the client to the server. */
