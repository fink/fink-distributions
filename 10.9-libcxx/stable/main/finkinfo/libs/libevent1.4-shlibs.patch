diff -Nurd libevent-1.4.15.orig/Makefile.am libevent-1.4.15/Makefile.am
--- libevent-1.4.15.orig/Makefile.am	2015-01-05 09:03:30
+++ libevent-1.4.15/Makefile.am	2025-12-02 07:33:17
@@ -1,10 +1,10 @@
-AUTOMAKE_OPTIONS = foreign no-dependencies
+AUTOMAKE_OPTIONS = foreign subdir-objects
 
 ACLOCAL_AMFLAGS = -I m4
 
 # This is the point release for libevent.  It shouldn't include any
 # a/b/c/d/e notations.
-RELEASE = 1.4
+RELEASE = -release 1.4
 
 # This is the version info for the libevent binary API.  It has three
 # numbers:
@@ -122,23 +122,28 @@
 	evdns.h evrpc.c evrpc.h evrpc-internal.h \
 	strlcpy.c strlcpy-internal.h strlcpy-internal.h
 
+NO_UNDEFINED = -no-undefined
+MAYBE_CORE = libevent_core.la
+
+GENERIC_LDFLAGS = -version-info $(VERSION_INFO) $(RELEASE) $(NO_UNDEFINED) $(AM_LDFLAGS)
+
 libevent_la_SOURCES = $(CORE_SRC) $(EXTRA_SRC)
-libevent_la_LIBADD = @LTLIBOBJS@ $(SYS_LIBS)
-libevent_la_LDFLAGS = -release $(RELEASE) -version-info $(VERSION_INFO)
+libevent_la_LIBADD = @LTLIBOBJS@ $(SYS_LIBS) $(SYS_CORE_LIBS)
+libevent_la_LDFLAGS = $(GENERIC_LDFLAGS)
 
 libevent_core_la_SOURCES = $(CORE_SRC)
-libevent_core_la_LIBADD = @LTLIBOBJS@ $(SYS_LIBS)
-libevent_core_la_LDFLAGS = -release $(RELEASE) -version-info $(VERSION_INFO)
+libevent_core_la_LIBADD = @LTLIBOBJS@ $(SYS_LIBS) $(SYS_CORE_LIBS)
+libevent_core_la_LDFLAGS = $(GENERIC_LDFLAGS)
 
 libevent_extra_la_SOURCES = $(EXTRA_SRC)
-libevent_extra_la_LIBADD = @LTLIBOBJS@ $(SYS_LIBS)
-libevent_extra_la_LDFLAGS = -release $(RELEASE) -version-info $(VERSION_INFO)
+libevent_extra_la_LIBADD = $(MAYBE_CORE) $(SYS_LIBS)
+libevent_extra_la_LDFLAGS = $(GENERIC_LDFLAGS)
 
 include_HEADERS = event.h evhttp.h evdns.h evrpc.h evutil.h
 
 nodist_include_HEADERS = event-config.h
 
-INCLUDES = -I$(srcdir)/compat $(SYS_INCLUDES)
+AM_CPPFLAGS = -I$(srcdir)/compat $(SYS_INCLUDES)
 
 man_MANS = event.3 evdns.3
 
diff -Nurd libevent-1.4.15.orig/configure.in libevent-1.4.15/configure.in
--- libevent-1.4.15.orig/configure.in	2015-01-05 08:59:18
+++ libevent-1.4.15/configure.in	2025-12-02 07:22:32
@@ -1,8 +1,9 @@
 dnl configure.in for libevent
 dnl Dug Song <dugsong@monkey.org>
-AC_INIT(event.c)
+AC_INIT(libevent,1.4.15)
+AC_CONFIG_SRCDIR(event.c)
 
-AM_INIT_AUTOMAKE(libevent,1.4.15)
+AM_INIT_AUTOMAKE
 AM_CONFIG_HEADER(config.h)
 dnl AM_MAINTAINER_MODE
 
@@ -226,6 +227,8 @@
 #include <stdio.h>
 #include <unistd.h>
 #include <fcntl.h>
+#include <stdlib.h>
+#include <string.h>
 
 int
 main(int argc, char **argv)
