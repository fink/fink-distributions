diff -Nurd rrdtool-1.4.4.orig/bindings/lua/Makefile.in rrdtool-1.4.4/bindings/lua/Makefile.in
--- rrdtool-1.4.4.orig/bindings/lua/Makefile.in	2010-07-05 15:31:54
+++ rrdtool-1.4.4/bindings/lua/Makefile.in	2025-10-29 00:47:37
@@ -329,8 +329,8 @@
 @LUA_NEED_OUR_COMPAT51_TRUE@rrd_la_SOURCES = rrdlua.c compat-5.1r5/compat-5.1.c compat-5.1r5/compat-5.1.h
 @LUA_NEED_OUR_COMPAT51_TRUE@compatdir = $(LUA_INSTALL_LMOD)
 @LUA_NEED_OUR_COMPAT51_TRUE@compat_DATA = compat-5.1r5/compat-5.1.lua
-rrd_la_LIBADD = -lrrd -lm
-rrd_la_LDFLAGS = -module -version-info $(LIB_VERSION_INFO) $(LUA_LFLAGS) -L$(top_builddir)/src/.libs
+rrd_la_LIBADD = $(top_builddir)/src/librrd.la -lm
+rrd_la_LDFLAGS = -module -version-info $(LIB_VERSION_INFO) $(LUA_LFLAGS)
 rrd_la_CFLAGS = -I$(top_srcdir)/src -I$(top_srcdir) $(LUA_CFLAGS) $(LUA_DEFINES) -DLIB_VERSION=\"$(LIB_VERSION)\"
 all: all-am
 
diff -Nurd rrdtool-1.4.4.orig/bindings/tcl/Makefile.in rrdtool-1.4.4/bindings/tcl/Makefile.in
--- rrdtool-1.4.4.orig/bindings/tcl/Makefile.in	2010-07-05 15:31:54
+++ rrdtool-1.4.4/bindings/tcl/Makefile.in	2025-10-29 01:54:03
@@ -20,7 +20,7 @@
 VPATH = @srcdir@
 pkgdatadir = $(datadir)/@PACKAGE@
 pkgincludedir = $(includedir)/@PACKAGE@
-pkglibdir = $(libdir)/@PACKAGE@
+pkglibdir = $(libdir)
 pkglibexecdir = $(libexecdir)/@PACKAGE@
 am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
 install_sh_DATA = $(install_sh) -c -m 644
@@ -259,7 +259,7 @@
 includedir = @includedir@
 infodir = @infodir@
 install_sh = @install_sh@
-libdir = @libdir@
+libdir = @libdir@/tcl-libdirs/8.6/@PACKAGE@
 libexecdir = @libexecdir@
 localedir = @localedir@
 localstatedir = @localstatedir@
@@ -292,7 +292,7 @@
 CLEANFILES = tclrrd.o tclrrd.so
 SRC_DIR = $(top_srcdir)/src
 AM_CPPFLAGS = $(TCL_INCLUDE_SPEC) -I$(SRC_DIR) -DUSE_TCL_STUBS
-LIBDIRS = -L$(top_builddir)/src/.libs -L$(top_builddir)/src -L$(libdir)
+LIBDIRS = -L$(libdir)
 LIB_RUNTIME_DIR = $(libdir)
 @BUILD_TCL_SITE_TRUE@tclpkgdir = @TCL_PACKAGE_DIR@
 @BUILD_TCL_SITE_TRUE@tclpkg_DATA = pkgIndex.tcl
@@ -651,7 +651,7 @@
 all-local: $(TCL_RRD_LIB)
 
 $(TCL_RRD_LIB): tclrrd.o
-	$(TCL_SHLIB_LD) $(TCL_LD_SEARCH_FLAGS) $(LIBDIRS) $< -o $@ -lrrd_th -lm $(TCL_STUB_LIB_SPEC) $(LDFLAGS) $(LIBS)
+	$(TCL_SHLIB_LD) $(TCL_LD_SEARCH_FLAGS) $(LIBDIRS) $< -o $@ $(top_builddir)/src/.libs/librrd_th.dylib -lm $(TCL_STUB_LIB_SPEC) $(LDFLAGS) $(LIBS) -Wl,-single_module -install_name $(libdir)/$(TCL_RRD_LIB)
 
 tclrrd.o: tclrrd.c
 	$(CC) $(AM_CFLAGS) $(CFLAGS) $(TCL_SHLIB_CFLAGS) $(AM_CPPFLAGS) -c tclrrd.c -DVERSION=\"$(VERSION)\"
@@ -661,6 +661,7 @@
 
 install-exec-local: $(TCL_RRD_LIB)
 	@$(NORMAL_INSTALL)
+	test -z "$(libdir)" || $(MKDIR_P) "$(DESTDIR)$(libdir)"
 	$(INSTALL_PROGRAM) $(TCL_RRD_LIB) $(DESTDIR)$(libdir)/$(TCL_RRD_LIB)
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
diff -Nurd rrdtool-1.4.4.orig/bindings/tcl/tclrrd.c rrdtool-1.4.4/bindings/tcl/tclrrd.c
--- rrdtool-1.4.4.orig/bindings/tcl/tclrrd.c	2009-06-07 10:46:21
+++ rrdtool-1.4.4/bindings/tcl/tclrrd.c	2025-10-29 02:05:12
@@ -678,7 +678,7 @@
     if (Tcl_InitStubs(interp, TCL_VERSION, 0) == NULL)
         return TCL_ERROR;
 
-    if (Tcl_PkgRequire(interp, "Tcl", TCL_VERSION, 1) == NULL) {
+    if (Tcl_PkgRequire(interp, "Tcl", TCL_VERSION, 0) == NULL) {
         return TCL_ERROR;
     }
 
diff -Nurd rrdtool-1.4.4.orig/configure rrdtool-1.4.4/configure
--- rrdtool-1.4.4.orig/configure	2010-07-05 15:31:49
+++ rrdtool-1.4.4/configure	2025-10-29 01:25:20
@@ -12736,7 +12736,7 @@
 
 
 
-CFLAGS="$CFLAGS -D_GNU_SOURCE"
+CPPFLAGS="$CPPFLAGS -D_GNU_SOURCE"
 
 { $as_echo "$as_me:$LINENO: checking if gcc likes the -Werror flag" >&5
 $as_echo_n "checking if gcc likes the -Werror flag... " >&6; }
diff -Nurd rrdtool-1.4.4.orig/src/Makefile.in rrdtool-1.4.4/src/Makefile.in
--- rrdtool-1.4.4.orig/src/Makefile.in	2010-07-05 15:31:55
+++ rrdtool-1.4.4/src/Makefile.in	2025-10-29 00:47:38
@@ -436,14 +436,14 @@
 librrdupd_la_LIBADD = $(CORE_LIBS)
 librrd_la_SOURCES = $(RRD_C_FILES)
 librrd_la_DEPENDENCIES = librrdupd.la librrd.sym
-librrd_la_LIBADD = librrdupd.la $(ALL_LIBS)
+librrd_la_LIBADD = librrdupd.la $(ALL_LIBS) -lpng
 librrd_la_LDFLAGS = -version-info @LIBVERS@ -export-symbols librrd.sym
 librrd_th_la_SOURCES = $(UPD_C_FILES) $(RRD_C_FILES) rrd_thread_safe.c
 librrd_th_la_DEPENDENCIES = librrd.sym
 librrd_th_la_CFLAGS = $(AM_CFLAGS) $(MULTITHREAD_CFLAGS)
 librrd_th_la_LDFLAGS = $(MULTITHREAD_LDFLAGS) -version-info @LIBVERS@ \
 	-export-symbols librrd.sym
-librrd_th_la_LIBADD = $(ALL_LIBS)
+librrd_th_la_LIBADD = $(ALL_LIBS) -lpng
 include_HEADERS = rrd.h rrd_format.h rrd_client.h
 rrdcgi_SOURCES = rrd_cgi.c
 rrdcgi_LDADD = librrd.la
diff -Nurd rrdtool-1.4.4.orig/src/rrd_tool.h rrdtool-1.4.4/src/rrd_tool.h
--- rrdtool-1.4.4.orig/src/rrd_tool.h	2010-07-05 11:38:22
+++ rrdtool-1.4.4/src/rrd_tool.h	2025-10-29 01:25:21
@@ -51,7 +51,7 @@
 
 /* local include files -- need to be after the system ones */
 #ifdef HAVE_GETOPT_LONG
-#define _GNU_SOURCE
+/* #define _GNU_SOURCE  <-- already propagated from configure.ac */
 #include <getopt.h>
 #else
 #include "rrd_getopt.h"
