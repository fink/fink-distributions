Package: librrd8-shlibs
Version: 1.9.0
Revision: 1
Description: Fixed-size "round-robin" database storage
License: GPL
Maintainer: Benjamin Reed <rrdtool@fink.raccoonfink.com>

Depends: <<
	cairo-shlibs (>= 1.12.8-1),
	glib2-shlibs (>= 2.22.0-1),
	libpng16-shlibs,
	libxml2-shlibs (>= 2.9.1-1),
	pango1-xft2-ft219-shlibs (>= 1.24.5-4)
<<
BuildDepends: <<
	cairo (>= 1.12.8-1),
	fink (>= 0.28),
	fink-package-precedence (>= 0.7-1),
	fontconfig2-dev (>= 2.10.0-1),
	freetype219 (>= 2.4.11-1),
	glib2-dev (>= 2.22.0-1),
	intltool40,
	libgettext8-dev,
	libiconv-dev,
	libpng16,
	libxml2 (>= 2.9.1-1),
	pango1-xft2-ft219-dev (>= 1.24.5-4),
	pkgconfig (>= 0.23-1),
	tcltk,
	tcltk-dev,
	x11-dev
<<
Suggests: rrdtool

Source: https://github.com/oetiker/rrdtool-1.x/releases/download/v%v/rrdtool-%v.tar.gz
Source-Checksum: SHA256(5e65385e51f4a7c4b42aa09566396c20e7e1a0a30c272d569ed029a81656e56b)
# * Includes g_list_free_full() from glib-2.87.0/glib/glist.c (but
#   declared static and renamed to avoid collision with the real one).
# * Includes https://github.com/oetiker/rrdtool-1.x/commit/8a77f3e4123d13b18f712454e038892c4ccf7df2
PatchFile: %n.patch
PatchFile-MD5: 95c48ab487a45fd19a7f63ce67b600d4
PatchScript: <<
	%{default_script}
	perl -pi -e 's/ifdef _POSIX_C_SOURCE/if 1/' src/compat-cloexec.c
	perl -pi -e 's,\$TCL_PACKAGE_PATH,%p/lib/tcl-libdirs/8.6,' configure
<<

SetCPPFLAGS: -fno-common
UseMaxBuildJobs: false
# libdbi is abandoned upstream and has bugs; we have never
# deterministically included it here, so may as well avoid it.
ConfigureParams: <<
	--disable-static \
	--enable-shared \
	--disable-libdbi \
	--with-tcllib=%p/lib \
	--disable-lua \
	--disable-perl \
	--disable-python \
	--disable-ruby \
	PERLBIN="/usr/bin/perl" \
	POD2MAN="/usr/bin/pod2man" \
	POD2HTML="/usr/bin/pod2html"
<<
SetLDFLAGS: -Wl,-dead_strip_dylibs
CompileScript: <<
	%{default_script}
	fink-package-precedence --prohibit-bdep librrd8-dev .
<<

InstallScript: <<
	make -j1 install \
		DESTDIR="%d" \
		idocdir="%p/share/doc/rrdtool/doc" \
		examplesdir="%p/share/doc/rrdtool/examples" \
		ihtmldir="%p/share/doc/rrdtool/html"
	find %i -name RRDp\* -o -name RRDs\* -delete
<<
DocFiles: CHANGES CONTRIBUTORS COPYRIGHT LICENSE NEWS THREADS TODO
Shlibs: <<
	%p/lib/librrd.8.dylib 12.0.0 %n (>= 1.9.0-1)
<<
SplitOff: <<
	Package: rrdtool
	Depends: <<
		%N (>= %v-%r),
		glib2-shlibs (>= 2.22.0-1),
		libgettext8-shlibs
	<<
	Conflicts: rrdtool-bin
	Replaces: rrdtool-bin
	Files: <<
		bin
		share/doc/%n
		share/locale
		share/man/man1
	<<
	DocFiles: CHANGES CONTRIBUTORS COPYRIGHT LICENSE NEWS THREADS TODO
<<
SplitOff3: <<
	Package: librrd8-dev
	Depends: <<
		%N (= %v-%r),
		rrdtool (>= %v-%r)
	<<
	Conflicts: <<
		rrdtool-dev,
		librrd8-dev
	<<
	Replaces: <<
		rrdtool (<< 1.4.4-6),
		rrdtool-dev,
		librrd8-dev
	<<
	BuildDependsOnly: true
	Files: <<
		include
		lib/librrd.{dylib,la}
		lib/pkgconfig
		share/man
	<<
	DocFiles: CHANGES CONTRIBUTORS COPYRIGHT LICENSE NEWS THREADS TODO
<<
SplitOff4: <<
	Package: rrdtool-tcl
	Depends: <<
		%N (>= %v-%r),
		tcltk,
		tcl-libdirs
	<<
	Enhances: librrd4-shlibs
	Files: lib/tcl-libdirs
	Shlibs: !%p/lib/tcl-libdirs/8.6/rrdtool/tclrrd%v.dylib
	DocFiles: CHANGES CONTRIBUTORS COPYRIGHT LICENSE NEWS THREADS TODO bindings/tcl/README:README.tcl-bindings
<<

Homepage: https://oss.oetiker.ch/rrdtool
DescDetail: <<
RRD is a system to store and display time-series data (i.e. network bandwidth,
machine-room temperature, server load average).  It stores the data in a very
compact way that will not expand over time, and it presents useful graphs by
processing the data to enforce a certain data density.  It can be used either
via simple wrapper scripts (from shell or Perl) or via frontends that poll
network devices and put a friendly user interface on it.
<<
