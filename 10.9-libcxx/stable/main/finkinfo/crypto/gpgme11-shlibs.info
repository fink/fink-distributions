Package: gpgme11-shlibs
#
# Versions 1.3.2 and up lose libgpgme-pth.dylib (asserted that it's
# never been used in the wild) and eventually libgpgme-pthread.dylib
# (merged into libgpgme.dylib, some symbols dropped but none that were
# in public .h). Debian has compat libgpgme-pthread->libgpgme.dylib
# symlink just in case, and we could, but cannot have a Shlibs: entry
# for it (no install_name match). For now, we'll omit it, but could
# create a copy with new install_name if needed.
#
# 1.3.2 FTBFS (status-table.h not found)
#
# 1.3.1 specifies libassuan API=2 (libassuan9 is API=3); later
# versions eventuall recognize that API=3 has API=2 compat and allows
# it. We could steal that patch.
#
Version: 1.24.2
Revision: 1
Description: Application access library for GnuPG
License: GPL
Maintainer: Darian Lanx <dmalloc@users.sourceforge.net>
Depends: <<
	gnupg2 (>= 2.2.17-3),
	libassuan9-shlibs (>= 2.4.2),
	libgpg-error-shlibs (>= 1.55)
<<
BuildDepends: <<
	autoconf2.6,
	automake1.15,
	fink-package-precedence,
	libassuan9 (>= 2.4.2),
	libgpg-error (>= 1.55),
	libtool2,
	pkgconfig
<<
Source: https://gnupg.org/ftp/gcrypt/gpgme/gpgme-%v.tar.bz2
Source-Checksum: SHA256(e11b1a0e361777e9e55f48a03d89096e2abf08c63d84b7017cfe1dce06639581)
PatchScript: <<
	perl -pi -e 's/(no_undefined =)\s*$/\1 -no-undefined\n/' src/Makefile.am
<<
# Some of our older supported platforms don't know some newer compiler
# flags.
SetCPPFLAGS: -Wno-unknown-warning-option
ConfigureParams: <<
	--enable-fd-passing \
	--enable-dependency-tracking \
	--enable-languages=cl
<<
CompileScript: <<
	# has bits from old autotools that don't known modern darwin
	autoreconf -fi
	%{default_script}
	fink-package-precedence --prohibit-bdep=gpgme11 .
<<
InstallScript: <<
	make install DESTDIR=%d
<<
Shlibs: <<
	%p/lib/libgpgme.11.dylib 45.0.0 %n (>= 1.24.2-1)
<<
SplitOff: <<
	Package: gpgme11
	Description: Developement files for libgpgme
	Depends: %N (= %v-%r)
	Replaces: <<
		gpgme11,
		libgpgme11,
		libgpgme11-1.9-dev
	<<
	Conflicts: <<
		gpgme11,
		libgpgme11,
		libgpgme11-1.9-dev
	<<
	BuildDependsOnly: true
	Files: <<
		bin
		include
		lib/libgpgme.{dylib,la}
		lib/pkgconfig
		share/aclocal
		share/common-lisp
		share/info
	<<
	InfoDocs: gpgme.info
	DocFiles: AUTHORS COPYING ChangeLog NEWS README THANKS TODO
<<

DocFiles: AUTHORS COPYING ChangeLog NEWS README* THANKS TODO
Homepage: http://www.gnupg.org/gpgme.html
DescPackaging: <<
Earlier versions by Max Horn

1.3.1 had a separate libgpgme-pth, but was asserted that it had never
been used in the wild and was therefore dropped. Given never-used, no
need to worry about Shlibs Policy break of dropping it.

Enable common-lisp because our package always has; likewise why it's
in the dev package not runtime or a separate one of its own.
<<
