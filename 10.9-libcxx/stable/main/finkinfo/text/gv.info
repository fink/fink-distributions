Package: gv
Version: 3.7.4
Revision: 6
Source: gnu
Source-Checksum: SHA256(2162b3b3a95481d3855b3c4e28f974617eef67824523e56e20b56f12fe201a61)
BuildConflicts: libxt, libxt-flat
BuildDepends: <<
	fink-buildenv-modules (>= 0.1.3-1),
	fink-package-precedence (>= 0.34-1),
	fontconfig2-dev,
	freetype219,
	libgnugetopt (>= 1.2-3),
	libiconv-dev,
	libxaw3dxft8-dev,
	pkgconfig,
	system-xfree86-dev (>= 3:2.7.112-3),
	xft2-dev
<<
SetCPPFLAGS: -I%p/include/gnugetopt
SetLDFLAGS: -lgnugetopt
# PatchFile also incorporates from Debian gv-1:3.7.4-3.1:
#   * 0001-Do-not-segfault-on-buggy-postscript-files-i.-e.-file.patch
#   * 0002-Fix-crash-in-zoom.c.patch
PatchFile: %n.patch
PatchFile-MD5: b9f7c61c49fb77e2564d737e32a999fd
PatchScript: <<
	patch -p1 < %{PatchFile}
	sed -i.bak 's|/usr/doc|%p/share/doc|' src/Makefile.in
	sed -i.bak 's|X11/Xaw3d/|X11/Xaw3dxft/|' src/paths.h
#	sed -i 's|X11/Xaw3d/|X11/Xaw3dxft/|' configure.ac
	sed -i.bak 's|X11/Xaw3d/|X11/Xaw3dxft/|' configure
#	sed -i 's|\[Xaw3d\]|\[Xaw3dxft\]|' configure.ac
#	sed -i 's|\[xaw3d\]|\[libxaw3dxft\]|' configure.ac
	sed -i.bak 's|-lXaw3d|-lXaw3dxft|' configure
	sed -i.bak 's|\"xaw3d|\"libxaw3dxft|' configure
<<
Depends: <<
	ghostscript | ghostscript-nox,
	libgnugetopt-shlibs (>= 1.2-3),
	libiconv,
	libxaw3dxft8-shlibs,
	fontconfig2-shlibs,
	xft2-shlibs,
	system-xfree86-shlibs (>= 3:2.7.112-3)
<<
ConfigureParams: <<
	--enable-dependency-tracking \
	--x-includes=$X11_INCLUDE_DIR \
	--x-libraries=$X11_LIBRARY_DIR \
	--enable-setenv-code \
	--enable-SIGCHLD-fallback \
	ac_cv_lib_iconv_iconv_open=yes
<<
CompileScript: <<
	#!/bin/sh -ev
	. %p/sbin/fink-buildenv-helper.sh
	%{default_script}
	fink-package-precedence .
<<
InstallScript: <<
	make install DESTDIR=%d
<<
Description: X11 interface for ghostscript interpreter
DescPort: <<
	o Patch GV to GV.addata to avoid potential case-sensitivity issues.
 
	o Added --enable-SIGCHLD-fallback required for Mac OS X

	o Patch to use version 1.6.4+ of libxaw3dxft.

	o Fix some flag-passing weaknesses
	
	o Fink's libiconv plays games with symbol names that breaks
	  the hard-coded OSX workaround in configure.ac, even though
	  the .c that uses it is coded in a way that works for
	  Fink. Short-circuit the test so configure knows we have
	  iconv and to pass the -l flag.
<<
DescPackaging: <<
	Former Maintainer: Todai Fink Team <fink@sodan.ecc.u-tokyo.ac.jp>
<<
DocFiles: NEWS INSTALL README COPYING
InfoDocs: gv.info
License: GPL
Homepage: https://www.gnu.org/software/gv/
Maintainer: None <fink-devel@lists.sourceforge.net>
