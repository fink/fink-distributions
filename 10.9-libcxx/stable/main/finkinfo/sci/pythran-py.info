# -*- coding: ascii; tab-width: 4 -*-
Info2: <<
Package: pythran-py%type_pkg[python]
Version: 0.11.0
Revision: 1
Maintainer: Derek Homeier <dhomeie@gwdg.de>
Type: python (3.5 3.6 3.7 3.8 3.9 3.10)

Source: https://files.pythonhosted.org/packages/source/p/pythran/pythran-%v.tar.gz
Source-Checksum: SHA256(0b2cba712e09f7630879dff69f268460bfe34a6d6000451b47d598558a92a875)

Depends: <<
  python%type_pkg[python],
  beniget-py%type_pkg[python] (>= 0.3.0),
  decorator-py%type_pkg[python],
  gast-py%type_pkg[python] (>= 0.4.0),
  networkx-py%type_pkg[python] (>= 2.0),
  numpy-py%type_pkg[python],
  ply-py%type_pkg[python] (>= 3.4),
  six-py%type_pkg[python]
<<

BuildDepends: <<
  fink (>= 0.32),
  setuptools-tng-py%type_pkg[python],
  wheel-py%type_pkg[python]
<<

Description: Ahead of Time Compiler for numeric kernels
DescDetail: <<
Pythran is an ahead of time compiler for a subset of the Python language,
with a focus on scientific computing. It takes a Python module annotated
with a few interface descriptions and turns it into a native Python module
with the same interface, but (hopefully) faster.
It is meant to efficiently compile scientific programs, and takes advantage
of multi-cores and SIMD instruction units.
<<

# Since no tests are included with PyPI source, don't require it already for setup.
PatchScript: <<
  perl -pi -e 's|(setup_requires=.*)("pytest-runner")|$1|' setup.py
  chmod 644 docs/*.rst
<<

CompileScript: %p/bin/python%type_raw[python] setup.py build

InstallScript: <<
  %p/bin/python%type_raw[python] setup.py install --root=%d
  mv %i/bin/pythran %i/bin/pythran-py%type_pkg[python]
  mv %i/bin/pythran-config %i/bin/pythran-config-py%type_pkg[python]
<<

PostInstScript: <<
  update-alternatives --install %p/bin/pythran pythran %p/bin/pythran-py%type_pkg[python] %type_pkg[python] \
                      --slave   %p/bin/pythran-config pythran-config %p/bin/pythran-config-py%type_pkg[python]
  echo ""
  echo "The scripts 'pythran' and 'pythran-config' installed in %p/bin/ are"
  echo "symlinks automatically updated by the update-alternatives utility."
  echo "If you install multiple flavours of the astropy package, the symlink"
  echo "will point to the higher flavour by default."
  echo "You can inspect the links by running:"
  echo "  update-alternatives --list pythran"
  echo "  update-alternatives --display pythran"
<<

PreRmScript: <<
  if [ $1 != "upgrade" ]; then
    update-alternatives --remove pythran %p/bin/pythran-py%type_pkg[python]
  fi
<<

# No real test suite
InfoTest: <<
  TestScript: PYTHONPATH=build/lib %p/bin/python%type_raw[python] -Bc 'import pythran; pythran.test_compile()' || exit 2
<<

# docs/examples docs/papers missing from PyPI source
DocFiles: AUTHORS Changelog LICENSE PKG-INFO README.rst docs/*.rst
License: BSD
Homepage: https://pypi.org/project/pythran/

# Info2
<<
