# -*- coding: ascii; tab-width: 4; x-counterpart: sip-py.patch -*-
Info2: <<

Package: sip-py%type_pkg[python]
Version: 5.4.0
Revision: 1
Type: python (3.5 3.6 3.7 3.8)

# SF source has not been updated since 4.19.13
# Source: mirror:sourceforge:pyqt/sip/sip-%v/sip-%v.tar.gz
# Source: https://www.riverbankcomputing.com/static/Downloads/sip/%v/sip-%v.tar.gz
Source: https://files.pythonhosted.org/packages/source/s/sip/sip-%v.tar.gz
Source-Checksum: SHA256(4282ab45948674f5ef74278a8e70d1302f65c95b519a0af19409002f5715d641)

GCC: 4.0
Depends: python%type_pkg[python], toml-py%type_pkg[python]
BuildDepends: fink-buildenv-modules (>= 0.1.3-1), fink (>= 0.24.12-1)
BuildDependsOnly: false

UseMaxBuildJobs: true
CompileScript: <<
	#!/bin/sh -ev
	. %p/sbin/fink-buildenv-helper.sh
 	%p/bin/python%type_raw[python] setup.py build
<<

InstallScript: <<
	#!/bin/sh -ev
 	%p/bin/python%type_raw[python] setup.py install --root=%d
	cd %i/lib/python%type_raw[python]/site-packages
	%p/bin/python%type_raw[python] -m compileall .
	for f in %i/bin/sip*; do
		mv $f ${f}-py%type_pkg[python]
	done
<<

# No tests included in 5.4 PyPI source
#InfoTest: <<
#	TestDepends: pytest-py%type_pkg[python]
#	TestScript: <<
#		#!/bin/bash -ev
#		export PYTHONPATH=$(ls -d %b/build/lib.macos*-%type_raw[python])
# 		%p/bin/python%type_raw[python] -Bm pytest
#	<<
#<<

DocFiles: LICENSE* NEWS PKG-INFO README ChangeLog doc/html examples

SplitOff: <<
	Package: %N-bin
	Depends: sip-py%type_pkg[python] (= %v-%r)
	Conflicts: <<
		sip-py27-bin (<< 4.19.22), sip-py34-bin (<< 4.19.22), sip-py35-bin (<< 4.19.22), sip-py36-bin (<< 4.19.22), sip-py37-bin (<< 4.19.22)
	<<
	Replaces: <<
		sip-py27-bin (<< 4.19.22), sip-py34-bin (<< 4.19.22), sip-py35-bin (<< 4.19.22), sip-py36-bin (<< 4.19.22), sip-py37-bin (<< 4.19.22)
	<<
	PostInstScript: <<
		# Remove old link if it exists
		update-alternatives --auto sip
		update-alternatives --verbose --install %p/bin/sip5 sip5 %p/bin/sip5-py%type_pkg[python] %type_pkg[python] \
				--slave %p/bin/sip-build sip-build %p/bin/sip-build-py%type_pkg[python] \
				--slave %p/bin/sip-distinfo sip-distinfo %p/bin/sip-distinfo-py%type_pkg[python] \
				--slave %p/bin/sip-install sip-install %p/bin/sip-install-py%type_pkg[python] \
				--slave %p/bin/sip-module sip-module %p/bin/sip-module-py%type_pkg[python] \
				--slave %p/bin/sip-sdist sip-sdist %p/bin/sip-sdist-py%type_pkg[python] \
				--slave %p/bin/sip-wheel sip-wheel %p/bin/sip-wheel-py%type_pkg[python]

		echo ""
		echo "The scripts 'sip5','sip-build', 'sip-distinfo', 'sip-install', 'sip-install',"
		echo "'sip-module', 'sip-sdist', and 'sip-wheel' installed in %p/bin/ are symlinks"
		echo "automatically updated by the update-alternatives utility. If you install"
		echo "multiple flavours of the sip package the symlinks will point to the higher"
		echo "flavour by default."
	<<
	PreRmScript: <<
		if [ $1 != "upgrade" ]; then
			update-alternatives --verbose --remove sip5 %p/bin/sip5-py%type_pkg[python]
		else
			echo "Skipping update-alternatives during an upgrade."
		fi
	<<
	Files: bin
	DocFiles: LICENSE* NEWS PKG-INFO README ChangeLog
	License: GPL
<<

DescPackaging: <<
	Disable requirement of framework-built python on darwin.
	Don't over-ride specs/ for plugin compiler flags on darwin.
	
	Previously maintained by Dave Reiser <dbreiser@users.sourceforge.net>
<<
Description: Create Python bindings for C and C++ Libs
Homepage: http://www.riverbankcomputing.co.uk/software/sip/intro
License: GPL
Maintainer: Daniel Johnson <daniel@daniel-johnson.org>

<<
