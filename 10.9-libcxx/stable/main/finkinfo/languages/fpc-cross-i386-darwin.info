Package: fpc-cross-i386-darwin
Version: 3.2.0
Revision: 1
Depends: fpc-cross-common (>= 3.2.0-1)
Recommends: fpc-doc

CustomMirror: <<
eur-BE: ftp://ftp.freepascal.org/pub/fpc/
eur-HU: ftp://ftp.hu.freepascal.org/pub/fpc/
eur-NL: ftp://freepascal.stack.nl/mirrors/fpc/
Primary: ftp://ftp.freepascal.org/pub/fpc/
<<
Source: mirror:custom:/dist/%v/source/fpc-%v.source.tar.gz
Source-MD5: fd386c89ba1324f157bb5c875d23622d

SourceDirectory: fpc-%v

UseMaxBuildJobs: false

# Patch for lazarus, see Mantis https://bugs.freepascal.org/view.php?id=37181
PatchFile:     fpc-NSScrollView.patch
PatchFile-MD5: ddfb420c5b74c0065373ced7ac09f4d8

Patchscript: <<
#!/bin/sh -ev
  patch -p0 <%{PatchFile}
<<

CompileScript: <<
#!/bin/sh -ev
# Yosemite fix
  if [ "$(uname -r | cut -d. -f1)" -ge 14 ]; then export MACOSX_DEPLOYMENT_TARGET=10.9 ; fi

# compile rtl and packages for i386
  make rtl packages OPT="-ap" CPU_TARGET=i386
<<

InstallScript: <<
#!/bin/sh -ev
# Yosemite fix
  if [ "$(uname -r | cut -d. -f1)" -ge 14 ]; then export MACOSX_DEPLOYMENT_TARGET=10.9 ; fi

# install all units from the rtl and packages
  make rtl_install packages_install CPU_TARGET=i386 INSTALL_PREFIX=%i CROSSINSTALL=1

# remove duplicate doc files
  rm -rf %i/share/doc/fpc-%v/*/*.txt
  rm -rf %i/share/doc/fpc-%v/ide/*.ide

# remove duplicate bin files
  rm -rf %i/bin

<<

InfoTest: <<

  TestScript: <<
#!/bin/sh -ev
# Build a trivial small program to test for fundamental flaws

cat >HelloWorld.pas <<EOFTEST
  Program HelloWorld;
  begin
    writeln ('Hello World!');
  end.
EOFTEST

fpc  -Pi386 -Furtl/units/i386-darwin HelloWorld.pas
<<
<<

License: LGPL

Description: FPC cross-compiler i386-darwin

DescDetail: <<
Free Pascal (aka FPK Pascal) is a 32 and 64 bit professional Pascal
compiler. Supported processors: Intel x86, Amd64/x86 64, PowerPC, 
Sparc, Arm.
Supported operating systems: Linux, FreeBSD, Mac OS X/Darwin, 
DOS, Win32, Win64, Wince.

The language syntax has excellent compatibility with TP 7.0 as well as 
with most versions of Delphi (classes, rtti, exceptions, ansistrings,
widestrings, interfaces). A Mac Pascal compatibility mode is also provided
to assist users of previous Pascal compilers for the Mac. 
Furthermore, Free Pascal supports function overloading, operator 
overloading, global properties and other modern features.

http://wiki.freepascal.org/User_Changes_%v also lists changes in fpc.
<<

DescUsage: <<
 This Pascal crosscompiler produces x86 32 bit executables.

 get help with: fpc -h

 compile and link a Pascal file with:
 
 fpc -Pi386 FILENAME

 For more documentation about Free Pascal in HTML and pdf, install fpc-doc.
<<

DescPort: <<
 Only the rtl and the packages need to be installed. The original x86 compiler 
 (ppc386) is enough for compiling.
<<

Homepage: https://www.freepascal.org

Maintainer: Karl-Michael Schindler <karl-michael.schindler@web.de>
