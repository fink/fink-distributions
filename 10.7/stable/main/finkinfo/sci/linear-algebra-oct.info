Info2: <<
Package: linear-algebra%type_pkg[-atlas]-oct%type_pkg[oct]
Version: 2.0.0
# No atlas on 10.7 yet
Type: oct (3.2.4 3.4.3), forge (linear-algebra), -atlas (.)
Revision: 4
Maintainer: Alexander Hansen <alexkhansen@users.sourceforge.net>
# unfortunately, Homepage won't do types
Homepage: http://octave.sourceforge.net/linear-algebra/index.html 
Description: Additional linear algebra code for Octave
DescDetail: <<
Additional linear algebra code, including general SVD and matrix functions.

This package provides the following functions:
Matrix functions:
        condeig
        funm
        thfm
        cartprod
        rotparams
        rotv
        mgorth
Matrix factorization:
        gsvd
Test:
        test_gsvd
Block sparse matrices:
        @blksparse/blksparse
        @blksparse/blksize
        @blksparse/ctranspose
        @blksparse/display
        @blksparse/full
        @blksparse/minus
        @blksparse/mtimes
        @blksparse/mldivide
        @blksparse/mrdivide
        @blksparse/plus
        @blksparse/size
        @blksparse/sparse
        @blksparse/subsref
        @blksparse/transpose
        @blksparse/uminus
        @blksparse/uplus
Iterative techniques:
        bicg
        pgmres
Kronecker Products:
        @kronprod/kronprod
        @kronprod/rows
        @kronprod/columns
        @kronprod/numel
        @kronprod/size
        @kronprod/display
        @kronprod/disp
        @kronprod/issquare
        @kronprod/issparse
        @kronprod/isreal
        @kronprod/iscomplex
        @kronprod/ismatrix
        @kronprod/sparse
        @kronprod/full
        @kronprod/transpose
        @kronprod/ctranspose
        @kronprod/uplus
        @kronprod/uminus
        @kronprod/plus
        @kronprod/minus
        @kronprod/times
        @kronprod/rdivide
        @kronprod/mldivide
        @kronprod/mtimes
        @kronprod/mpower
        @kronprod/inv
        @kronprod/det
        @kronprod/rank
        @kronprod/trace
<<
License: GPL

# All octave-forge packages have to have the following BuildDepends:
#  octave%type_pkg[oct]-dev | octave%type_pkg[oct]-atlas-dev,
# fftw3, 
# ( %type_pkg[oct] = 305 ) hdf5.7-oldapi,
# ( %type_pkg[oct] != 305 ) hdf5.7
#
# Packages which serve only Octave-3.0.5 or only Octave > 3.0.5 need
# not use the conditional, of course.

BuildDepends: <<
  (%type_raw[-atlas] = -atlas)	atlas,
  (%type_raw[-atlas] = -atlas)	liboctave%type_pkg[oct]-atlas-dev, 
  (%type_raw[-atlas] != -atlas)	liboctave%type_pkg[oct]-veclib-dev, 
  fftw3,
  ( %type_pkg[oct] = 305 ) hdf5.7-oldapi,
  ( %type_pkg[oct] != 305 ) hdf5.7 
 <<
Depends: <<
  (%type_raw[-atlas] = -atlas)  atlas-shlibs,
  (%type_raw[-atlas] = -atlas)	liboctave%type_pkg[oct]-atlas, 
  (%type_raw[-atlas] != -atlas)	liboctave%type_pkg[oct]-veclib
<<
Conflicts: <<
	octave-forge,
	%type_raw[forge]-atlas-oct%type_pkg[oct],
	%type_raw[forge]-oct%type_pkg[oct]
<<
Replaces: <<
	%type_raw[forge]-atlas-oct%type_pkg[oct],
	%type_raw[forge]-oct%type_pkg[oct]
<<

Source-MD5: 518fda3ea4408e04af13ac2d7a9ee3a7

DescPackaging: <<
Common for all octave-forge packages.

We read in postinst and prerm template scripts installed by octaveN and modify
them to use the name of this package because Octave's package manager can't 
cope with non-literal arguments.

The Type: forge (pkgname) is used to minimize what needs to be changed when
using this .info file as a template.
<<

#### Insert required changes here ####

TarFilesRename: "linear-algebra":"linear-algebra-2.0.0"

######################################

# Do not change anything from this point down, unless absolutely necessary,
# since the foo-oct%type_pkg[oct] packages are designed to be built/installed
# in the same way.

Source: mirror:sourceforge:/octave/%type_raw[forge]-%v.tar.gz

NoSetCPPFLAGS: true
NoSetLDFLAGS: true
SetLIBRARY_PATH: /usr/X11R6/lib:%p/lib
SetMAKEFLAGS: -j1

CompileScript: <<
#!/bin/sh -ev
export OCTAVE=%p/bin/octave-%type_raw[oct] 
# repack tarball, since octave-3.4.3 appears not to want to install
# from directories
if [ "%type_pkg[oct]" = "343" ]
then
	cd ..
	tar -cvzf %type_raw[forge]-%v.tar.gz %type_raw[forge]-%v
	cd %b
	pkgsrc=%type_raw[forge]-%v.tar.gz
else pkgsrc=%type_raw[forge]-%v
fi
%p/share/octave/%type_raw[oct]/scripts/octave-forge-compile.sh $pkgsrc
<<

InstallScript: << 
	#!/bin/sh -ev
	# remove function which is built in for octave >= 3.4.3
	if [ %type_pkg[oct] -ge 343 ] 
		then rm %b/../bld/lib/octave/%type_raw[oct]/packages/%type_raw[forge]-%v/x86_64-apple-darwin-api-v45+/mgorth.oct
	fi
	%p/share/octave/%type_raw[oct]/scripts/octave-forge-install.sh %type_raw[forge]-%v %i %b
	mkdir -p %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	# copy template scripts
	cp %p/share/octave/%type_raw[oct]/scripts/octave-forge-prerm %p/share/octave/%type_raw[oct]/scripts/octave-forge-postinst %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	cd %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	sed -i -e 's/@PKGNAME@/%type_raw[forge]-%v/' octave-forge-postinst
	sed -i -e 's/@PKGNAME@/%type_raw[forge]/' octave-forge-prerm
	chmod a+x octave-forge*
<<
PostInstScript:  <<
	if [ -s %p/var/octave/%type_raw[oct]/octave_packages ] && [ -f %p/var/octave/%type_raw[oct]/octave_packages ] 
	then 
		%p/share/octave/%type_raw[oct]/%type_raw[forge]-%v/octave-forge-postinst
	else
 		mv %p/share/octave/%type_raw[oct]/packages/%type_raw[forge]-%v/octave_packages %p/var/octave/%type_raw[oct]/octave_packages
	fi
<<

PreRmScript: %p/share/octave/%type_raw[oct]/%type_raw[forge]-%v/octave-forge-prerm
<<