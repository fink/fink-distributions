Package: gildas
Version: 201208b
Revision: 1
Description: Radioastronomy data analysis software
License: OSI-Approved
Maintainer: Sebastien Maret <bmaret@users.sourceforge.net>
Source: http://www.iram.fr/~gildas/dist/gildas-src-aug12b.tar.gz
Source-MD5: ad71bcd2e8ebc5e9997964d526cd4d0e
SourceDirectory: gildas-src-aug12b
Depends: <<
  fftw3-shlibs, gcc47-shlibs, libpng3-shlibs, gtk+2-shlibs,
  python27, numpy-py27
<<
BuildDepends: <<
  atk1, cfitsio, fink (>= 0.29.5-1), fftw3, fontconfig2-dev,
  gcc47, glib2-dev, gtk+2-dev, libpng3, libgettext8-dev,
  pango1-xft2-ft219-dev, python27-shlibs, sed, slatec
<<
PatchFile: gildas.patch
PatchFile-MD5: 29ae12b53f294ea9c64f8c8a385b9977
PatchScript: sed 's|@PREFIX@|%p|g' < %{PatchFile} | patch -p1
CompileScript: <<
  true
<<
InstallScript: <<
#!/bin/bash -ev
  export arch="x86_64-darwin-gfortran"
  source admin/gildas-env.sh -s /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/Versions/Current/:/usr/X11/lib:/usr/X11/include:%p/lib:%p/include -c gfortran
  export GAG_SLDFLAGS='-install_name %p/lib/gildas/darwin-gfortran/lib/$(notdir $@)'
  export DYLD_LIBRARY_PATH=%b/integ/${arch}/lib
  export gagexedir=%i/lib/gildas
  install -d %i/bin %i/lib
  make install
  mv %i/lib/gildas/${arch} %i/lib/gildas/darwin-gfortran
  cd %i/lib/gildas/darwin-gfortran/bin/
  for file in * ; do
    ln -s %p/lib/gildas/darwin-gfortran/bin/${file} %i/bin/${file}
  done
  /usr/bin/install -d %i/etc/profile.d
  cat >%i/etc/profile.d/%n.csh <<EOF
setenv GAG_PATH '%p/lib/gildas/etc'
setenv GAG_ROOT_DIR '%p/lib/gildas'
setenv GAG_EXEC_SYSTEM 'darwin-gfortran'
if ( \$?PYTHONPATH ) then
  prepend_path PYTHONPATH '%p/lib/gildas/darwin-gfortran/python'
else
  setenv PYTHONPATH '%p/lib/gildas/darwin-gfortran/python'
endif
EOF
  cat >%i/etc/profile.d/%n.sh <<EOF
export GAG_PATH='%p/lib/gildas/etc'
export GAG_ROOT_DIR='%p/lib/gildas'
export GAG_EXEC_SYSTEM='darwin-gfortran'
if [ -z "\$PYTHONPATH" ]; then
  PYTHONPATH='%p/lib/gildas/darwin-gfortran/python'
else
  prepend_path PYTHONPATH '%p/lib/gildas/darwin-gfortran/python'
fi
export PYTHONPATH
EOF
  chmod 755 %i/etc/profile.d/gildas.*
<<
PostInstScript: echo "\n*** Installation completed. Please open a new term to use gildas ***"
DescDetail: <<
Gildas, the "Grenoble Image and Line Data Analysis Software", is a
collection of software oriented towards radioastronomical applications
(either single-dish or interferometer). It is daily used to reduce all
data acquired with the IRAM 30m telescope and Plateau de Bure
Interferometer (PdBI).
<<
Homepage: http://www.iram.fr/IRAMFR/GILDAS/gildas.html
