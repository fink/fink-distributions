diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/.gitignore trunk/nano/.gitignore
--- orig/nano-2.2.0/.gitignore	1970-01-01 00:00:00.000000000 +0000
+++ trunk/nano/.gitignore	2009-11-02 11:53:24.000000000 +0000
@@ -0,0 +1,26 @@
+*.o
+.deps
+.libs
+Makefile
+Makefile.in
+
+/ABOUT-NLS
+/INSTALL
+/aclocal.m4
+/autom4te.cache
+/config.guess
+/config.log
+/config.h
+/config.h.in
+/config.rpath
+/config.status
+/config.sub
+/configure
+/depcomp
+/install-sh
+/missing
+/mkinstalldirs
+/stamp-h1
+
+/nano.spec
+/src/nano
Only in orig/nano-2.2.0: ABOUT-NLS
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/ChangeLog trunk/nano/ChangeLog
--- orig/nano-2.2.0/ChangeLog	2009-11-30 05:06:06.000000000 +0000
+++ trunk/nano/ChangeLog	2009-12-05 14:55:15.000000000 +0000
@@ -1,6 +1,36 @@
+2009-12-03 David Lawrence Ramsey <pooka109@gmail.com>
+	* global.c (shortcut_init) - Remove help shortcut from help shortcut list :-)  Tweaked 
+	  to reorder exit shortcut to end of list to not mess up prev/next shortcut symmetry.
+
+2009-12-03 Eitan Adler <eitanadlerlist@gmail.com>
+	* doc/syntax/makefile.nanorc - Fix poor regex for all alpha characters which sometimes leads to
+	  error messages, reported by gibboris@gmail.com.
+
+2009-12-02 Chris Allegretta <chrisa@asty.org>
+	* text.c (add_undo, do_undo, do_redo) - Do not execute cases for SPLIT when DISABLE_WRAPPING
+	  is defined.  Fixes Savannah bug 28151 (anon).
+
+2009-12-02 Jordi Mallach <jordi@gnu.org>
+	* doc/man/nano.1: Fix escaping of hyphens for the -$ option.
+
+2009-12-01 Kamil Dudka <kdudka@redhat.com>
+	* chars.c, file.c - Better handle unused results for things like mbtowc(), new
+	  macro IGNORE_CALL_RESULT.
+
+2009-12-01 Chris Allegretta <chrisa@asty.org>
+	* global.c (shortcut_init) - Remove redundant entries for ^Y/^V reported by
+	  Christian Weisgerber.
+	* doc/man/nanorc.5 - Fix typo in Meta documentation, reported by gibboris@gmail.com.
+
+2009-12-01 David Lawrence Ramsey <pooka109@gmail.com>
+	* global.c (shortcut_init) - Add support for ^P and ^N in the help menu.
+	* Update documentation for 2.2 features including sample nanorc file, texinfo
+	  file, man pages, UPGRADE file, and update copyright noticed for the current year.
+
 GNU nano 2.2.0 - 2009.11.30
 2009-11-29 Chris Allegretta <chrisa@asty.org>
-	* prompt.c (get_prompt_string) - Universally handle help key when is disabled.  Fixes Savannah
+	* prompt.c (get_prompt_string) - Universally handle help key when is 
+disabled.  Fixes Savannah
 	  bug 28117 by David Lawrence Ramsey <pooka109@gmail.com>.
 	* chars.c, files.c: Add junk vars to silence the compiler.  Sigh.
 
Only in orig/nano-2.2.0: INSTALL
Only in orig/nano-2.2.0: Makefile.in
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/NEWS trunk/nano/NEWS
--- orig/nano-2.2.0/NEWS	2009-11-30 05:23:37.000000000 +0000
+++ trunk/nano/NEWS	2009-12-05 14:55:15.000000000 +0000
@@ -1237,4 +1237,4 @@
 		update your bookmarks, tell your friends, and all that
 		jazz.
 
-$Id: NEWS 4435 2009-11-22 02:49:39Z astyanax $
+$Id: NEWS 4450 2009-11-30 05:26:30Z astyanax $
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/UPGRADE trunk/nano/UPGRADE
--- orig/nano-2.2.0/UPGRADE	2009-08-14 03:16:33.000000000 +0000
+++ trunk/nano/UPGRADE	2009-12-05 14:55:15.000000000 +0000
@@ -1,6 +1,22 @@
 GNU nano upgrading information
 ==============================
 
+Visible changes since 2.0
+-------------------------
+* Editor Features
+  - The ability to rebind (reassign) keys using the nanorc.
+  - The ability to read standard input like a pager ("nano -").
+  - Color syntax highlighting can be set by the first line of a file.
+  - The ability to silence nanorc error messages (-q).
+  - Undo/redo operations (-u).
+  - Soft wrapping of text (-$).
+
+* File Handling
+  - Better handling of backup files: if nano can't write a backup file,
+    it won't try to write the original file afterward.
+  - Emergency savefiles retain ownerships and permissions when possible.
+  - Performance improvements in color syntax highlighting.
+
 Visible changes since 1.2
 -------------------------
 * Editor Features
Only in orig/nano-2.2.0: aclocal.m4
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/autogen.sh trunk/nano/autogen.sh
--- orig/nano-2.2.0/autogen.sh	1970-01-01 00:00:00.000000000 +0000
+++ trunk/nano/autogen.sh	2009-11-02 11:53:24.000000000 +0000
@@ -0,0 +1,4 @@
+#!/bin/sh
+# Generate configure & friends for CVS users.
+
+autoreconf -f -i -s
Only in orig/nano-2.2.0: config.guess
Only in orig/nano-2.2.0: config.h.in
Only in orig/nano-2.2.0: config.rpath
Only in orig/nano-2.2.0: config.sub
Only in orig/nano-2.2.0: configure
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/configure.ac trunk/nano/configure.ac
--- orig/nano-2.2.0/configure.ac	2009-11-30 05:24:17.000000000 +0000
+++ trunk/nano/configure.ac	2009-12-05 14:55:15.000000000 +0000
@@ -18,9 +18,9 @@
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301,
 # USA.
 #
-# $Id: configure.ac 4449 2009-11-29 06:24:10Z astyanax $
+# $Id: configure.ac 4452 2009-12-02 03:24:18Z astyanax $
 
-AC_INIT([GNU nano], [2.2.0], [nano-devel@gnu.org], [nano])
+AC_INIT([GNU nano], [2.2.0-svn], [nano-devel@gnu.org], [nano])
 AC_CONFIG_SRCDIR([src/nano.c])
 AC_CANONICAL_TARGET([])
 AM_INIT_AUTOMAKE
Only in orig/nano-2.2.0: depcomp
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/.gitignore trunk/nano/doc/.gitignore
--- orig/nano-2.2.0/doc/.gitignore	1970-01-01 00:00:00.000000000 +0000
+++ trunk/nano/doc/.gitignore	2009-11-02 11:53:17.000000000 +0000
@@ -0,0 +1 @@
+/nanorc.sample
Only in orig/nano-2.2.0/doc: Makefile.in
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/faq.html trunk/nano/doc/faq.html
--- orig/nano-2.2.0/doc/faq.html	2009-11-18 22:09:37.000000000 +0000
+++ trunk/nano/doc/faq.html	2009-12-05 14:55:13.000000000 +0000
@@ -83,9 +83,9 @@
 <h2><a name="1.5"></a>1.5. Why the name change from TIP?</h2>
 <blockquote><p>On January 10, 2000, TIP was officially renamed to nano because of a namespace conflict with another program called 'tip'. The original 'tip' program &quot;establishes a full duplex terminal connection to a remote host&quot;, and was included with many older Unix systems (and newer ones like Solaris). The conflict was not noticed at first because there is no 'tip' utility included with most GNU/Linux distributions (where nano was developed).</p></blockquote>
 <h2><a name="1.6"></a>1.6. What is the current version of nano?</h2>
-<blockquote><p>The current version of nano *should* be 2.0.7. Of course, you should always check the nano homepage to see what the latest and greatest version is.</p></blockquote>
+<blockquote><p>The current version of nano *should* be 2.2.0. Of course, you should always check the nano homepage to see what the latest and greatest version is.</p></blockquote>
 <h2><a name="1.7"></a>1.7. I want to read the man page without having to download the program!</h2>
-<blockquote><p>Jeez, demanding, aren't we? Okay, look <a href="http://www.nano-editor.org/dist/v2.0/nano.1.html">here</a>.</p></blockquote>
+<blockquote><p>Jeez, demanding, aren't we? Okay, look <a href="http://www.nano-editor.org/dist/v2.2/nano.1.html">here</a>.</p></blockquote>
 <hr width="100%">
 <h1><a name="2"></a>2. Where to get GNU nano.</h1>
 <h2><a name="2.1"></a>2.1. FTP and WWW sites that carry nano.</h2>
@@ -99,8 +99,8 @@
 <h2><a name="2.2"></a>2.2. RedHat and derivatives (.rpm) packages.</h2>
 <blockquote>
   <ul>
-    <li><a href="http://www.nano-editor.org/dist/v2.0/RPMS/">http://www.nano-editor.org/dist/v2.0/RPMS/</a></li>
-    <li><a href="http://www.ewtoo.org/~astyanax/nano/dist/v2.0/RPMS/">http://www.ewtoo.org/~astyanax/nano/dist/v2.0/RPMS/</a></li>
+    <li><a href="http://www.nano-editor.org/dist/v2.2/RPMS/">http://www.nano-editor.org/dist/v2.2/RPMS/</a></li>
+    <li><a href="http://www.ewtoo.org/~astyanax/nano/dist/v2.2/RPMS/">http://www.ewtoo.org/~astyanax/nano/dist/v2.2/RPMS/</a></li>
   </ul>
 </blockquote>
 <h2><a name="2.3"></a>2.3. Debian (.deb) packages.</h2>
@@ -246,7 +246,7 @@
   help-nano - <a href="http://mail.gnu.org/mailman/listinfo/help-nano/">http://mail.gnu.org/mailman/listinfo/help-nano/</a><br>
   nano-devel - <a href="http://mail.gnu.org/mailman/listinfo/nano-devel/">http://mail.gnu.org/mailman/listinfo/nano-devel/</a></p></blockquote>
 <h2><a name="7.2"></a>7.2. I want to send the development team a big load of cash (or just a thank you).</h2>
-<blockquote><p>That's fine. Send it <a href="mailto:nano-devel@gnu.org">our way</a>! Better yet, fix a <a href="http://www.nano-editor.org/dist/v2.0/BUGS">bug</a> in the program or implement a <a href="http://www.nano-editor.org/dist/v2.0/TODO">cool feature</a> and send us that instead (though cash is fine too).</p></blockquote>
+<blockquote><p>That's fine. Send it <a href="mailto:nano-devel@gnu.org">our way</a>! Better yet, fix a <a href="http://www.nano-editor.org/dist/v2.2/BUGS">bug</a> in the program or implement a <a href="http://www.nano-editor.org/dist/v2.2/TODO">cool feature</a> and send us that instead (though cash is fine too).</p></blockquote>
 <h2><a name="7.3"></a>7.3. How do I submit a bug report or patch?</h2>
 <blockquote>
 <p>The best place to submit bugs is to the <A HREF="https://savannah.gnu.org/bugs/?group=nano">Savannah bug tracker</A> as you can check whether the bug you are submitting has already been submitted.
@@ -256,8 +256,10 @@
 <h2><a name="7.5"></a>7.5. Can I have write access to the subversion tree?</h2>
 <blockquote><p>Re-read Section <a href="#7.4">7.4</a> and you should know the answer.</p></blockquote>
 <h2><a name="8"></a>8. ChangeLog</h2>
-<blockquote><p>2007/12/21 - Update maintainer information. (DLR)<br>
-2008/03/16 - Update docs to refer to subversion instead of CVS, add more words about Apline, and refer to Savannah for bugs and patches.  (chrisa)
+<blockquote><p>2009/11/30 - Update various bits for nano 2.2.x. (DLR)<br>
+2009/11/18 - Typo fix. (j.mader@gmail.com)<br>
+2008/03/16 - Update docs to refer to subversion instead of CVS, add more words about Alpine, and refer to Savannah for bugs and patches. (chrisa)<br>
+2007/12/21 - Update maintainer information. (DLR)<br>
 2007/12/09 - Add minor punctuation and wording fixes, and update various sections to account for Alpine. (DLR)<br>
 2007/08/26 - Update links to the Free Translation Project. (DLR)<br>
 2007/07/29 - Update RPM links for nano 2.0.x. (DLR)<br>
@@ -319,6 +321,6 @@
 2000/11/18 - Previous string display (4.5).<br>
 2000/09/27 - Moved addresses to nano-editor.org.<br>
 2000/06/31 - Initial framework.</p></blockquote>
-<p>$Id: faq.html 4431 2009-11-18 22:10:13Z astyanax $</p>
+<p>$Id: faq.html 4453 2009-12-02 03:36:22Z astyanax $</p>
 </body>
 </html>
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/man/.gitignore trunk/nano/doc/man/.gitignore
--- orig/nano-2.2.0/doc/man/.gitignore	1970-01-01 00:00:00.000000000 +0000
+++ trunk/nano/doc/man/.gitignore	2009-11-02 11:53:17.000000000 +0000
@@ -0,0 +1,3 @@
+nano.1.html
+nanorc.5.html
+rnano.1.html
Only in orig/nano-2.2.0/doc/man: Makefile.in
Only in orig/nano-2.2.0/doc/man/fr: Makefile.in
Only in orig/nano-2.2.0/doc/man/fr: nano.1.html
Only in orig/nano-2.2.0/doc/man/fr: nanorc.5.html
Only in orig/nano-2.2.0/doc/man/fr: rnano.1.html
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/man/nano.1 trunk/nano/doc/man/nano.1
--- orig/nano-2.2.0/doc/man/nano.1	2009-11-27 02:49:31.000000000 +0000
+++ trunk/nano/doc/man/nano.1	2009-12-05 14:55:13.000000000 +0000
@@ -1,6 +1,6 @@
 .\" Hey, EMACS: -*- nroff -*-
-.\" Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007
-.\" Free Software Foundation, Inc.
+.\" Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,
+.\" 2008, 2009 Free Software Foundation, Inc.
 .\"
 .\" This document is dual-licensed.  You may distribute and/or modify it
 .\" under the terms of either of the following licenses:
@@ -18,8 +18,8 @@
 .\"   Documentation License along with this program.  If not, see
 .\"   <http://www.gnu.org/licenses/>.
 .\"
-.\" $Id: nano.1 4443 2009-11-27 02:50:12Z astyanax $
-.TH NANO 1 "version 2.0.0" "August 23, 2007"
+.\" $Id: nano.1 4454 2009-12-02 22:47:57Z jordi $
+.TH NANO 1 "version 2.2.0" "November 30, 2009"
 .\" Please adjust this date whenever revising the manpage.
 .\"
 
@@ -79,11 +79,11 @@
 .TP
 .B \-H (\-\-historylog)
 Log search and replace strings to \fI~/.nano_history\fP, so they can be
-retrieved in later sessions, if nanorc support is available.
+retrieved in later sessions, if \fInanorc\fP support is available.
 .TP
 .B \-I (\-\-ignorercfiles)
-Don't look at \fISYSCONFDIR/nanorc\fP or \fI~/.nanorc\fP, if nanorc
-support is available.
+Don't look at \fISYSCONFDIR/nanorc\fP or \fI~/.nanorc\fP, if
+\fInanorc\fP support is available.
 .TP
 .B \-K (\-\-rebindkeypad)
 Interpret the numeric keypad keys so that they all work properly.  You
@@ -107,10 +107,11 @@
 .TP
 .B \-R (\-\-restricted)
 Restricted mode: don't read or write to any file not specified on the
-command line; read any nanorc files; allow suspending; allow a file
-to be appended to, prepended to, or saved under a different name if it
-already has one; or use backup files or spell checking.  Also accessible
-by invoking \fBnano\fP with any name beginning with 'r' (e.g. "rnano").
+command line; read any \fInanorc\fP files; allow suspending; allow a
+file to be appended to, prepended to, or saved under a different name if
+it already has one; or use backup files or spell checking.  Also
+accessible by invoking \fBnano\fP with any name beginning with 'r' (e.g.
+"rnano").
 .TP
 .B \-S (\-\-smooth)
 Enable smooth scrolling.  Text will scroll line-by-line, instead of the
@@ -173,8 +174,8 @@
 by the terminal.
 .TP
 .B \-q (\-\-quiet)
-Do not report errors in the nanorc file and ask them to
-be acknowledged by pressing enter at startup.
+Do not report errors in the \fInanorc\fP file and ask them to be
+acknowledged by pressing Enter at startup.
 .TP
 .B \-r \fIcols\fP (\-\-fill=\fIcols\fP)
 Wrap lines at column \fIcols\fP.  If this value is 0 or less, wrapping
@@ -206,11 +207,11 @@
 Enable suspend ability.
 .TP
 .B \-$ (\-\-softwrap)
-Enable 'soft wrapping'.  Nano will attempt to display lines the entire 
-contents of a line, even if it is longer than the screen width.
-Since '$' normally refers to a variable in the Unix shell, you should
-specify this option last when using other options (e.g. 'nano -wS$') 
-or pass it separately (e.g. 'nano -wS -$'). 
+Enable 'soft wrapping'.  \fBnano\fP will attempt to display the entire
+contents of a line, even if it is longer than the screen width.  Since
+'$' normally refers to a variable in the Unix shell, you should specify
+this option last when using other options (e.g. 'nano \-wS$') or pass it
+separately (e.g. 'nano \-wS \-$').
 .TP
 .B \-a, \-b, \-e, \-f, \-g, \-j
 Ignored, for compatibility with Pico.
@@ -223,7 +224,7 @@
 
 .SH NOTES
 If no alternative spell checker command is specified on the command
-line or in one of the nanorc files, \fBnano\fP will check the
+line or in one of the \fInanorc\fP files, \fBnano\fP will check the
 \fBSPELL\fP environment variable for one.
 
 In some cases \fBnano\fP will try to dump the buffer into an emergency
Only in orig/nano-2.2.0/doc/man: nano.1.html
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/man/nanorc.5 trunk/nano/doc/man/nanorc.5
--- orig/nano-2.2.0/doc/man/nanorc.5	2009-11-27 02:49:31.000000000 +0000
+++ trunk/nano/doc/man/nanorc.5	2009-12-05 14:55:13.000000000 +0000
@@ -1,5 +1,5 @@
 .\" Hey, EMACS: -*- nroff -*-
-.\" Copyright (C) 2003, 2004, 2005, 2006, 2007
+.\" Copyright (C) 2003, 2004, 2005, 2006, 2007, 2008, 2009
 .\" Free Software Foundation, Inc.
 .\"
 .\" This document is dual-licensed.  You may distribute and/or modify it
@@ -18,7 +18,7 @@
 .\"   Documentation License along with this program.  If not, see
 .\"   <http://www.gnu.org/licenses/>.
 .\"
-.\" $Id: nanorc.5 4443 2009-11-27 02:50:12Z astyanax $
+.\" $Id: nanorc.5 4453 2009-12-02 03:36:22Z astyanax $
 .TH NANORC 5 "version 2.0.0" "August 23, 2007"
 .\" Please adjust this date whenever revising the manpage.
 .\"
@@ -45,9 +45,9 @@
 and \fBicolor\fP keywords are used to define syntax highlighting rules
 for different text patterns.  \fBnano\fP will read one command per line.
 
-Options in nanorc files take precedence over nano's defaults, and
-command line options override nanorc settings.  Also, options are unset
-by default, except for those that take arguments.
+Options in \fInanorc\fP files take precedence over nano's defaults, and
+command line options override \fInanorc\fP settings.  Also, options are
+unset by default, except for those that take arguments.
 
 Quotes inside string parameters don't have to be escaped with
 backslashes.  The last double quote in the string will be treated as its
@@ -146,9 +146,9 @@
 The default value is "\fI!.?\fP".
 .TP
 .B set/unset quiet
-\fBnano\fP will not report errors in the nanorc file and ask them to 
-be acknowledged by pressing enter at startup.  If this is used it should
-be placed at the top of the file to be fully effective.
+\fBnano\fP will not report errors in the \fInanorc\fP file and ask them
+to be acknowledged by pressing enter at startup.  If this is used it
+should be placed at the top of the file to be fully effective.
 .TP
 .B set/unset quickblank
 Do quick statusbar blanking.  Statusbar messages will disappear after 1
@@ -276,7 +276,7 @@
 Example: ^C
 .TP
 .B M- 
-followed by a prinable character or the word "Space".
+followed by a printable character or the word "Space".
 Example: M-C
 .TP
 .B F 
@@ -414,7 +414,7 @@
 Undo the text action peformed (add text, delete text, etc).
 .TP
 .B redo
-"Re-do" the last undone action (i.e. undo an undo)
+Redo the last undone action (i.e., undo an undo).
 .TP
 .B suspend
 Suspend the editor (if the suspend function is enabled, see the 
Only in orig/nano-2.2.0/doc/man: nanorc.5.html
Only in orig/nano-2.2.0/doc/man: rnano.1.html
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/nanorc.sample.in trunk/nano/doc/nanorc.sample.in
--- orig/nano-2.2.0/doc/nanorc.sample.in	2009-11-28 04:00:04.000000000 +0000
+++ trunk/nano/doc/nanorc.sample.in	2009-12-05 14:55:13.000000000 +0000
@@ -141,6 +141,9 @@
 ## Use smooth scrolling as the default.
 # set smooth
 
+## Enable soft line wrapping (AKA full line display).
+# set softwrap
+
 ## Use this spelling checker instead of the internal one.  This option
 ## does not properly have a default value.
 ##
@@ -149,6 +152,10 @@
 ## Allow nano to be suspended.
 # set suspend
 
+## If nano is allowed to be suspended, allow the suspend key (usually
+## ^Z) to actually suspend it.
+# set suspendenable
+
 ## Use this tab size instead of the default; it must be greater than 0.
 # set tabsize 8
 
@@ -158,6 +165,10 @@
 ## Save automatically on exit, don't prompt.
 # set tempfile
 
+## Enable the new (EXPERIMENTAL) generic undo code, not just for line
+## cuts.
+# set undo
+
 ## Disallow file modification.  Why would you want this in an rcfile? ;)
 # set view
 
@@ -170,12 +181,6 @@
 ## characters as parts of words.
 # set wordbounds
 
-## Enable the new (EXPERIMENTAL) generic undo code, not just for line cuts
-# set undo
-
-## Enable soft line wrapping (AKA full line display)
-# set softwrap
-
 
 ## Color setup
 ##
Only in orig/nano-2.2.0/doc/syntax: Makefile.in
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/syntax/makefile.nanorc trunk/nano/doc/syntax/makefile.nanorc
--- orig/nano-2.2.0/doc/syntax/makefile.nanorc	2009-11-28 04:08:34.000000000 +0000
+++ trunk/nano/doc/syntax/makefile.nanorc	2009-12-05 14:55:13.000000000 +0000
@@ -3,6 +3,6 @@
 syntax "makefile" "Makefile[^/]*$"
 color red "[:=]"
 color magenta "\<(if|ifeq|else|endif)\>"
-color blue "\$+[{(][a-Z0-9_-]+[})]"
+color blue "\$+[{(][a-zA-Z0-9_-]+[})]"
 color brightblue "^[^ 	]+:"
 color green "#.*$"
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/syntax/nanorc.nanorc trunk/nano/doc/syntax/nanorc.nanorc
--- orig/nano-2.2.0/doc/syntax/nanorc.nanorc	2009-08-14 03:16:32.000000000 +0000
+++ trunk/nano/doc/syntax/nanorc.nanorc	2009-12-05 14:55:13.000000000 +0000
@@ -4,7 +4,7 @@
 ## Possible errors and parameters
 icolor brightwhite "^[[:space:]]*((un)?set|include|syntax|i?color).*$"
 ## Keywords
-icolor brightgreen "^[[:space:]]*(set|unset)[[:space:]]+(autoindent|backup|backupdir|backwards|boldtext|brackets|casesensitive|const|cut|fill|historylog|matchbrackets|morespace|mouse|multibuffer|noconvert|nofollow|nohelp|nonewlines|nowrap|operatingdir|preserve|punct)\>" "^[[:space:]]*(set|unset)[[:space:]]+(quickblank|quotestr|rebinddelete|rebindkeypad|regexp|smarthome|smooth|speller|suspend|tabsize|tabstospaces|tempfile|view|whitespace|wordbounds)\>"
+icolor brightgreen "^[[:space:]]*(set|unset)[[:space:]]+(autoindent|backup|backupdir|backwards|boldtext|brackets|casesensitive|const|cut|fill|historylog|matchbrackets|morespace|mouse|multibuffer|noconvert|nofollow|nohelp|nonewlines|nowrap|operatingdir|preserve|punct)\>" "^[[:space:]]*(set|unset)[[:space:]]+(quickblank|quotestr|rebinddelete|rebindkeypad|regexp|smarthome|smooth|softwrap|speller|suspend|suspendenable|tabsize|tabstospaces|tempfile|undo|view|whitespace|wordbounds)\>"
 icolor green "^[[:space:]]*(set|unset|include|syntax|header)\>"
 ## Colors
 icolor yellow "^[[:space:]]*i?color[[:space:]]*(bright)?(white|black|red|blue|green|yellow|magenta|cyan)?(,(white|black|red|blue|green|yellow|magenta|cyan))?\>"
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/texinfo/.gitignore trunk/nano/doc/texinfo/.gitignore
--- orig/nano-2.2.0/doc/texinfo/.gitignore	1970-01-01 00:00:00.000000000 +0000
+++ trunk/nano/doc/texinfo/.gitignore	2009-11-02 11:53:17.000000000 +0000
@@ -0,0 +1,3 @@
+texinfo.tex
+nano.html
+nano.info
Only in orig/nano-2.2.0/doc/texinfo: Makefile.in
Only in orig/nano-2.2.0/doc/texinfo: nano.html
Only in orig/nano-2.2.0/doc/texinfo: nano.info
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/doc/texinfo/nano.texi trunk/nano/doc/texinfo/nano.texi
--- orig/nano-2.2.0/doc/texinfo/nano.texi	2009-08-14 03:16:32.000000000 +0000
+++ trunk/nano/doc/texinfo/nano.texi	2009-12-05 14:55:13.000000000 +0000
@@ -8,8 +8,8 @@
 @c Run 'makeinfo' rather than 'texinfo-format-buffer'.
 @smallbook
 @set EDITION 0.1
-@set VERSION 2.0.0
-@set UPDATED 17 Dec 2007
+@set VERSION 2.2.0
+@set UPDATED 30 Nov 2009
 
 @dircategory Editors
 @direntry
@@ -23,7 +23,7 @@
 @titlepage
 @title GNU @code{nano}
 @subtitle a small and friendly text editor.
-@subtitle version 2.0.0
+@subtitle version 2.2.0
 
 @author Chris Allegretta
 @page
@@ -33,8 +33,8 @@
 
 This manual is part of the GNU @code{nano} distribution.@*
 @sp4
-Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007
-Free Software Foundation, Inc.
+Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,
+2008, 2009 Free Software Foundation, Inc.
 
 This document is dual-licensed.  You may distribute and/or modify it
 under the terms of either of the following licenses:
@@ -249,6 +249,10 @@
 Preserve the ^Q (XON) and ^S (XOFF) sequences so data being sent to the
 editor can be can be stopped and started.
 
+@item -q, --quiet
+Do not report errors in the nanorc file and ask them to be acknowledged
+by pressing Enter at startup.
+
 @item -r <#cols>, --fill=<#cols>
 Wrap lines at column #cols.  If this value is 0 or less, wrapping will
 occur at the width of the screen less #cols, allowing it to vary along
@@ -266,6 +270,10 @@
 exiting, assume yes.  This is most useful when using @code{nano} as the
 composer of a mailer program.
 
+@item -u, --undo
+Enable experimental generic-purpose undo code.  By default, the undo and
+redo shortcuts are Meta-U and Meta-E, respectively.
+
 @item -v, --view
 Don't allow the contents of the file to be altered.  Note that this
 option should NOT be used in place of correct file permissions to
@@ -288,6 +296,13 @@
 Enable @code{nano}'s suspend ability using the system's suspend
 keystroke (usually ^Z).
 
+@item -$, --softwrap
+Enable 'soft wrapping'.  @code{nano} will attempt to display the entire
+contents of a line, even if it is longer than the screen width.  Since
+'$' normally refers to a variable in the Unix shell, you should specify
+this option last when using other options (e.g. 'nano -wS$') or pass it
+separately (e.g. 'nano -wS -$').
+
 @item -a, -b, -e, -f, -g, -j
 Ignored, for compatibility with Pico.
 @end table
@@ -447,6 +462,9 @@
 @item Suspend Toggle (Meta-Z)
 toggles the -z (@code{--suspend}) command line option.
 
+@item Soft Wrapping Toggle (Meta-$)
+toggles the -$ (@code{--softwrap}) command line option.
+
 @end table
 
 
@@ -615,6 +633,9 @@
 @item set/unset smooth
 Use smooth scrolling by default.
 
+@item set/unset softwrap
+Use soft wrapping by default.
+
 @item set speller "spellprog"
 Use spelling checker "spellprog" instead of the built-in one, which
 calls "spell".
@@ -622,6 +643,10 @@
 @item set/unset suspend
 Allow @code{nano} to be suspended.
 
+@item set/unset suspendenable
+If @code{nano} is allowed to be suspended, allow the suspend key
+(usually ^Z) to actually suspend it.
+
 @item set tabsize "n"
 Use a tab size of "n" columns.  The value of "n" must be greater than 0.
 The default value is 8.
@@ -632,6 +657,9 @@
 @item set/unset tempfile
 Save automatically on exit, don't prompt.
 
+@item set/unset undo
+Enable experimental generic-purpose undo code.
+
 @item set/unset view
 Disallow file modification.
 
Only in orig/nano-2.2.0/doc/texinfo: texinfo.tex
Only in orig/nano-2.2.0: install-sh
Only in orig/nano-2.2.0/m4: Makefile.in
Only in orig/nano-2.2.0: missing
Only in orig/nano-2.2.0: mkinstalldirs
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/nano-regress trunk/nano/nano-regress
--- orig/nano-2.2.0/nano-regress	1970-01-01 00:00:00.000000000 +0000
+++ trunk/nano/nano-regress	2009-12-05 14:55:15.000000000 +0000
@@ -0,0 +1,29 @@
+#!/usr/bin/perl
+use strict;
+
+sub combinations {
+  return [] unless @_;
+  my $first = shift;
+  my @rest = combinations(@_);
+  return @rest, map { [$first, @$_] } @rest;
+} 
+
+my @allargs=("--enable-debug", "--disable-wrapping", "--disable-justify", "--disable-extra", "--enable-tiny", "--disable-browser --disable-help --disable-mouse --disable-operatingdir --disable-speller", "--disable-multibuffer", "--disable-nanorc", "--with-slang");
+my @combos =  combinations(@allargs);
+
+my $i = 0;
+foreach my $name (@combos) {
+    my @args = @$name;
+    my $pct = $i / $#combos * 100;
+    printf "Trying with options: @args, %d%% done...\n", $pct;
+    my $cmd = "./configure @args && make clean all";
+    system("($cmd) >/dev/null 2>&1");
+    if ($? != 0)  {
+	print "Build failed for args: @args\n";
+	print "To reproduce, run:\n $cmd\n";
+	exit(1);
+    }
+    $i++;
+}
+
+print "All options completed successfully!\n";
Only in orig/nano-2.2.0: nano.spec
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/po/.gitignore trunk/nano/po/.gitignore
--- orig/nano-2.2.0/po/.gitignore	1970-01-01 00:00:00.000000000 +0000
+++ trunk/nano/po/.gitignore	2009-11-02 11:53:24.000000000 +0000
@@ -0,0 +1,11 @@
+/*.gmo
+
+/Makefile.in.in
+/Rules-quot
+/boldquot.sed
+/en@boldquot.header
+/en@quot.header
+/insert-header.sin
+/POTFILES
+/quot.sed
+/remove-potcdate.sin
Only in orig/nano-2.2.0/po: Makefile.in.in
Only in orig/nano-2.2.0/po: Rules-quot
Only in orig/nano-2.2.0/po: bg.gmo
Only in orig/nano-2.2.0/po: boldquot.sed
Only in orig/nano-2.2.0/po: ca.gmo
Only in orig/nano-2.2.0/po: cs.gmo
Only in orig/nano-2.2.0/po: da.gmo
Only in orig/nano-2.2.0/po: de.gmo
Only in orig/nano-2.2.0/po: en@boldquot.header
Only in orig/nano-2.2.0/po: en@quot.header
Only in orig/nano-2.2.0/po: es.gmo
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/po/es.po trunk/nano/po/es.po
--- orig/nano-2.2.0/po/es.po	2009-11-30 05:24:59.000000000 +0000
+++ trunk/nano/po/es.po	2009-12-05 14:55:14.000000000 +0000
@@ -1,7 +1,7 @@
 # translation of nano-1.9.99pre0.es.po to Spanish
 # Mensajes en español para GNU nano.
 # Copyright (C) 2000, 2001, 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
-# $Id: es.po,v 1.127 2002/10/26 19:56:43 jordi Exp $
+# $Id: es.po 4450 2009-11-30 05:26:30Z astyanax $
 #
 # Jordi Mallach <jordi@sindominio.net>, 2000, 2001, 2002.
 # Ricardo Cárdenes <ricardo@conysis.com>, 2002, 2003, 2004, 2005.
Only in orig/nano-2.2.0/po: eu.gmo
Only in orig/nano-2.2.0/po: fi.gmo
Only in orig/nano-2.2.0/po: fr.gmo
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/po/fr.po trunk/nano/po/fr.po
--- orig/nano-2.2.0/po/fr.po	2009-11-30 05:24:59.000000000 +0000
+++ trunk/nano/po/fr.po	2009-12-05 14:55:14.000000000 +0000
@@ -1,7 +1,7 @@
 # translation of nano.po to FranÃ§ais
 # Messages en langue franÃ§aise pour l'Ã©diteur nano
 # Copyright (C) 2000, 2001 Free Software Foundation, Inc.
-# $Id: nano.fr.po,v 1.81 2009/09/06 22:58:06 fevrier Exp fevrier $
+# $Id: fr.po 4450 2009-11-30 05:26:30Z astyanax $
 # This file is distributed under the same license as the nano package.
 #
 # Pierre Tane <tanep@bigfoot.com>, 2000.
Only in orig/nano-2.2.0/po: ga.gmo
Only in orig/nano-2.2.0/po: gl.gmo
Only in orig/nano-2.2.0/po: hu.gmo
Only in orig/nano-2.2.0/po: id.gmo
Only in orig/nano-2.2.0/po: insert-header.sin
Only in orig/nano-2.2.0/po: it.gmo
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/po/it.po trunk/nano/po/it.po
--- orig/nano-2.2.0/po/it.po	2009-11-30 05:25:02.000000000 +0000
+++ trunk/nano/po/it.po	2009-12-05 14:55:14.000000000 +0000
@@ -2,7 +2,7 @@
 # Copyright (C) 2001-2006, 2008, 2009 Free Software Foundation, Inc.
 # This file is distributed under the same license as the nano package.
 # Marco Colombo <m.colombo@ed.ac.uk>, 2001-2009.
-# $Id: it.po,v 1.116 2006/06/09 09:37:06 jordi Exp $
+# $Id: it.po 4450 2009-11-30 05:26:30Z astyanax $
 #
 msgid ""
 msgstr ""
Only in orig/nano-2.2.0/po: ms.gmo
Only in orig/nano-2.2.0/po: nb.gmo
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/po/nb.po trunk/nano/po/nb.po
--- orig/nano-2.2.0/po/nb.po	2009-11-30 05:25:02.000000000 +0000
+++ trunk/nano/po/nb.po	2009-12-05 14:55:14.000000000 +0000
@@ -3,7 +3,7 @@
 # Eivind Kjørstad <ekj@vestdata.no>, 2001.
 # Stig E Sandø <stig@ii.uib.no>, 2002.
 # Geir Helland <pjallabais@users.sourceforge.net>, 2004
-# $Id: nb.po,v 1.3 2002/01/23 01:06:20 astyanax Exp $
+# $Id: nb.po 4450 2009-11-30 05:26:30Z astyanax $
 #
 msgid ""
 msgstr ""
Only in orig/nano-2.2.0/po: nl.gmo
Only in orig/nano-2.2.0/po: nn.gmo
Only in orig/nano-2.2.0/po: pl.gmo
Only in orig/nano-2.2.0/po: pt_BR.gmo
Only in orig/nano-2.2.0/po: quot.sed
Only in orig/nano-2.2.0/po: remove-potcdate.sin
Only in orig/nano-2.2.0/po: ro.gmo
Only in orig/nano-2.2.0/po: ru.gmo
Only in orig/nano-2.2.0/po: rw.gmo
Only in orig/nano-2.2.0/po: sr.gmo
Only in orig/nano-2.2.0/po: sv.gmo
Only in orig/nano-2.2.0/po: tr.gmo
Only in orig/nano-2.2.0/po: uk.gmo
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/po/update.pl trunk/nano/po/update.pl
--- orig/nano-2.2.0/po/update.pl	1970-01-01 00:00:00.000000000 +0000
+++ trunk/nano/po/update.pl	2009-11-02 11:53:24.000000000 +0000
@@ -0,0 +1,368 @@
+#!/usr/bin/perl -w
+
+#
+#  GNOME PO Update Utility
+#
+#  Copyright (C) 2000, 2003 Free Software Foundation, Inc.
+#
+#  This script is free software; you can redistribute it and/or modify
+#  it under the terms of the GNU General Public License as published by
+#  the Free Software Foundation; either version 3 of the License, or (at
+#  your option) any later version.
+#
+#  This script is distributed in the hope that it will be useful, but
+#  WITHOUT ANY WARRANTY; without even the implied warranty of
+#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+#  General Public License for more details.
+#
+#  You should have received a copy of the GNU General Public License
+#  along with this library; if not, write to the Free Software
+#  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301,
+#  USA.
+#
+#  Authors: Kenneth Christiansen <kenneth@gnu.org>
+#
+
+#  NOTICE: Please remember to change the variable $PACKAGE to reflect 
+#  the package this script is used within.
+
+$PACKAGE="nano";
+
+use File::Basename;
+
+# Declare global variables
+#-------------------------
+my $VERSION = "1.5beta5";
+my $LANG    = $ARGV[0];
+
+# Always print as the first thing
+#--------------------------------
+$| = 1;
+
+# Figure out what package that is in use
+#---------------------------------------
+#open FILE, "../configure.in";
+#    while (<FILE>) {
+#	next if /^dnl/; #ignore comments
+#        if ($_=~/AM_INIT_AUTOMAKE\((.*),(.*)\)/o){
+#            $PACKAGE=$1;
+#	    last; #stop when found
+#            }
+#	if ($_=~/PACKAGE\((.*)\)/o){
+#            $PACKAGE=$1;
+#            last; #stop when found
+#            }
+#        }   
+#close FILE;
+
+
+# Give error if script is run without an argument
+#------------------------------------------------
+if (! $LANG){
+    print "update.pl:  missing file arguments\n";
+    print "Try `update.pl --help' for more information.\n";
+    exit;
+}
+
+# Use the supplied arguments
+#---------------------------
+if ($LANG=~/^-(.)*/){
+
+    if ("$LANG" eq "--version"   || "$LANG" eq "-V"){
+        &Version;
+    }
+    elsif ($LANG eq "--help"     || "$LANG" eq "-H"){
+	&Help;
+    }
+    elsif ($LANG eq "--dist"     || "$LANG" eq "-D"){
+        &Merging;
+    }
+    elsif ($LANG eq "--pot"      || "$LANG" eq "-P"){
+
+ 	# Check for .headerlock file, so the Makefile
+        # will not generate the header files twise 
+	#--------------------------------------------
+	if (-e ".headerlock"){
+   	&GeneratePot;
+	}else{
+        &GenHeaders;
+	&GeneratePot;}
+        exit;
+    }
+    elsif ($LANG eq "--headers"  || "$LANG" eq "-S"){
+        &GenHeaders;
+        exit;
+    }
+    elsif ($LANG eq "--maintain" || "$LANG" eq "-M"){
+        &Maintain;
+    }
+    else {
+        &InvalidOption;
+    }
+
+} else {
+   
+   # Run standard procedure
+   #-----------------------
+   if(-s "$LANG.po"){
+        &GenHeaders; 
+	&GeneratePot;
+	&Merging;
+	&Status;
+   }  
+
+   # Report error if the language file supplied
+   # to the command line is non-existent
+   #-------------------------------------------
+   else {
+	&NotExisting;       
+   }
+}
+
+sub Version{
+
+    # Print version information
+    #--------------------------
+    print "GNOME PO Updater $VERSION\n";
+    print "Written by Kenneth Christiansen <kenneth\@gnome.org>, 2000.\n\n";
+    print "Copyright (C) 2000 Free Software Foundation, Inc.\n";
+    print "This is free software; see the source for copying conditions.  There is NO\n";
+    print "warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n";
+    exit;
+}
+
+sub Help{
+
+    # Print usage information
+    #------------------------
+    print "Usage: ./update.pl [OPTIONS] ...LANGCODE\n";
+    print "Updates pot files and merge them with the translations.\n\n";
+    print "  -H, --help                   shows this help page\n";
+    print "  -P, --pot                    generate the pot file only\n";
+    print "  -S, --headers                generate the XML headerfiles in POTFILES.in\n";
+    print "  -M, --maintain               search for missing files in POTFILES.in\n";
+    print "  -V, --version                shows the version\n";
+    print "\nExamples of use:\n";
+    print "update.sh --pot    just creates a new pot file from the source\n";
+    print "update.sh da       created new pot file and updated the da.po file\n\n";
+    print "Report bugs to <kenneth\@gnome.org>.\n";
+    exit;
+}
+
+sub Maintain{
+   
+    # Search and fine, all translatable files
+    # ---------------------------------------
+    $i18nfiles="find ../ -print | egrep '.*\\.(c|y|cc|c++|h|gob)' ";
+
+    open(BUF2, "POTFILES.in") || die "update.pl:  there's no POTFILES.in!!!\n";
+    
+    print "Searching for missing _(\" \") entries...\n";
+    
+    open(BUF1, "$i18nfiles|");
+
+    @buf1_1 = <BUF1>;
+    @buf1_2 = <BUF2>;
+
+    # Check if we should ignore some found files, when 
+    # comparing with POTFILES.in
+    #-------------------------------------------------
+    if (-s ".potignore"){
+        open FILE, ".potignore";
+        while (<FILE>) {
+            if ($_=~/^[^#]/o){
+                push @bup, $_;
+            }
+        }
+        print "Found .potignore: Ignoring files...\n";
+        @buf1_2 = (@bup, @buf1_2);
+    }
+
+    foreach my $file (@buf1_1){
+        open FILE, "<$file";
+        while (<FILE>) {
+            if ($_=~/_\(\"/o){
+                $file = unpack("x3 A*",$file) . "\n";
+                push @buf2_1, $file;
+                last;
+            }
+        }
+    }
+
+    @buf3_1 = sort (@buf2_1);
+    @buf3_2 = sort (@buf1_2);
+
+    my %in2;
+    foreach (@buf3_2) {
+        $in2{$_} = 1;
+    }
+
+    foreach (@buf3_1){
+        if (!exists($in2{$_})){
+            push @result, $_ 
+        }
+    }
+
+    # Save file with information about the files missing
+    # if any, and give information about this proceedier
+    #---------------------------------------------------
+    if(@result){
+        open OUT, ">missing";
+        print OUT @result;
+        print "\nHere is the result:\n\n", @result, "\n";
+        print "The file \"missing\" has been placed in the current directory.\n";
+        print "Files supposed to be ignored should be placed in \".potignore\"\n";
+    }
+
+    # If there is nothing to complain about, notice the user
+    #-------------------------------------------------------
+    else{
+        print "\nWell, it's all perfect! Congratulation!\n";
+    }         
+}
+
+sub InvalidOption{
+
+    # Handle invalid arguments
+    #-------------------------
+    print "update.pl: invalid option -- $LANG\n";
+    print "Try `update.pl --help' for more information.\n";
+}
+ 
+sub GenHeaders{
+
+    # Generate the .h header files, so we can allow glade and
+    # xml translation support
+    #--------------------------------------------------------
+    if(-s "ui-extract.pl"){
+
+        print "Found ui-extract.pl script\nRunning ui-extract...\n";
+
+        open FILE, "<POTFILES.in";
+        while (<FILE>) {
+
+           # Find .xml files in POTFILES.in and generate the
+           # files with help from the ui-extract.pl script
+           #--------------------------------------------------
+           if ($_=~ /(.*)(\.xml)/o){
+              $filename = "../$1.xml";
+              $xmlfiles="perl \.\/ui-extract.pl --local $filename";
+              system($xmlfiles);
+           }
+      
+           # Find .glade files in POTFILES.in and generate
+           # the files with help from the ui-extract.pl script
+           #--------------------------------------------------
+           elsif ($_=~ /(.*)(\.glade)/o){
+              $filename = "../$1.glade";
+              $xmlfiles="perl \.\/ui-extract.pl --local $filename";
+              system($xmlfiles);  
+           }
+       }
+       close FILE;
+
+       # Create .headerlock file, so the script will know 
+       # that we already passed this section. This is required 
+       # since the individual sections can be reaced at different
+       # times by the Makefile
+       #--------------------------------------------------------- 
+       system("touch .headerlock");
+   }
+}
+
+sub GeneratePot{
+
+    # Generate the potfiles from the POTFILES.in file
+    #------------------------------------------------
+
+    print "Building the $PACKAGE.pot...\n";
+
+    system ("mv POTFILES.in POTFILES.in.old");    
+
+    open INFILE, "<POTFILES.in.old";
+    open OUTFILE, ">POTFILES.in";
+    while (<INFILE>) {
+	if ($_ =~ /\.(glade|xml)$/) {
+        s/\.glade$/\.glade\.h/;
+        s/\.xml$/\.xml\.h/;
+        $_ = basename($_);
+	$_ = "po/tmp/$_\n";
+        }
+        print OUTFILE $_;        
+    }
+    close OUTFILE;
+    close INFILE;
+
+    $GETTEXT ="xgettext --default-domain\=$PACKAGE --directory\=\.\."
+             ." --add-comments --keyword\=\_ --keyword\=N\_ --keyword\=P_\:1,2"
+             ." --files-from\=\.\/POTFILES\.in ";  
+    $GTEST   ="test \! -f $PACKAGE\.po \|\| \( rm -f \.\/$PACKAGE\.pot "
+             ."&& mv $PACKAGE\.po \.\/$PACKAGE\.pot \)";
+
+    system($GETTEXT);
+    system($GTEST);
+    print "Wrote $PACKAGE.pot\n";
+    system("mv POTFILES.in.old POTFILES.in");
+
+    # If .headerlock file is found, it means that the potfiles
+    # already has been generated. If so delete the generated 
+    # .h header files. The reason for this approach with a 
+    # file as a marker is due to that the Makefile runs the
+    # scripts in turns
+    #---------------------------------------------------------
+
+    if(-e ".headerlock"){
+        unlink(".headerlock");
+
+        print "Removing generated header (.h) files...";
+	system("rm ./tmp/ -rf");
+    }
+    print "done\n";
+}
+
+sub Merging{
+
+    if ($ARGV[1]){
+        $LANG   = $ARGV[1]; 
+    } else {
+	$LANG   = $ARGV[0];
+    }
+
+    if ($ARGV[0] ne "--dist" && $ARGV[0] ne "-D") {
+        print "Merging $LANG.po with $PACKAGE.pot...";
+    }
+
+    $MERGE="cp $LANG.po $LANG.po.old && msgmerge $LANG.po.old $PACKAGE.pot -o $LANG.po";
+
+    system($MERGE);
+    
+    if ($ARGV[0] ne "--dist" && $ARGV[0] ne "-D") {
+        print "\n\n";
+    }
+
+    # Remove the "messages" trash file generated
+    # by gettext, aswell as the backup file
+    #-------------------------------------------
+    unlink "messages";
+    unlink "$LANG.po.old";
+}
+
+sub NotExisting{
+
+    # Report error if supplied language 
+    # file is non-existant
+    #----------------------------------
+    print "update.pl:  sorry, $LANG.po does not exist!\n";
+    print "Try `update.pl --help' for more information.\n";    
+    exit;
+}
+
+sub Status{
+
+    # Print status information about the po file
+    #-------------------------------------------
+    $STATUS="msgfmt --statistics $LANG.po";
+    
+    system($STATUS);
+    print "\n";   
+}
Only in orig/nano-2.2.0/po: vi.gmo
Only in orig/nano-2.2.0/po: zh_CN.gmo
Only in orig/nano-2.2.0/po: zh_TW.gmo
Only in orig/nano-2.2.0/src: Makefile.in
Only in orig/nano-2.2.0/src: README
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/browser.c trunk/nano/src/browser.c
--- orig/nano-2.2.0/src/browser.c	2009-11-14 19:37:15.000000000 +0000
+++ trunk/nano/src/browser.c	2009-12-05 14:55:13.000000000 +0000
@@ -1,8 +1,8 @@
-/* $Id: browser.c 4414 2009-10-27 04:09:27Z astyanax $ */
+/* $Id: browser.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   browser.c                                                            *
  *                                                                        *
- *   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007               *
+ *   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009   *
  *   Free Software Foundation, Inc.                                       *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/chars.c trunk/nano/src/chars.c
--- orig/nano-2.2.0/src/chars.c	2009-11-29 06:12:39.000000000 +0000
+++ trunk/nano/src/chars.c	2009-12-05 14:55:12.000000000 +0000
@@ -1,8 +1,8 @@
-/* $Id: chars.c 4448 2009-11-29 06:13:22Z astyanax $ */
+/* $Id: chars.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   chars.c                                                              *
  *                                                                        *
- *   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007               *
+ *   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009   *
  *   Free Software Foundation, Inc.                                       *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
@@ -79,6 +79,16 @@
     return ((unsigned int)c == (unsigned char)c);
 }
 
+static void mbtowc_reset(void)
+{
+    IGNORE_CALL_RESULT(mbtowc(NULL, NULL, 0));
+}
+
+static void wctomb_reset(void)
+{
+    IGNORE_CALL_RESULT(wctomb(NULL, 0));
+}
+
 /* This function is equivalent to isalnum() for multibyte characters. */
 bool is_alnum_mbchar(const char *c)
 {
@@ -89,7 +99,7 @@
 	wchar_t wc;
 
 	if (mbtowc(&wc, c, MB_CUR_MAX) < 0) {
-	    int shutup = mbtowc(NULL, NULL, 0);
+	    mbtowc_reset();
 	    wc = bad_wchar;
 	}
 
@@ -109,7 +119,7 @@
 	wchar_t wc;
 
 	if (mbtowc(&wc, c, MB_CUR_MAX) < 0) {
-	    int shutup = mbtowc(NULL, NULL, 0);
+	    mbtowc_reset();
 	    wc = bad_wchar;
 	}
 
@@ -156,7 +166,7 @@
 	wchar_t wc;
 
 	if (mbtowc(&wc, c, MB_CUR_MAX) < 0) {
-	    int shutup = mbtowc(NULL, NULL, 0);
+	    mbtowc_reset();
 	    wc = bad_wchar;
 	}
 
@@ -177,7 +187,7 @@
 	int c_mb_len = mbtowc(&wc, c, MB_CUR_MAX);
 
 	if (c_mb_len < 0) {
-	    int shutup = mbtowc(NULL, NULL, 0);
+	    mbtowc_reset();
 	    wc = bad_wchar;
 	}
 
@@ -243,14 +253,14 @@
 	wchar_t wc;
 
 	if (mbtowc(&wc, c, MB_CUR_MAX) < 0) {
-	    int shutup = mbtowc(NULL, NULL, 0);
+	    mbtowc_reset();
 	    *crep_len = bad_mbchar_len;
 	    strncpy(crep, bad_mbchar, *crep_len);
 	} else {
 	    *crep_len = wctomb(crep, control_wrep(wc));
 
 	    if (*crep_len < 0) {
-		int shutup = wctomb(NULL, 0);
+		wctomb_reset();
 		*crep_len = 0;
 	    }
 	}
@@ -278,14 +288,14 @@
 
 	/* Reject invalid Unicode characters. */
 	if (mbtowc(&wc, c, MB_CUR_MAX) < 0 || !is_valid_unicode(wc)) {
-	    int shutup = mbtowc(NULL, NULL, 0);
+	    mbtowc_reset();
 	    *crep_len = bad_mbchar_len;
 	    strncpy(crep, bad_mbchar, *crep_len);
 	} else {
 	    *crep_len = wctomb(crep, wc);
 
 	    if (*crep_len < 0) {
-		int shutup = wctomb(NULL, 0);
+		wctomb_reset();
 		*crep_len = 0;
 	    }
 	}
@@ -311,7 +321,7 @@
 	int width;
 
 	if (mbtowc(&wc, c, MB_CUR_MAX) < 0) {
-	    int shutup = mbtowc(NULL, NULL, 0);
+	    mbtowc_reset();
 	    wc = bad_wchar;
 	}
 
@@ -356,7 +366,7 @@
 
 	/* Reject invalid Unicode characters. */
 	if (*chr_mb_len < 0 || !is_valid_unicode((wchar_t)chr)) {
-	    int shutup = wctomb(NULL, 0);
+	    wctomb_reset();
 	    *chr_mb_len = 0;
 	}
     } else {
@@ -388,7 +398,7 @@
 	/* If buf contains an invalid multibyte character, only
 	 * interpret buf's first byte. */
 	if (buf_mb_len < 0) {
-	    int shutup = mblen(NULL, 0);
+	    IGNORE_CALL_RESULT(mblen(NULL, 0));
 	    buf_mb_len = 1;
 	} else if (buf_mb_len == 0)
 	    buf_mb_len++;
@@ -545,7 +555,7 @@
 	    s1_mb_len = parse_mbchar(s1, s1_mb, NULL);
 
 	    if (mbtowc(&ws1, s1_mb, s1_mb_len) < 0) {
-		int shutup = mbtowc(NULL, NULL, 0);
+		mbtowc_reset();
 		ws1 = (unsigned char)*s1_mb;
 		bad_s1_mb = TRUE;
 	    }
@@ -553,7 +563,7 @@
 	    s2_mb_len = parse_mbchar(s2, s2_mb, NULL);
 
 	    if (mbtowc(&ws2, s2_mb, s2_mb_len) < 0) {
-		int shutup = mbtowc(NULL, NULL, 0);
+		mbtowc_reset();
 		ws2 = (unsigned char)*s2_mb;
 		bad_s2_mb = TRUE;
 	    }
@@ -781,7 +791,7 @@
 	int c_mb_len = mbtowc(&wc, c, MB_CUR_MAX);
 
 	if (c_mb_len < 0) {
-	    int shutup = mbtowc(NULL, NULL, 0);
+	    mbtowc_reset();
 	    wc = (unsigned char)*c;
 	    bad_c_mb = TRUE;
 	}
@@ -790,7 +800,7 @@
 	    int s_mb_len = parse_mbchar(s, s_mb, NULL);
 
 	    if (mbtowc(&ws, s_mb, s_mb_len) < 0) {
-		int shutup = mbtowc(NULL, NULL, 0);
+		mbtowc_reset();
 		ws = (unsigned char)*s;
 		bad_s_mb = TRUE;
 	    }
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/color.c trunk/nano/src/color.c
--- orig/nano-2.2.0/src/color.c	2009-08-14 03:16:32.000000000 +0000
+++ trunk/nano/src/color.c	2009-12-05 14:55:12.000000000 +0000
@@ -1,8 +1,8 @@
-/* $Id: color.c 4379 2009-02-16 23:06:09Z astyanax $ */
+/* $Id: color.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   color.c                                                              *
  *                                                                        *
- *   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007               *
+ *   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009   *
  *   Free Software Foundation, Inc.                                       *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/cut.c trunk/nano/src/cut.c
--- orig/nano-2.2.0/src/cut.c	2009-08-14 03:16:32.000000000 +0000
+++ trunk/nano/src/cut.c	2009-12-05 14:55:13.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: cut.c 4379 2009-02-16 23:06:09Z astyanax $ */
+/* $Id: cut.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   cut.c                                                                *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/files.c trunk/nano/src/files.c
--- orig/nano-2.2.0/src/files.c	2009-11-29 06:12:39.000000000 +0000
+++ trunk/nano/src/files.c	2009-12-05 14:55:12.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: files.c 4448 2009-11-29 06:13:22Z astyanax $ */
+/* $Id: files.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   files.c                                                              *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
@@ -1092,7 +1092,6 @@
     char *d_here, *d_there, *d_there_file = NULL;
     const char *last_slash;
     bool path_only;
-    int shutup;
 
     if (origpath == NULL)
     	return NULL;
@@ -1191,7 +1190,7 @@
 	    /* Finally, go back to the path specified in d_here,
 	     * where we were before.  We don't check for a chdir()
 	     * error, since we can do nothing if we get one. */
-	    shutup = chdir(d_here);
+	    IGNORE_CALL_RESULT(chdir(d_here));
 
 	    /* Free d_here, since we're done using it. */
 	    free(d_here);
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/global.c trunk/nano/src/global.c
--- orig/nano-2.2.0/src/global.c	2009-11-29 06:23:27.000000000 +0000
+++ trunk/nano/src/global.c	2009-12-05 14:55:12.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: global.c 4449 2009-11-29 06:24:10Z astyanax $ */
+/* $Id: global.c 4458 2009-12-04 04:29:55Z astyanax $ */
 /**************************************************************************
  *   global.c                                                             *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
@@ -655,8 +655,9 @@
         free(f);
     }
 
-    add_to_funcs(DO_HELP_VOID, MALL, get_help_msg, IFSCHELP(nano_help_msg),
-	FALSE, VIEW);
+    add_to_funcs(DO_HELP_VOID,
+	(MMAIN|MWHEREIS|MREPLACE|MREPLACE2|MGOTOLINE|MWRITEFILE|MINSERTFILE|MEXTCMD|MSPELL|MBROWSER|MWHEREISFILE|MGOTODIR),
+	get_help_msg, IFSCHELP(nano_help_msg), FALSE, VIEW);
 
     add_to_funcs( CANCEL_MSG,
 	(MWHEREIS|MREPLACE|MREPLACE2|MGOTOLINE|MWRITEFILE|MINSERTFILE|MEXTCMD|MSPELL|MWHEREISFILE|MGOTODIR|MYESNO),
@@ -669,8 +670,6 @@
 #endif
 	exit_msg, IFSCHELP(nano_exit_msg), FALSE, VIEW);
 
-    add_to_funcs(DO_EXIT, MHELP, exit_msg, IFSCHELP(nano_exit_msg), FALSE, VIEW);
-
 #ifndef DISABLE_BROWSER
     add_to_funcs(DO_EXIT, MBROWSER, exit_msg, IFSCHELP(nano_exitbrowser_msg), FALSE, VIEW);
 #endif
@@ -739,11 +738,11 @@
 #endif
 
     add_to_funcs(DO_FIRST_LINE,
-	(MMAIN|MWHEREIS|MREPLACE|MREPLACE2|MGOTOLINE|MHELP),
+	(MMAIN|MWHEREIS|MREPLACE|MREPLACE2|MGOTOLINE),
 	first_line_msg, IFSCHELP(nano_firstline_msg), FALSE, VIEW);
 
     add_to_funcs(DO_LAST_LINE,
-	(MMAIN|MWHEREIS|MREPLACE|MREPLACE2|MGOTOLINE|MHELP),
+	(MMAIN|MWHEREIS|MREPLACE|MREPLACE2|MGOTOLINE),
 	last_line_msg, IFSCHELP(nano_lastline_msg), TRUE, VIEW);
 
 
@@ -1001,6 +1000,10 @@
 #ifndef DISABLE_HELP
     add_to_funcs( REFRESH_MSG, MHELP,
 	refresh_msg, nano_refresh_msg, FALSE, VIEW);
+
+    add_to_funcs(DO_EXIT, MHELP, exit_msg, IFSCHELP(nano_exit_msg), FALSE, VIEW);
+
+
 #endif
 
 #ifndef DISABLE_BROWSER
@@ -1019,8 +1022,10 @@
 
     currmenu = MMAIN;
 
-    add_to_sclist(MALL, "^G", DO_HELP_VOID, 0, TRUE);
-    add_to_sclist(MALL, "F1", DO_HELP_VOID, 0, TRUE);
+    add_to_sclist(MMAIN|MWHEREIS|MREPLACE|MREPLACE2|MGOTOLINE|MWRITEFILE|MINSERTFILE|MEXTCMD|MSPELL|MBROWSER|MWHEREISFILE|MGOTODIR,
+	"^G", DO_HELP_VOID, 0, TRUE);
+    add_to_sclist(MMAIN|MWHEREIS|MREPLACE|MREPLACE2|MGOTOLINE|MWRITEFILE|MINSERTFILE|MEXTCMD|MSPELL|MBROWSER|MWHEREISFILE|MGOTODIR,
+	"F1", DO_HELP_VOID, 0, TRUE);
     add_to_sclist(MMAIN|MHELP|MBROWSER, "^X", DO_EXIT, 0, TRUE);
     add_to_sclist(MMAIN|MHELP|MBROWSER, "F2", DO_EXIT, 0, TRUE);
     add_to_sclist(MMAIN, "^_", DO_GOTOLINECOLUMN_VOID, 0, TRUE);
@@ -1084,10 +1089,10 @@
     add_to_sclist(MALL, "kleft", DO_LEFT, 0, TRUE);
     add_to_sclist(MMAIN, "^Q", XON_COMPLAINT, 0, TRUE);
     add_to_sclist(MMAIN, "^S", XOFF_COMPLAINT, 0, TRUE);
-    add_to_sclist(MMAIN|MBROWSER, "^P", DO_UP_VOID, 0, TRUE);
-    add_to_sclist(MMAIN|MBROWSER, "kup", DO_UP_VOID, 0, TRUE);
-    add_to_sclist(MMAIN|MBROWSER, "^N", DO_DOWN_VOID, 0, TRUE);
-    add_to_sclist(MMAIN|MBROWSER, "kdown", DO_DOWN_VOID, 0, TRUE);
+    add_to_sclist(MMAIN|MHELP|MBROWSER, "^P", DO_UP_VOID, 0, TRUE);
+    add_to_sclist(MMAIN|MHELP|MBROWSER, "kup", DO_UP_VOID, 0, TRUE);
+    add_to_sclist(MMAIN|MHELP|MBROWSER, "^N", DO_DOWN_VOID, 0, TRUE);
+    add_to_sclist(MMAIN|MHELP|MBROWSER, "kdown", DO_DOWN_VOID, 0, TRUE);
     add_to_sclist(MALL, "^A", DO_HOME, 0, TRUE);
     add_to_sclist(MALL, "khome", DO_HOME, 0, TRUE);
     add_to_sclist(MALL, "^E", DO_END, 0, TRUE);
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/help.c trunk/nano/src/help.c
--- orig/nano-2.2.0/src/help.c	2009-08-14 03:16:32.000000000 +0000
+++ trunk/nano/src/help.c	2009-12-05 14:55:13.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: help.c 4349 2009-01-19 19:10:39Z astyanax $ */
+/* $Id: help.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   help.c                                                               *
  *                                                                        *
- *   Copyright (C) 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007         *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,  *
+ *   2009 Free Software Foundation, Inc.                                  *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/move.c trunk/nano/src/move.c
--- orig/nano-2.2.0/src/move.c	2009-11-27 03:04:18.000000000 +0000
+++ trunk/nano/src/move.c	2009-12-05 14:55:12.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: move.c 4444 2009-11-27 03:04:59Z astyanax $ */
+/* $Id: move.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   move.c                                                               *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/nano.c trunk/nano/src/nano.c
--- orig/nano-2.2.0/src/nano.c	2009-11-29 06:23:27.000000000 +0000
+++ trunk/nano/src/nano.c	2009-12-05 14:55:13.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: nano.c 4449 2009-11-29 06:24:10Z astyanax $ */ 
+/* $Id: nano.c 4453 2009-12-02 03:36:22Z astyanax $ */ 
 /**************************************************************************
  *   nano.c                                                               *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
@@ -936,8 +936,8 @@
 {
     printf(_(" GNU nano version %s (compiled %s, %s)\n"), VERSION,
 	__TIME__, __DATE__);
-    printf(" (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007\n");
-    printf(" Free Software Foundation, Inc.\n");
+    printf(" (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,\n");
+    printf(" 2008, 2009 Free Software Foundation, Inc.\n");
     printf(
 	_(" Email: nano@nano-editor.org	Web: http://www.nano-editor.org/"));
     printf(_("\n Compiled options:"));
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/nano.h trunk/nano/src/nano.h
--- orig/nano-2.2.0/src/nano.h	2009-11-14 19:37:35.000000000 +0000
+++ trunk/nano/src/nano.h	2009-12-05 14:55:12.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: nano.h 4417 2009-11-07 16:56:17Z astyanax $ */
+/* $Id: nano.h 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   nano.h                                                               *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
@@ -54,6 +54,9 @@
 #include <stdarg.h>
 #endif
 
+/* Suppress warnings for __attribute__((warn_unused_result)) */
+#define IGNORE_CALL_RESULT(call) do { if (call) {} } while(0)
+
 /* Macros for flags. */
 #define FLAGOFF(flag) ((flag) / (sizeof(unsigned) * 8))
 #define FLAGMASK(flag) (1 << ((flag) % (sizeof(unsigned) * 8)))
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/prompt.c trunk/nano/src/prompt.c
--- orig/nano-2.2.0/src/prompt.c	2009-11-29 06:12:39.000000000 +0000
+++ trunk/nano/src/prompt.c	2009-12-05 14:55:13.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: prompt.c 4448 2009-11-29 06:13:22Z astyanax $ */
+/* $Id: prompt.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   prompt.c                                                             *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/proto.h trunk/nano/src/proto.h
--- orig/nano-2.2.0/src/proto.h	2009-11-29 06:12:39.000000000 +0000
+++ trunk/nano/src/proto.h	2009-12-05 14:55:12.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: proto.h 4448 2009-11-29 06:13:22Z astyanax $ */
+/* $Id: proto.h 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   proto.h                                                              *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/rcfile.c trunk/nano/src/rcfile.c
--- orig/nano-2.2.0/src/rcfile.c	2009-11-27 05:09:15.000000000 +0000
+++ trunk/nano/src/rcfile.c	2009-12-05 14:55:12.000000000 +0000
@@ -1,8 +1,8 @@
-/* $Id: rcfile.c 4445 2009-11-27 05:09:56Z astyanax $ */
+/* $Id: rcfile.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   rcfile.c                                                             *
  *                                                                        *
- *   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007               *
+ *   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009   *
  *   Free Software Foundation, Inc.                                       *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/search.c trunk/nano/src/search.c
--- orig/nano-2.2.0/src/search.c	2009-08-14 03:16:32.000000000 +0000
+++ trunk/nano/src/search.c	2009-12-05 14:55:12.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: search.c 4380 2009-02-17 02:01:03Z astyanax $ */
+/* $Id: search.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   search.c                                                             *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/text.c trunk/nano/src/text.c
--- orig/nano-2.2.0/src/text.c	2009-11-29 06:12:39.000000000 +0000
+++ trunk/nano/src/text.c	2009-12-05 14:55:13.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: text.c 4448 2009-11-29 06:13:22Z astyanax $ */ 
+/* $Id: text.c 4455 2009-12-03 03:12:00Z astyanax $ */ 
 /**************************************************************************
  *   text.c                                                               *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
@@ -481,6 +481,7 @@
 	if (u->xflags == UNDO_DEL_BACKSPACE)
 	    openfile->current_x += strlen(u->strdata);
 	break;
+#ifndef DISABLE_WRAPPING
     case SPLIT:
 	undidmsg = _("line wrap");
 	f->data = (char *) nrealloc(f->data, strlen(f->data) + strlen(u->strdata) + 1);
@@ -494,6 +495,7 @@
 	}
 	renumber(f);
 	break;
+#endif /* DISABLE_WRAPPING */
     case UNSPLIT:
 	undidmsg = _("line join");
 	t = make_new_node(f);
@@ -618,6 +620,7 @@
 	do_gotolinecolumn(u->lineno, u->begin+1, FALSE, FALSE, FALSE, FALSE);
 	do_enter(TRUE);
 	break;
+#ifndef DISABLE_WRAPPING
     case SPLIT:
 	undidmsg = _("line wrap");
 	if (u->xflags & UNDO_SPLIT_MADENEW)
@@ -625,6 +628,7 @@
         do_wrap(f, TRUE);
 	renumber(f);
 	break;
+#endif /* DISABLE_WRAPPING */
     case UNSPLIT:
 	undidmsg = _("line join");
 	len = strlen(f->data) + strlen(u->strdata + 1);
@@ -900,6 +904,7 @@
 	    u->strdata = data;
 	}
 	break;
+#ifndef DISABLE_WRAPPING
     case SPLIT:
 	wrap_loc = break_line(openfile->current->data, fill
 #ifndef DISABLE_HELP
@@ -913,6 +918,7 @@
 	    u->strdata2 = mallocstrcpy(NULL, fs->current->next->data);
 	u->begin = wrap_loc;
 	break;
+#endif /* DISABLE_WRAPPING */
     case INSERT:
     case REPLACE:
 	data = mallocstrcpy(NULL, fs->current->data);
@@ -1058,11 +1064,13 @@
     case INSERT:
 	u->mark_begin_lineno = openfile->current->lineno;
 	break;
+#ifndef DISABLE_WRAPPING
     case SPLIT:
 	/* This will only be called if we made a completely new line,
 	   and as such we should note that so we can destroy it later */
 	u->xflags = UNDO_SPLIT_MADENEW;
 	break;
+#endif /* DISABLE_WRAPPING */
     case UNSPLIT:
 	/* These cases are handled by the earlier check for a new line and action */
     case ENTER:
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/utils.c trunk/nano/src/utils.c
--- orig/nano-2.2.0/src/utils.c	2009-11-26 18:19:56.000000000 +0000
+++ trunk/nano/src/utils.c	2009-12-05 14:55:12.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: utils.c 4372 2009-02-08 17:45:21Z astyanax $ */
+/* $Id: utils.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   utils.c                                                              *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
diff --unidirectional-new-file -rux .svn orig/nano-2.2.0/src/winio.c trunk/nano/src/winio.c
--- orig/nano-2.2.0/src/winio.c	2009-11-29 06:12:39.000000000 +0000
+++ trunk/nano/src/winio.c	2009-12-05 14:55:13.000000000 +0000
@@ -1,9 +1,9 @@
-/* $Id: winio.c 4448 2009-11-29 06:13:22Z astyanax $ */
+/* $Id: winio.c 4453 2009-12-02 03:36:22Z astyanax $ */
 /**************************************************************************
  *   winio.c                                                              *
  *                                                                        *
- *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007   *
- *   Free Software Foundation, Inc.                                       *
+ *   Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,  *
+ *   2008, 2009 Free Software Foundation, Inc.                            *
  *   This program is free software; you can redistribute it and/or modify *
  *   it under the terms of the GNU General Public License as published by *
  *   the Free Software Foundation; either version 3, or (at your option)  *
