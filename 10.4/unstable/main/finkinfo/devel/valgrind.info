Info2: <<
Package: valgrind%type_pkg[-64bit]
Version: 3.5.0
Revision: 0.10167.1
Type: -64bit (boolean)
Description: Debugging and profiling tool
DescDetail: <<
	Valgrind is an award-winning instrumentation framework for building
	dynamic analysis tools. There are Valgrind tools that can automatically
	detect many memory management and threading bugs, and profile your
	programs in detail. You can also use Valgrind to build new tools.

	The Valgrind distribution currently includes six production-quality
	tools: a memory error detector, two thread error detectors, a cache and
	branch-prediction profiler, a call-graph generating cache profiler, and
	a heap profiler. It also includes one experimental tool, which detects
	out of bounds reads and writes of stack, global and heap arrays.
<<
DescUsage: <<
	For Architecture i386, valgrind is 32-bit only, and valgrind-64bit is both
	32 and 64-bit. On Architecture x86_64, valgrind is always both 32 and 64.
<<
DescPackaging: <<
	Based on revision 10167 from svn://svn.valgrind.org/valgrind/trunk
	This is an experimental version and not all features are working on OS X yet.
	
	Patched configure.in because it forgets to define VGCONF_ARCH_SEC on x86_64.
<<
Architecture: ( %type_raw[-64bit] = -64bit ) i386, ( %type_raw[-64bit] = . ) i386, ( %type_raw[-64bit] = . ) x86_64
Distribution: 10.5
Source: http://homepage.mac.com/danielj7/%{ni}-%v.10167.tar.bz2
Source-MD5: f2965de1860ab2c9fe03860ecf938b5b
SourceDirectory: %{ni}
Depends: ( %type_raw[-64bit] = -64bit ) 64bit-cpu
BuildDepends: sed, autoconf, automake1.11, fink (>= 0.28)
Conflicts: valgrind, valgrind-64bit
Replaces: valgrind, valgrind-64bit
PatchFile: %{ni}.patch
PatchFile-MD5: 3aadc002853b8d52457a7f92f4cc1786
ConfigureParams: --disable-dependency-tracking ( %type_raw[-64bit] = -64bit ) --build=amd64-darwin ( %m = x86_64 ) --build=amd64-darwin
CompileScript: <<
	#!/bin/bash -ev
	# We have to avoid fink's compiler_wrapper on x86_64 or we get build errors
	# since we have to build both 32 and 64 bit code.
	export PATH="%p/bin:%p/sbin:/usr/bin:/usr/sbin:/bin:/sbin"
	./autogen.sh
	%{default_script}
<<
InstallScript: make install DESTDIR=%d
# This is necessary to avoid validation errors, but it throws warnings instead.
Shlibs: <<
	!libmpiwrap-x86-darwin.so
	!vgpreload_core-x86-darwin.so
	!vgpreload_drd-x86-darwin.so
	!vgpreload_exp-ptrcheck-x86-darwin.so
	!vgpreload_helgrind-x86-darwin.so
	!vgpreload_massif-x86-darwin.so
	!vgpreload_memcheck-x86-darwin.so
	( %type_raw[-64bit] = -64bit ) !libmpiwrap-amd64-darwin.so
	( %type_raw[-64bit] = -64bit ) !vgpreload_core-amd64-darwin.so
	( %type_raw[-64bit] = -64bit ) !vgpreload_drd-amd64-darwin.so
	( %type_raw[-64bit] = -64bit ) !vgpreload_exp-ptrcheck-amd64-darwin.so
	( %type_raw[-64bit] = -64bit ) !vgpreload_helgrind-amd64-darwin.so
	( %type_raw[-64bit] = -64bit ) !vgpreload_massif-amd64-darwin.so
	( %type_raw[-64bit] = -64bit ) !vgpreload_memcheck-amd64-darwin.so
	( %m = x86_64 ) !libmpiwrap-amd64-darwin.so
	( %m = x86_64 ) !vgpreload_core-amd64-darwin.so
	( %m = x86_64 ) !vgpreload_drd-amd64-darwin.so
	( %m = x86_64 ) !vgpreload_exp-ptrcheck-amd64-darwin.so
	( %m = x86_64 ) !vgpreload_helgrind-amd64-darwin.so
	( %m = x86_64 ) !vgpreload_massif-amd64-darwin.so
	( %m = x86_64 ) !vgpreload_memcheck-amd64-darwin.so
<<
DocFiles: ACKNOWLEDGEMENTS AUTHORS COPYING* NEWS README*
License: GPL
Maintainer: Daniel Johnson <daniel@daniel-johnson.org>
Homepage: http://valgrind.org/

Splitoff: <<
	Package: %N-dev
	
	Depends: %N (= %v-%r)
	BuildDependsOnly: true
	Conflicts: valgrind-dev, valgrind-64bit-dev
	Replaces: valgrind-dev, valgrind-64bit-dev, %N (<< 3.5.0-0.9511.2)
	
	Files: include lib/pkgconfig lib/valgrind/*.a
	
	DocFiles: ACKNOWLEDGEMENTS AUTHORS COPYING* NEWS README*
<<
<<
