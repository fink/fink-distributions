Package: fpprofiler
Version: 20110108
Revision: 1
Description: Profiler for the FreePascal compiler
Architecture: powerpc, i386, x86_64
Source: http://michael-ep3.physik.uni-halle.de/%n-%v.tar.bz2
Source-MD5: f798933eecda64a4a7cb9e284c862e52
Depends: fpc
Recommends: graphviz
License: GPL

PatchScript: <<
#!/bin/sh -ev
  sed -i.bak 's|FPCallGraph;|FPCallGraph; {$mode objfpc}{$H+}|g' fppview/fpcallgraph.pas
  sed -i.bak 's|{$R \*\.res}||g' fpp/fppremove.pp
  cd fcl-passrc/src/
  patch pscanner.pp ../../patch/pscanner.diff
<<

CompileScript: <<
#!/bin/sh -ev
  cd fcl-passrc
  make
  cd ../fpp
  fpc -Fu../fpprof -Fu../fcl-passrc/units/* fpp.pp
  fpc -Fu../fpprof -Fu../fcl-passrc/units/* fppinsert.pp
  fpc -Fu../fpprof -Fu../fcl-passrc/units/* fppremove.pp
  cd ../fppview
  fpc -Fu../fpprof -Fu../fcl-passrc/units/* fppview.pp
  cd ../fpprof
  fpc fpprof.pp
<<

InstallScript: <<
#!/bin/sh -ev
  mkdir -p %i/bin
  install -m 755 fpp/fpp %i/bin/fpp
  install -m 755 fpp/fpp %i/bin/fppinsert
  install -m 755 fpp/fpp %i/bin/fppremove
  install -m 755 fppview/fppview %i/bin/fppview
  mkdir -p %i/lib/fpc/2.4.2/units/i386-darwin/fpprof
  install -m 644 fpprof/*.o    %i/lib/fpc/2.4.2/units/i386-darwin/fpprof/
  install -m 644 fpprof/*.ppu  %i/lib/fpc/2.4.2/units/i386-darwin/fpprof/
<<

DocFiles: docs/COPYING.GPL docs/develop.txt

DescDetail: <<
Compile your program by using fpp as a replacement of fpc. 
This creates a profile file (Default: fpprof.xml), 
from which output can created with fppview including output in the dot 
language, which can be converted to a graph with the program "dot" from the 
package "graphviz".

More details about options can be obtained with
  fpp -h
and
  fppview -h

Usage Example:

  fpp MyProgram.pp
  fppview --format=graphviz  --stat=callgraph >MyProgram.dot
  dot -Tpng MyProgram.dot -o MyProgram.png
  open MyProgram.png

Please check also the home page (http://wiki.lazarus.freepascal.org/FPProfiler)
<<

Homepage: http://wiki.lazarus.freepascal.org/FPProfiler
Maintainer: Karl-Michael Schindler <karl-michael.schindler@web.de>
