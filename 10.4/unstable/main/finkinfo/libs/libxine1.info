Package: libxine1
Version: 1.1.2
Revision: 1022
Description: Xine video/media player library
License: GPL
Maintainer: Justin F. Hallett <thesin@users.sourceforge.net>

Depends: %N-shlibs (= %v-%r)
BuildDepends: fink (>= 0.24-1), aalib, arts-dev (>= 1.4.0-2041), audiofile, bzip2-shlibs, esound, flac (>= 1.1.1-1011), freetype219, gconf2-dev, gettext-bin, gettext-tools, glib2-dev (>= 2.8.6-123), gnome-vfs2-ssl-dev | gnome-vfs2-dev, imagemagick-dev (>= 6.1.8-1002) | imagemagick10-dev (>= 6.1.8-1002), lcms, libbonobo2-dev, libcaca-dev, libcdio-dev, libgettext3-dev, libiconv-dev, libiso9660-dev, libjpeg, libmng2, libncurses5 (>= 5.4-20041023-1006), libogg, libpng3, libtheora0, libtiff, libtool14, libvcd-dev (>= 0.7.21-10), libvorbis0, libxml2, orbit2-dev, pkgconfig, popt, pth, qt3 (>= 3.3.6-1027), sdl (>= 1.2.9-1001), slang, speex3, x11-dev, libhowl-dev
Provides: libxine
Conflicts: libxine, libxine-docs
Replaces: libxine, libxine-shlibs, libxine-docs
Recommends: libdvdcss-shlibs
BuildDependsOnly: true

Source: mirror:sourceforge:xine/xine-lib-%v.tar.bz2
Source-MD5: c4dd262c47caae6f428eb902ac8ec0e8
Patch: %n.patch
PatchScript: <<
	perl -pi -e 's,-faltivec,-faltivec -maltivec,g' configure
	perl -pi -e 's,libX11.so,libX11.dylib,g; s,libXv.so,libXv.dylib,g;' configure
	perl -pi -e 's/-avoid-version/-Wl,-read_only_relocs,warning/g;' src/libffmpeg/Makefile.in src/post/deinterlace/Makefile.in src/post/planar/Makefile.in
	find . -name \*.c -o -name \*.h | xargs grep balign | cut -d: -f1 | sort -u | xargs perl -pi -e 's,.balign 16,.align 4,g; s,.balign 8,.align 3,g;'
	# -O3 considered harmful on OSX  :P
	perl -pi -e 's,-O3,-Os,g' configure
#	perl -pi -e 's|(OPENGL_LIBS=).*|$1"-lGL -dylib_file /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib"|g' configure
<<

SetCPPFLAGS: -fno-common -I%p/lib/freetype219/include/freetype2 -I%p/lib/freetype219/include -I/usr/X11R6/include -I%p/include
SetLDFLAGS: -L%p/lib/freetype219/lib -Wl,-dylib_file,/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib
SetLIBS: -L%p/lib
SetMAKEFLAGS: -j1
NoSetCPPFLAGS: true
NoSetLDFLAGS: true
NoSetMAKEFLAGS: true
ConfigureParams: --enable-fpic --with-pic --enable-static --enable-shared --disable-alsa --disable-alsatest --disable-dxr3 --enable-macosx-video --enable-coreaudio --disable-fb --disable-directfb --disable-vis --disable-mlib --libexecdir=%p/lib/libxine --mandir=%p/share/man --disable-sdltest (%m = powerpc) --enable-altivec (%m = i386) --disable-altivec --disable-w32dll --disable-dependency-tracking 
CompileScript: <<
#!/bin/sh -ev

	export PATH="%p/lib/freetype219/bin:$PATH"
	export PKG_CONFIG_PATH="%p/lib/freetype219/lib/pkgconfig:$PKG_CONFIG_PATH"
	if [ "%m" = "i386" ]; then
		export CPPFLAGS="$CPPFLAGS -UHAVE_MMX -UHAVE_MMX2"
	fi
	./configure %c

	if [ "%m" = "i386" ]; then
		echo "#define  HAVE_DARWIN_CDROM 1" >> config.h
	fi

	make
<<

InstallScript: 	make install DESTDIR=%d
DocFiles: AUTHORS COPYING CREDITS ChangeLog INSTALL NEWS README TODO
SplitOff: <<
	Package: %N-shlibs
	Depends: aalib-shlibs, arts-shlibs (>= 1.4.0-2041), audiofile-shlibs, bzip2-shlibs, esound-shlibs, flac-shlibs (>= 1.1.1-1011), freetype219-shlibs, gconf2-shlibs, glib2-shlibs (>= 2.8.6-123), gnome-vfs2-ssl-shlibs | gnome-vfs2-shlibs, imagemagick-shlibs (>= 6.1.8-1002), lcms-shlibs, libbonobo2-shlibs, libcdio7-shlibs (>= 0.77-12), libgettext3-shlibs, libiconv, libiso96605-shlibs, libjpeg-shlibs, libmng2-shlibs, libncurses5-shlibs (>= 5.4-20041023-1006), libogg-shlibs, libpng3-shlibs, libtheora0-shlibs, libtiff-shlibs, libtool14-shlibs, libvcd0-shlibs (>= 0.7.21-10), libvorbis0-shlibs, libxml2-shlibs, orbit2-shlibs, popt-shlibs, qt3-shlibs (>= 3.3.6-1027), sdl-shlibs (>= 1.2.9-1001), slang-shlibs, speex3-shlibs, x11-shlibs
	Provides: libxine-shlibs
	Conflicts: libxine-shlibs
	Replaces: libxine-shlibs, libxine
	DocFiles: AUTHORS COPYING ChangeLog INSTALL NEWS README
	Files: <<
		lib/libxine.*.dylib
		lib/libxineMacOSXVideo.*.dylib
		lib/xine
		share/xine
	<<
	Shlibs: <<
		%p/lib/libxine.1.dylib 16.0.0 %n (>= 1.0.1-1)
		%p/lib/libxineMacOSXVideo.1.dylib 16.0.0 %n (>= 1.0.1-1)
	<<
<<

Homepage: http://xine.sourceforge.net/
DescDetail: <<
	Libxine provides the complete infrastructure for a video/media player.
	It supports MPEG 1/2 and some AVI and Quicktime videos out of the box,
	so you can use it to play DVDs, (S)VCDs and most video files out there.
	It supports network streams, subtitles and even mp3 files. It's extensible
	to your heart's content via plugins for audio_out, video_out, input media,
	demuxers (stream types), audio/video and subtitle codecs.
	Building a GUI (or text based) frontend around this should be quite easy.
	The xine-ui package provides one for your convenience, so you can just
	start watching your VCDs ;-)
<<

