Package: evince

# cannot upgrade until we get working libspectre
Version: 2.20.2

Revision: 8
Description: GNOME document viewer
License: GPL
Maintainer: None <fink-devel@lists.sourceforge.net>
Depends: <<
	atk1-shlibs (>= 1.24.0-1),
	audiofile-shlibs,
	cairo-shlibs (>= 1.8-1),
	dbus (>= 1.2.1-1),
	esound-shlibs (>= 0.2.38-1),
	expat1-shlibs,
	fontconfig2-shlibs (>= 2.4.1-1),
	freetype219-shlibs (>= 2.3.7-7),
	gconf2 (>= 2.24.0-1),
	glib2-shlibs (>= 2.18.0-1),
	glitz-shlibs,
	ghostscript (>= 8.61-1) | system-ghostscript8,
	gnome-keyring-shlibs (>= 0.8.1-1),
	gnome-vfs2-unified-shlibs (>= 1:2.24.0-1),
	gtk+2-shlibs (>= 2.14.0-1),
	libart2-shlibs,
	libavahi-client3-shlibs,
	libavahi-common3-shlibs,
	libavahi-glib1-shlibs,
	libbonobo2-shlibs (>= 2.24.0-1),
	libbonoboui2-shlibs (>= 2.24.0-1),
	libgettext3-shlibs,
	libglade2-shlibs (>= 2.6.3-1),
	libgnome2-shlibs (>= 2.24.0-1),
	libgnomecanvas2-shlibs (>= 2.20.1.1-2),
	libgnomeui2-shlibs (>= 2.24.0-1),
	libiconv,
	libjpeg-shlibs,
	libkpathsea4-shlibs,
	libnautilus-ext2-shlibs,
	libpng3-shlibs,
	libtiff-shlibs,
	libxml2-shlibs (>= 2.6.30-1),
	orbit2-shlibs (>= 2.14.16-1),
	pango1-xft2-ft219-shlibs (>= 1.22.4-1),
	pixman-shlibs (>= 0.12.0-1),
	poppler2-glib-shlibs (>= 0.6.4-1),
	poppler2-shlibs (>= 0.6.4-1),
	popt-shlibs,
	rarian-compat,
	tetex-base | system-tetex,
	x11-shlibs
<<
BuildDepends: <<
	atk1 (>= 1.24.0-1),
	autoconf,
	audiofile,
	automake1.10,
	avahi-dev,
	libpng3,
	cairo (>= 1.8-1),
	dbus-dev (>= 1.2.1-1),
	esound (>= 0.2.38-1),
	expat1,
	fink (>= 0.24.12-1),
	fontconfig2-dev (>= 2.4.1-1),
	freetype219 (>= 2.3.7-7),
	gconf2-dev (>= 2.24.0-1),
	gettext-tools,
	glib2-dev (>= 2.18.0-1),
	glitz,
	gnome-common (>= 2.24.0-1),
	gnome-doc-utils (>= 0.14.2-1),
	gnome-icon-theme,
	gnome-keyring-dev (>= 0.8.1-1),
	gnome-vfs2-unified-dev (>= 1:2.24.0-1),
	gtk-doc (>= 1.8-1),
	gtk+2-dev (>= 2.14.0-1),
	intltool40,
	libart2,
	libavahi-glib1-dev,
	libbonobo2-dev (>= 2.24.0-1),
	libbonoboui2-dev (>= 2.24.0-1),
	libgettext3-dev,
	libglade2 (>= 2.6.3-1),
	libgnome2-dev (>= 2.24.0-1),
	libgnomecanvas2-dev (>= 2.20.1.1-2),
	libgnomeui2-dev (>= 2.24.0-1),
	libiconv-dev,
	libjpeg,
	libkpathsea4,
	libnautilus-ext2-dev,
	libpng3,
	libtiff,
	libtool14,
	libxml2 (>= 2.6.30-1),
	orbit2-dev (>= 2.14.16-1),
	pango1-xft2-ft219-dev (>= 1.22.4-1),
	pixman (>= 0.12.0-1),
	pkgconfig (>= 0.23),
	poppler2 (>= 0.6.4-1),
	poppler2-glib (>= 0.6.4-1),
	poppler-bin (>= 0.6.4-1),
	popt,
	x11-dev,
	xft2-dev
<<
Source: mirror:gnome:sources/%n/2.20/%n-%v.tar.bz2
Source-MD5: 15214f5211d9f98ffa0afd8158b7d021
GCC: 4.0
ConfigureParams: --disable-dependency-tracking --disable-schemas-install --disable-scrollkeeper --enable-dvi --with-print=gtk --mandir=%p/share/man PKG_CONFIG_PATH="%p/lib/fontconfig2/lib/pkgconfig:$PKG_CONFIG_PATH" --disable-gtk-doc
PatchFile: %n.patch
PatchFile-MD5: 783a9b6e70c42f277fce672cf079a205
PatchScript: <<
	%{default_script}
	intltoolize -f
	autoreconf -f -i
	find . -name Makefile.in | xargs perl -pi -e 's,LINK = \$\(LIBTOOL\) --tag=CC,LINK = \$\(LIBTOOL\) --tag=CXX,' 
	perl -pi -e 's,/usr/share/gtk-doc/html,%p/share/gtk-doc/html,g' help/reference/html/*.html
<<
CompileScript: <<
#!/bin/sh -ev

	./configure %c
	make CCLD=g++
<<
InstallScript: make -j1 install DESTDIR="%d" nautilusdir=`pkg-config --variable=extensiondir libnautilus-extension`
DocFiles: README COPYING
ConfFiles: <<
  %p/etc/gconf/schemas/evince.schemas
  %p/etc/gconf/schemas/evince-thumbnailer.schemas
  %p/etc/gconf/schemas/evince-thumbnailer-dvi.schemas
  %p/etc/gconf/schemas/evince-thumbnailer-ps.schemas
<<
PostInstScript: <<
  if [ configure = "$1" ]; then
    scrollkeeper-update -q
    export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
    gconftool-2 --makefile-install-rule %p/etc/gconf/schemas/evince.schemas >/dev/null
    gconftool-2 --makefile-install-rule %p/etc/gconf/schemas/evince-thumbnailer.schemas >/dev/null
    gconftool-2 --makefile-install-rule %p/etc/gconf/schemas/evince-thumbnailer-dvi.schemas >/dev/null
    gconftool-2 --makefile-install-rule %p/etc/gconf/schemas/evince-thumbnailer-ps.schemas >/dev/null
  fi
<<
PostRmScript: <<
  if [ upgrade != "$1" ]; then
    scrollkeeper-update -q
  fi
<<
Homepage: http://www.gnome.org/projects/evince/
DescDetail: <<
Evince is a document viewer for multiple document formats. It
currently supports pdf, postscript, djvu, tiff and dvi. The goal of
evince is to replace the multiple document viewers that exist on the
GNOME Desktop with a single simple application.
<<
DescPackaging: <<
	Should enable pixbuf or impress?

	Has C++ in low-level sources, so need to force use of g++ for
	linking higher-level objects.

	Remove superfluous use of obsolete libgnomeprint stack. See:
	http://bugzilla.gnome.org/show_bug.cgi?id=508684

	Use nautilus's self-published extensions dir instead of
	hard-coding what it was for a certain libnautilus version

	Misc back-ends are left disabled due to inertia.

	Makes system() calls to gs. Future versions will use
	libspectre (which links libgs) instead, but libspectre as of
	0.2.2 does not seem viable on OS X.

	Regenerating gtk-doc files The Right Way (--enable-gtk-doc) is
	very slow, so just patch the prefix in the bad URLs in the
	existing generated files. Also would need to patch evince's
	scanner program to be linked with g++
<<
DescPort: <<
	libpsdocument directly uses libX11 symbols
<<
