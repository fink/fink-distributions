Package: graphviz
Version: 2.18
Revision: 3
License: BSD
Maintainer: Matthias Neeracher <neeracher@mac.com>
# Maintainer: David Fang <fangism@users.sourceforge.net>
Homepage: http://www.graphviz.org/
#Conflicts: graphviz
#Replaces: graphviz
Source: mirror:custom:%n-%v.tar.gz
CustomMirror: <<
nam-US: http://www.graphviz.org/pub/graphviz/ARCHIVE
nam-US: http://www.graphviz.org/pub/graphviz
<<
SourceDirectory: %n-%v
Source-MD5: 7df2705482c86fc7a9ee5f0446ed0b9e
Patch: %n.patch
# PatchScript: <<
#	patch -p0 < %a/%n.patch
# <<
GCC: 4.0
Depends: <<
	%N-shlibs (= %v-%r)
<<
BuildDepends: <<
	pkgconfig (>= 0.20-1),
	tcltk-dev, 
	x11-dev, 
	fontconfig2-dev (>= 2.3.95-1),
	freetype219 (>= 2.1.10-1),
	glib2-dev (>= 2.11.1-1), 
	gtkglext1,
	guile18,
	guile18-dev, 
	libpng3 (>= 1.2.10-1), 
	libjpeg, 
	libiconv-dev, 
	libgettext3-dev (>= 0.14.5-1),
	gettext-tools,
	libtool14,
	libgnomeui2-dev,
	lua51-dev,
	lua51,
	expat1 (>= 2.0.0-1), 
	gd2, 
	gd2-bin (>= 2.0.34-1), 
	gdk-pixbuf,
	gawk (>= 3.1.2-12), 
	cairo (>= 1.1.10-1000),
	ocaml,
	ruby18-dev,
	ruby18,
	swig (>= 1.3.29-1)
<<
ConfigureParams: --mandir=%p/share/man --with-extraincludedir=%p/include --with-extralibdir=%p/lib --with-tcl=%p --with-tk=%p --with-x --x-includes=/usr/X11R6/include --x-libraries=/usr/X11R6/lib --disable-r FREETYPE2_CFLAGS=-I%p/lib/freetype219/include/freetype2 FREETYPE2_LIBS=-L%p/lib/freetype219/lib GUILE=guile-1.8 
# --with-freetypeincludedir=/usr/X11R6/include/freetype2
CompileScript: <<
	#!/bin/sh -ev
	./configure %c
	make
<<
# InfoTest: <<
#	TestScript: <<
#	#!/bin/sh -ev
#	# make check || exit 2
# 	# rtest.sh looks intended for post-install checking
#	cd rtest
#	./rtest.sh -v || exit 2
#	<<
##	TestDepends:
#	TestSuiteSize: small
#<<
InstallScript: <<
	#!/bin/sh -ev
	make DESTDIR=%d install
	# remove links in /usr
	rm -rf %d/usr
	rm -rf %d/Library
	rm -rf %d/Network
	mkdir -p %i/lib/perl5/darwin-thread-multi-2level/%n
	ln -s %p/lib/%n/perl/gv.pm %i/lib/perl5/darwin-thread-multi-2level/%n
	mkdir -p %i/share/doc
	mv %i/share/%n/doc %i/share/doc/%n 
	mv %i/share/%n/{demo,examples,graphs} %i/share/doc/%n
	rm -rf %i/share/%n/doc
	# mkdir -p %i/lib/ruby/1.8/%n
	# didn't find any .rb files?
	# not bothering with %p/lib/php
<<
# rtest/rtest.sh is intended as a installcheck-time script
SplitOff: <<
	Package: %N-shlibs
	Depends: <<
		glib2-shlibs, 
		gtkglext1-shlibs,
		guile18-shlibs, 
		tcltk, 
		x11, 
		fontconfig2-shlibs, 
		freetype219-shlibs,
		libpng3-shlibs, 
		libjpeg-shlibs, 
		libiconv, 
		libgettext3-shlibs,
		libtool14-shlibs, 
		libgnomeui2-shlibs,
		lua51-shlibs,
		expat1-shlibs, 
		gd2-shlibs, 
		gdk-pixbuf-shlibs,
		ruby18-shlibs,
		cairo-shlibs
	<<
	Files: <<
		lib/graphviz/*.dylib
		lib/graphviz/guile/*.so
		lib/graphviz/lua/*.so
		lib/graphviz/perl/*.so
		lib/graphviz/php/*.so
		lib/graphviz/python/*.so
		lib/graphviz/ruby/*.so
		lib/graphviz/tcl/*.so
		lib/graphviz/tcl/*.dylib
		lib/graphviz/tcl/pkgIndex.tcl
		lib/*.dylib
	<<
	Shlibs: <<
		%p/lib/graphviz/libgvplugin_core.5.dylib 6.0.0 %n (>= 2.14-1)
		%p/lib/graphviz/libgvplugin_dot_layout.5.dylib 6.0.0 %n (>= 2.14-1)
		%p/lib/graphviz/libgvplugin_gd.5.dylib 6.0.0 %n (>= 2.14-1)
		%p/lib/graphviz/libgvplugin_neato_layout.5.dylib 6.0.0 %n (>= 2.14-1)
		%p/lib/graphviz/libgvplugin_rsvg.5.dylib 6.0.0 %n (>= 2.18-1)
		%p/lib/graphviz/tcl/libgdtclft.0.dylib 1.0.0 %n (>= 2.14-1)
		%p/lib/graphviz/tcl/libtcldot.0.dylib 1.0.0 %n (>= 2.14-1)
		%p/lib/graphviz/tcl/libtcldot_builtin.0.dylib 1.0.0 %n (>= 2.14-1)
		%p/lib/graphviz/tcl/libtclplan.0.dylib 1.0.0 %n (>= 2.14-1)
		%p/lib/graphviz/tcl/libtkspline.0.dylib 1.0.0 %n (>= 2.14-1)
		%p/lib/libagraph.4.dylib 5.0.0 %n (>= 2.14-1)
		%p/lib/libcgraph.4.dylib 5.0.0 %n (>= 2.18-1)
		%p/lib/libcdt.4.dylib 5.0.0 %n (>= 2.14-1)
		%p/lib/libgraph.4.dylib 5.0.0 %n (>= 2.14-1)
		%p/lib/libgvc.4.dylib 5.0.0 %n (>= 2.14-1)
		%p/lib/libgvc_builtins.4.dylib 5.0.0 %n (>= 2.14-1)
		%p/lib/libpathplan.4.dylib 5.0.0 %n (>= 2.14-1)
	<<
	DescPackaging: <<
		There are some other lib/graphviz directories that are empty
		at package-time: R/ io/ java/ ocaml/ python{23,24,25}/ sharp/.
		Don't know what these are about...
	<<
<<
SplitOff2: <<
	Package: %N-dev
	BuildDependsOnly: true
	Depends: %N-shlibs (= %v-%r)
	Description: development files for graphviz
	Files: <<
		include/graphviz
		lib/graphviz/*.la
		lib/graphviz/guile/*.la
		lib/graphviz/lua/*.la
		lib/graphviz/perl/*.la
		lib/graphviz/php/*.la
		lib/graphviz/python/*.la
		lib/graphviz/ruby/*.la
		lib/graphviz/tcl/*.la
		lib/pkgconfig/*.pc
		lib/*.la
	<<
<<
PostInstScript: %p/bin/dot -c
DocFiles: AUTHORS COPYING ChangeLog INSTALL NEWS README
# there are more doc files
Description: Graph visualization software
DescDetail: <<
graphviz is a set of graph drawing tools for Unix or MS-Windows 
(win32), including a web service interface (webdot). Graph drawing 
addresses the problem of visualizing structural information by 
constructing geometric representations of abstract graphs and 
networks. Automatic generation of graph drawings has important 
applications in key technologies such as database design, software 
engineering, VLSI and network design and visual interfaces in other 
domains.
.
Many thanks to Jeroen Scheerder <Jeroen.Scheerder@phil.uu.nl> for
pointing me in the right directions.
.
Former maintainer(s): Thomas Kotzian <thomas.kotzian@gmx.at>
<<
DescPackaging: <<
configure doesn't find gtkgl+: "desktop features will not be built" for now.
Use libiconv from fink or system?
postinstall 'dot -c' updates config file with list of built plugins.
Links with libtool14's libltdl.dylib, but need not build-depend on libtool14 
because libltdl already includes ltdl.h (but added bdep for safety).
Blindly added deps for guile, lua, ocaml, ruby, libgnomeui2, gdk-pixbuf, 
gettext-tools because they are checked in configure,
though some may result in optional plug-ins.
Not sure what to do about perl/python yet...
Other deps not listed: zlib-1.2.3 (system's)
Missing deps: pango1-1.14.9+ (according to configure.ac)
Optional: lua (>= 5.0)
also checked in configure: pangocairo, gtkgl+
<<
