Package: wview
Version: 3.4.0
Revision: 1
Source: mirror:sourceforge:%n/%n-%v.tar.gz
Source-MD5: 09754b3fd0a78d93dfa582d9a484e6a5
PatchFile: %n.patch
PatchFile-MD5: 9fd22f95335671a70c9ed549bb81d335
PatchScript: <<
	sed -e 's,@FINKPREFIX@,%p,g' %{PatchFile} | patch -p1
	perl -pi -e 's,/var/wview,%p/var/wview,g; s,/etc/wview,%p/etc/wview,g' common/*.h stations/*/*.c examples/conf/* `find . -name \*.sh | grep -v examples/conf`
<<

BuildDepends: <<
	fink (>= 0.24.12),
	gd2-nox | gd2,
	libcurl4,
	libpng3,
	radlib-dev,
	system-openssl-dev
<<
RuntimeDepends: daemonic
Depends: <<
	gd2-nox-shlibs | gd2-shlibs,
	libcurl4-shlibs,
	libpng3-shlibs,
	radlib-shlibs
<<

SetCPPFLAGS: -I%p/lib/system-openssl/include
SetLDFLAGS: -L%p/lib/system-openssl/lib

ConfigureParams: --disable-dependency-tracking --enable-http --enable-wunderground --enable-station-vpro --enable-station-wxt510 --enable-station-sim
InstallScript: <<
#!/bin/sh -ev

	make -j1 install install-env DESTDIR="%d"
	install -d -m 755 %i/sbin
	sed -e 's,/var/wview,%p/var/wview,g' -e 's,/opt/local/bin,%p/bin,g' examples/MacOSX/wview/wview | grep -v -E '(LD_LIBRARY_PATH|ConsoleMessage -S)' > %i/sbin/wview
	chmod 755 %i/sbin/wview
	install -d -m 755 %i/share/doc/%N
	ditto examples %i/share/doc/%N/examples
<<

ConfFiles: <<
	%p/etc/wview/arcrec-header.conf
	%p/etc/wview/forecast.conf-no-forecast
	%p/etc/wview/html/Current.htx
	%p/etc/wview/html/Current_Conditions.htx
	%p/etc/wview/html/Current_Plus.htx
	%p/etc/wview/html/Daily.htx
	%p/etc/wview/html/Daily_Plus.htx
	%p/etc/wview/html/Monthly.htx
	%p/etc/wview/html/Monthly_Plus.htx
	%p/etc/wview/html/Weekly.htx
	%p/etc/wview/html/Weekly_Plus.htx
	%p/etc/wview/html/Yearly.htx
	%p/etc/wview/html/Yearly_Plus.htx
	%p/etc/wview/html/almanac.htx
	%p/etc/wview/html/almanac_Plus.htx
	%p/etc/wview/html/awekas_wl.htx-metric
	%p/etc/wview/html/awekas_wl.htx-us
	%p/etc/wview/html/data.htx
	%p/etc/wview/html/header-big.incx
	%p/etc/wview/html/header.incx
	%p/etc/wview/html/index-day.htx
	%p/etc/wview/html/index-day_Plus.htx
	%p/etc/wview/html/index-night.htx
	%p/etc/wview/html/index-night_Plus.htx
	%p/etc/wview/html/index.htx
	%p/etc/wview/html/index_Plus.htx
	%p/etc/wview/html/nav-buttons.incx
	%p/etc/wview/html/readings-plus.incx
	%p/etc/wview/html/readings.incx
	%p/etc/wview/html/wxrss.xtx
	%p/etc/wview/html-templates.conf
	%p/etc/wview/htmlgen.conf
	%p/etc/wview/http.conf-no-http
	%p/etc/wview/images-metric-mm.conf
	%p/etc/wview/images-metric.conf
	%p/etc/wview/images-user.conf
	%p/etc/wview/images.conf
	%p/etc/wview/outtempMax.sh
	%p/etc/wview/outtempMin.sh
	%p/etc/wview/post-generate.sh
	%p/etc/wview/processes.conf
	%p/etc/wview/wvalarm.conf-no-alarms
	%p/etc/wview/wvcwop.conf-no-cwop
	%p/etc/wview/wview.conf
	%p/etc/wview/wviewftp.conf-no-ftp
	%p/etc/wview/wviewssh.conf-no-ssh
<<
DaemonicFile: <<
	<service>
		<description>WView Weather Station Software</description>
		<message> WView Weather Station</message>
		<daemon name="%N">
			<executable background="no">%p/sbin/wview</executable>
			<parameters>start</parameters>
		</daemon>
	</service>
<<
PostInstScript: <<
	echo ""
	echo ""
	echo "NOTE: You must run 'sudo %p/bin/wviewconfig' before this package will do anything."
	echo ""
	echo ""
<<

DocFiles: AUTHORS COPYING ChangeLog INSTALL MAINTAIN NEWS README TODO UPGRADE
Description: Weather Station Software
DescDetail: <<
wview is a collection of linux/unix daemons which interface
with a supported weather station to retrieve archive records
(if generated by the station) and current conditions. 
<<
DescUsage: <<
	Run "sudo %p/bin/wviewconfig" to create your configuration file.
	Then, run "sudo daemonic enable wview" to make sure wview starts on bootup.

	To start/stop manually, run:
		%p/sbin/wview <start|stop>
<<
License: GPL
Maintainer: Benjamin Reed <wview@fink.racoonfink.com>
Homepage: http://www.wviewweather.com/
