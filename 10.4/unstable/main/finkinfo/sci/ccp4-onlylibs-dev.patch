diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/Makefile.am ccp4-onlylibs-dev/lib/src/mmdb/Makefile.am
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/Makefile.am	1969-12-31 16:00:00.000000000 -0800
+++ ccp4-onlylibs-dev/lib/src/mmdb/Makefile.am	2007-10-21 22:33:35.000000000 -0700
@@ -0,0 +1,29 @@
+
+AUTOMAKE_OPTIONS = foreign
+
+lib_LTLIBRARIES = libmmdb.la
+
+library_includedir = $(pkgincludedir)
+
+# includedir = $(pkgincludedir)/mmdb
+
+library_include_HEADERS = \
+bfgs_min.h    mmdb_atom.h      mmdb_ficif.h    mmdb_rwbrook.h  mmdb_uddata.h \
+file_.h       mmdb_bondmngr.h  mmdb_file.h     mmdb_sbase0.h   mmdb_utils.h  \
+linalg_.h     mmdb_chain.h     mmdb_graph.h    mmdb_sbase.h    mmdb_xml.h    \
+machine_.h    mmdb_cifdefs.h   mmdb_manager.h  mmdb_selmngr.h  random_n.h    \
+math_.h       mmdb_coormngr.h  mmdb_mask.h     mmdb_symop.h    stream_.h     \
+mattype_.h    mmdb_cryst.h     mmdb_mmcif.h    mmdb_tables.h                 \
+mmdb_align.h  mmdb_defs.h      mmdb_model.h    mmdb_title.h
+
+libmmdb_la_SOURCES = \
+bfgs_min.cpp	mmdb_bondmngr.cpp  mmdb_manager.cpp  mmdb_symop.cpp   \
+file_.cpp	mmdb_chain.cpp	   mmdb_mask.cpp     mmdb_tables.cpp  \
+linalg_.cpp	mmdb_cifdefs.cpp   mmdb_mmcif.cpp    mmdb_title.cpp   \
+machine_.cpp	mmdb_coormngr.cpp  mmdb_model.cpp    mmdb_uddata.cpp  \
+math_.cpp	mmdb_cryst.cpp	   mmdb_rwbrook.cpp  mmdb_utils.cpp   \
+mattype_.cpp	mmdb_ficif.cpp	   mmdb_sbase0.cpp   mmdb_xml.cpp     \
+mmdb_align.cpp	mmdb_file.cpp	   mmdb_sbase.cpp    random_n.cpp     \
+mmdb_atom.cpp	mmdb_graph.cpp	   mmdb_selmngr.cpp  stream_.cpp
+
+
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/Makefile.in ccp4-onlylibs-dev/lib/src/mmdb/Makefile.in
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/Makefile.in	1969-12-31 16:00:00.000000000 -0800
+++ ccp4-onlylibs-dev/lib/src/mmdb/Makefile.in	2007-10-21 22:33:35.000000000 -0700
@@ -0,0 +1,533 @@
+# Makefile.in generated by automake 1.9.6 from Makefile.am.
+# @configure_input@
+
+# Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
+# 2003, 2004, 2005  Free Software Foundation, Inc.
+# This Makefile.in is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
+# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
+# PARTICULAR PURPOSE.
+
+@SET_MAKE@
+
+
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+VPATH = @srcdir@
+pkgdatadir = $(datadir)/@PACKAGE@
+pkglibdir = $(libdir)/@PACKAGE@
+pkgincludedir = $(includedir)/@PACKAGE@
+top_builddir = ..
+am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
+INSTALL = @INSTALL@
+install_sh_DATA = $(install_sh) -c -m 644
+install_sh_PROGRAM = $(install_sh) -c
+install_sh_SCRIPT = $(install_sh) -c
+INSTALL_HEADER = $(INSTALL_DATA)
+transform = $(program_transform_name)
+NORMAL_INSTALL = :
+PRE_INSTALL = :
+POST_INSTALL = :
+NORMAL_UNINSTALL = :
+PRE_UNINSTALL = :
+POST_UNINSTALL = :
+build_triplet = @build@
+host_triplet = @host@
+subdir = src
+DIST_COMMON = README $(library_include_HEADERS) $(srcdir)/Makefile.am \
+	$(srcdir)/Makefile.in
+ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
+am__aclocal_m4_deps = $(top_srcdir)/configure.in
+am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
+	$(ACLOCAL_M4)
+mkinstalldirs = $(install_sh) -d
+CONFIG_HEADER = $(top_builddir)/config.h
+CONFIG_CLEAN_FILES =
+am__vpath_adj_setup = srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`;
+am__vpath_adj = case $$p in \
+    $(srcdir)/*) f=`echo "$$p" | sed "s|^$$srcdirstrip/||"`;; \
+    *) f=$$p;; \
+  esac;
+am__strip_dir = `echo $$p | sed -e 's|^.*/||'`;
+am__installdirs = "$(DESTDIR)$(libdir)" \
+	"$(DESTDIR)$(library_includedir)"
+libLTLIBRARIES_INSTALL = $(INSTALL)
+LTLIBRARIES = $(lib_LTLIBRARIES)
+libmmdb_la_LIBADD =
+am_libmmdb_la_OBJECTS = bfgs_min.lo mmdb_bondmngr.lo mmdb_manager.lo \
+	mmdb_symop.lo file_.lo mmdb_chain.lo mmdb_mask.lo \
+	mmdb_tables.lo linalg_.lo mmdb_cifdefs.lo mmdb_mmcif.lo \
+	mmdb_title.lo machine_.lo mmdb_coormngr.lo mmdb_model.lo \
+	mmdb_uddata.lo math_.lo mmdb_cryst.lo mmdb_rwbrook.lo \
+	mmdb_utils.lo mattype_.lo mmdb_ficif.lo mmdb_sbase0.lo \
+	mmdb_xml.lo mmdb_align.lo mmdb_file.lo mmdb_sbase.lo \
+	random_n.lo mmdb_atom.lo mmdb_graph.lo mmdb_selmngr.lo \
+	stream_.lo
+libmmdb_la_OBJECTS = $(am_libmmdb_la_OBJECTS)
+DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)
+depcomp = $(SHELL) $(top_srcdir)/depcomp
+am__depfiles_maybe = depfiles
+CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
+	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
+LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
+	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
+	$(AM_CXXFLAGS) $(CXXFLAGS)
+CXXLD = $(CXX)
+CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
+	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
+SOURCES = $(libmmdb_la_SOURCES)
+DIST_SOURCES = $(libmmdb_la_SOURCES)
+library_includeHEADERS_INSTALL = $(INSTALL_HEADER)
+HEADERS = $(library_include_HEADERS)
+ETAGS = etags
+CTAGS = ctags
+DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
+ACLOCAL = @ACLOCAL@
+AMDEP_FALSE = @AMDEP_FALSE@
+AMDEP_TRUE = @AMDEP_TRUE@
+AMTAR = @AMTAR@
+AR = @AR@
+AUTOCONF = @AUTOCONF@
+AUTOHEADER = @AUTOHEADER@
+AUTOMAKE = @AUTOMAKE@
+AWK = @AWK@
+CC = @CC@
+CCDEPMODE = @CCDEPMODE@
+CFLAGS = @CFLAGS@
+CPP = @CPP@
+CPPFLAGS = @CPPFLAGS@
+CXX = @CXX@
+CXXCPP = @CXXCPP@
+CXXDEPMODE = @CXXDEPMODE@
+CXXFLAGS = @CXXFLAGS@
+CYGPATH_W = @CYGPATH_W@
+DEFS = @DEFS@
+DEPDIR = @DEPDIR@
+ECHO = @ECHO@
+ECHO_C = @ECHO_C@
+ECHO_N = @ECHO_N@
+ECHO_T = @ECHO_T@
+EGREP = @EGREP@
+EXEEXT = @EXEEXT@
+F77 = @F77@
+FFLAGS = @FFLAGS@
+INSTALL_DATA = @INSTALL_DATA@
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_SCRIPT = @INSTALL_SCRIPT@
+INSTALL_STRIP_PROGRAM = @INSTALL_STRIP_PROGRAM@
+LDFLAGS = @LDFLAGS@
+LIBOBJS = @LIBOBJS@
+LIBS = @LIBS@
+LIBTOOL = @LIBTOOL@
+LN_S = @LN_S@
+LTLIBOBJS = @LTLIBOBJS@
+MAKEINFO = @MAKEINFO@
+OBJEXT = @OBJEXT@
+PACKAGE = @PACKAGE@
+PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
+PACKAGE_NAME = @PACKAGE_NAME@
+PACKAGE_STRING = @PACKAGE_STRING@
+PACKAGE_TARNAME = @PACKAGE_TARNAME@
+PACKAGE_VERSION = @PACKAGE_VERSION@
+PATH_SEPARATOR = @PATH_SEPARATOR@
+RANLIB = @RANLIB@
+SET_MAKE = @SET_MAKE@
+SHELL = @SHELL@
+STRIP = @STRIP@
+VERSION = @VERSION@
+ac_ct_AR = @ac_ct_AR@
+ac_ct_CC = @ac_ct_CC@
+ac_ct_CXX = @ac_ct_CXX@
+ac_ct_F77 = @ac_ct_F77@
+ac_ct_RANLIB = @ac_ct_RANLIB@
+ac_ct_STRIP = @ac_ct_STRIP@
+am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
+am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
+am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
+am__fastdepCXX_TRUE = @am__fastdepCXX_TRUE@
+am__include = @am__include@
+am__leading_dot = @am__leading_dot@
+am__quote = @am__quote@
+am__tar = @am__tar@
+am__untar = @am__untar@
+bindir = @bindir@
+build = @build@
+build_alias = @build_alias@
+build_cpu = @build_cpu@
+build_os = @build_os@
+build_vendor = @build_vendor@
+datadir = @datadir@
+exec_prefix = @exec_prefix@
+host = @host@
+host_alias = @host_alias@
+host_cpu = @host_cpu@
+host_os = @host_os@
+host_vendor = @host_vendor@
+includedir = @includedir@
+infodir = @infodir@
+install_sh = @install_sh@
+libdir = @libdir@
+libexecdir = @libexecdir@
+localstatedir = @localstatedir@
+mandir = @mandir@
+mkdir_p = @mkdir_p@
+oldincludedir = @oldincludedir@
+prefix = @prefix@
+program_transform_name = @program_transform_name@
+sbindir = @sbindir@
+sharedstatedir = @sharedstatedir@
+sysconfdir = @sysconfdir@
+target_alias = @target_alias@
+AUTOMAKE_OPTIONS = foreign
+lib_LTLIBRARIES = libmmdb.la
+library_includedir = $(pkgincludedir)
+
+# includedir = $(pkgincludedir)/mmdb
+library_include_HEADERS = \
+bfgs_min.h    mmdb_atom.h      mmdb_ficif.h    mmdb_rwbrook.h  mmdb_uddata.h \
+file_.h       mmdb_bondmngr.h  mmdb_file.h     mmdb_sbase0.h   mmdb_utils.h  \
+linalg_.h     mmdb_chain.h     mmdb_graph.h    mmdb_sbase.h    mmdb_xml.h    \
+machine_.h    mmdb_cifdefs.h   mmdb_manager.h  mmdb_selmngr.h  random_n.h    \
+math_.h       mmdb_coormngr.h  mmdb_mask.h     mmdb_symop.h    stream_.h     \
+mattype_.h    mmdb_cryst.h     mmdb_mmcif.h    mmdb_tables.h                 \
+mmdb_align.h  mmdb_defs.h      mmdb_model.h    mmdb_title.h
+
+libmmdb_la_SOURCES = \
+bfgs_min.cpp	mmdb_bondmngr.cpp  mmdb_manager.cpp  mmdb_symop.cpp   \
+file_.cpp	mmdb_chain.cpp	   mmdb_mask.cpp     mmdb_tables.cpp  \
+linalg_.cpp	mmdb_cifdefs.cpp   mmdb_mmcif.cpp    mmdb_title.cpp   \
+machine_.cpp	mmdb_coormngr.cpp  mmdb_model.cpp    mmdb_uddata.cpp  \
+math_.cpp	mmdb_cryst.cpp	   mmdb_rwbrook.cpp  mmdb_utils.cpp   \
+mattype_.cpp	mmdb_ficif.cpp	   mmdb_sbase0.cpp   mmdb_xml.cpp     \
+mmdb_align.cpp	mmdb_file.cpp	   mmdb_sbase.cpp    random_n.cpp     \
+mmdb_atom.cpp	mmdb_graph.cpp	   mmdb_selmngr.cpp  stream_.cpp
+
+all: all-am
+
+.SUFFIXES:
+.SUFFIXES: .cpp .lo .o .obj
+$(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)
+	@for dep in $?; do \
+	  case '$(am__configure_deps)' in \
+	    *$$dep*) \
+	      cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh \
+		&& exit 0; \
+	      exit 1;; \
+	  esac; \
+	done; \
+	echo ' cd $(top_srcdir) && $(AUTOMAKE) --foreign  src/Makefile'; \
+	cd $(top_srcdir) && \
+	  $(AUTOMAKE) --foreign  src/Makefile
+.PRECIOUS: Makefile
+Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
+	@case '$?' in \
+	  *config.status*) \
+	    cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh;; \
+	  *) \
+	    echo ' cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@ $(am__depfiles_maybe)'; \
+	    cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@ $(am__depfiles_maybe);; \
+	esac;
+
+$(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
+	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
+
+$(top_srcdir)/configure:  $(am__configure_deps)
+	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
+$(ACLOCAL_M4):  $(am__aclocal_m4_deps)
+	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
+install-libLTLIBRARIES: $(lib_LTLIBRARIES)
+	@$(NORMAL_INSTALL)
+	test -z "$(libdir)" || $(mkdir_p) "$(DESTDIR)$(libdir)"
+	@list='$(lib_LTLIBRARIES)'; for p in $$list; do \
+	  if test -f $$p; then \
+	    f=$(am__strip_dir) \
+	    echo " $(LIBTOOL) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(libdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(libdir)/$$f"; \
+	  else :; fi; \
+	done
+
+uninstall-libLTLIBRARIES:
+	@$(NORMAL_UNINSTALL)
+	@set -x; list='$(lib_LTLIBRARIES)'; for p in $$list; do \
+	  p=$(am__strip_dir) \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(libdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(libdir)/$$p"; \
+	done
+
+clean-libLTLIBRARIES:
+	-test -z "$(lib_LTLIBRARIES)" || rm -f $(lib_LTLIBRARIES)
+	@list='$(lib_LTLIBRARIES)'; for p in $$list; do \
+	  dir="`echo $$p | sed -e 's|/[^/]*$$||'`"; \
+	  test "$$dir" != "$$p" || dir=.; \
+	  echo "rm -f \"$${dir}/so_locations\""; \
+	  rm -f "$${dir}/so_locations"; \
+	done
+libmmdb.la: $(libmmdb_la_OBJECTS) $(libmmdb_la_DEPENDENCIES) 
+	$(CXXLINK) -rpath $(libdir) $(libmmdb_la_LDFLAGS) $(libmmdb_la_OBJECTS) $(libmmdb_la_LIBADD) $(LIBS)
+
+mostlyclean-compile:
+	-rm -f *.$(OBJEXT)
+
+distclean-compile:
+	-rm -f *.tab.c
+
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/bfgs_min.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/file_.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/linalg_.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/machine_.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/math_.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mattype_.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_align.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_atom.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_bondmngr.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_chain.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_cifdefs.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_coormngr.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_cryst.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_ficif.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_file.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_graph.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_manager.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_mask.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_mmcif.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_model.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_rwbrook.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_sbase.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_sbase0.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_selmngr.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_symop.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_tables.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_title.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_uddata.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_utils.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mmdb_xml.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/random_n.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/stream_.Plo@am__quote@
+
+.cpp.o:
+@am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ $<
+
+.cpp.obj:
+@am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Po"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(CXXCOMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
+
+.cpp.lo:
+@am__fastdepCXX_TRUE@	if $(LTCXXCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Plo"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	DEPDIR=$(DEPDIR) $(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(LTCXXCOMPILE) -c -o $@ $<
+
+mostlyclean-libtool:
+	-rm -f *.lo
+
+clean-libtool:
+	-rm -rf .libs _libs
+
+distclean-libtool:
+	-rm -f libtool
+uninstall-info-am:
+install-library_includeHEADERS: $(library_include_HEADERS)
+	@$(NORMAL_INSTALL)
+	test -z "$(library_includedir)" || $(mkdir_p) "$(DESTDIR)$(library_includedir)"
+	@list='$(library_include_HEADERS)'; for p in $$list; do \
+	  if test -f "$$p"; then d=; else d="$(srcdir)/"; fi; \
+	  f=$(am__strip_dir) \
+	  echo " $(library_includeHEADERS_INSTALL) '$$d$$p' '$(DESTDIR)$(library_includedir)/$$f'"; \
+	  $(library_includeHEADERS_INSTALL) "$$d$$p" "$(DESTDIR)$(library_includedir)/$$f"; \
+	done
+
+uninstall-library_includeHEADERS:
+	@$(NORMAL_UNINSTALL)
+	@list='$(library_include_HEADERS)'; for p in $$list; do \
+	  f=$(am__strip_dir) \
+	  echo " rm -f '$(DESTDIR)$(library_includedir)/$$f'"; \
+	  rm -f "$(DESTDIR)$(library_includedir)/$$f"; \
+	done
+
+ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)
+	list='$(SOURCES) $(HEADERS) $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	mkid -fID $$unique
+tags: TAGS
+
+TAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
+		$(TAGS_FILES) $(LISP)
+	tags=; \
+	here=`pwd`; \
+	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
+	  test -n "$$unique" || unique=$$empty_fix; \
+	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
+	    $$tags $$unique; \
+	fi
+ctags: CTAGS
+CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
+		$(TAGS_FILES) $(LISP)
+	tags=; \
+	here=`pwd`; \
+	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
+	test -z "$(CTAGS_ARGS)$$tags$$unique" \
+	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
+	     $$tags $$unique
+
+GTAGS:
+	here=`$(am__cd) $(top_builddir) && pwd` \
+	  && cd $(top_srcdir) \
+	  && gtags -i $(GTAGS_ARGS) $$here
+
+distclean-tags:
+	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
+
+distdir: $(DISTFILES)
+	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
+	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
+	list='$(DISTFILES)'; for file in $$list; do \
+	  case $$file in \
+	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
+	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
+	  esac; \
+	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
+	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
+	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
+	    dir="/$$dir"; \
+	    $(mkdir_p) "$(distdir)$$dir"; \
+	  else \
+	    dir=''; \
+	  fi; \
+	  if test -d $$d/$$file; then \
+	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
+	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
+	    fi; \
+	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
+	  else \
+	    test -f $(distdir)/$$file \
+	    || cp -p $$d/$$file $(distdir)/$$file \
+	    || exit 1; \
+	  fi; \
+	done
+check-am: all-am
+check: check-am
+all-am: Makefile $(LTLIBRARIES) $(HEADERS)
+installdirs:
+	for dir in "$(DESTDIR)$(libdir)" "$(DESTDIR)$(library_includedir)"; do \
+	  test -z "$$dir" || $(mkdir_p) "$$dir"; \
+	done
+install: install-am
+install-exec: install-exec-am
+install-data: install-data-am
+uninstall: uninstall-am
+
+install-am: all-am
+	@$(MAKE) $(AM_MAKEFLAGS) install-exec-am install-data-am
+
+installcheck: installcheck-am
+install-strip:
+	$(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
+	  install_sh_PROGRAM="$(INSTALL_STRIP_PROGRAM)" INSTALL_STRIP_FLAG=-s \
+	  `test -z '$(STRIP)' || \
+	    echo "INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'"` install
+mostlyclean-generic:
+
+clean-generic:
+
+distclean-generic:
+	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
+
+maintainer-clean-generic:
+	@echo "This command is intended for maintainers to use"
+	@echo "it deletes files that may require special tools to rebuild."
+clean: clean-am
+
+clean-am: clean-generic clean-libLTLIBRARIES clean-libtool \
+	mostlyclean-am
+
+distclean: distclean-am
+	-rm -rf ./$(DEPDIR)
+	-rm -f Makefile
+distclean-am: clean-am distclean-compile distclean-generic \
+	distclean-libtool distclean-tags
+
+dvi: dvi-am
+
+dvi-am:
+
+html: html-am
+
+info: info-am
+
+info-am:
+
+install-data-am: install-library_includeHEADERS
+
+install-exec-am: install-libLTLIBRARIES
+
+install-info: install-info-am
+
+install-man:
+
+installcheck-am:
+
+maintainer-clean: maintainer-clean-am
+	-rm -rf ./$(DEPDIR)
+	-rm -f Makefile
+maintainer-clean-am: distclean-am maintainer-clean-generic
+
+mostlyclean: mostlyclean-am
+
+mostlyclean-am: mostlyclean-compile mostlyclean-generic \
+	mostlyclean-libtool
+
+pdf: pdf-am
+
+pdf-am:
+
+ps: ps-am
+
+ps-am:
+
+uninstall-am: uninstall-info-am uninstall-libLTLIBRARIES \
+	uninstall-library_includeHEADERS
+
+.PHONY: CTAGS GTAGS all all-am check check-am clean clean-generic \
+	clean-libLTLIBRARIES clean-libtool ctags distclean \
+	distclean-compile distclean-generic distclean-libtool \
+	distclean-tags distdir dvi dvi-am html html-am info info-am \
+	install install-am install-data install-data-am install-exec \
+	install-exec-am install-info install-info-am \
+	install-libLTLIBRARIES install-library_includeHEADERS \
+	install-man install-strip installcheck installcheck-am \
+	installdirs maintainer-clean maintainer-clean-generic \
+	mostlyclean mostlyclean-compile mostlyclean-generic \
+	mostlyclean-libtool pdf pdf-am ps ps-am tags uninstall \
+	uninstall-am uninstall-info-am uninstall-libLTLIBRARIES \
+	uninstall-library_includeHEADERS
+
+# Tell versions [3.59,3.63) of GNU make to not export all variables.
+# Otherwise a system limit (for SysV at least) may be exceeded.
+.NOEXPORT:
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/README ccp4-onlylibs-dev/lib/src/mmdb/README
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/README	2006-08-16 03:55:13.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/README	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-$Id: README,v 1.4 2006/08/16 10:55:13 fr45 Exp $
+$Id: README,v 1.2 2004/04/22 16:36:01 keb Exp $
 
 
            CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/bfgs_min.cpp ccp4-onlylibs-dev/lib/src/mmdb/bfgs_min.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/bfgs_min.cpp	2006-08-16 03:55:13.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/bfgs_min.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: bfgs_min.cpp,v 1.12 2006/08/16 10:55:13 fr45 Exp $
+//  $Id: bfgs_min.cpp,v 1.4 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/bfgs_min.h ccp4-onlylibs-dev/lib/src/mmdb/bfgs_min.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/bfgs_min.h	2006-08-16 03:55:13.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/bfgs_min.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: bfgs_min.h,v 1.13 2006/08/16 10:55:13 fr45 Exp $
+//  $Id: bfgs_min.h,v 1.6 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/file_.cpp ccp4-onlylibs-dev/lib/src/mmdb/file_.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/file_.cpp	2006-08-16 06:03:35.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/file_.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: file_.cpp,v 1.18 2006/08/16 13:03:35 fr45 Exp $
+//  $Id: file_.cpp,v 1.17 2007/01/30 12:33:45 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -40,7 +40,7 @@
 #include <string.h>
 #endif
 
-#ifndef _MSC_VER
+#ifndef _MVS
 #ifndef  __UNISTD_H
 #include <unistd.h>
 #endif
@@ -177,7 +177,7 @@
 
 void  CFile::assign ( const pstr FileName, Boolean Text, Boolean UniB,
                       byte gzMode )  {
-#ifndef _MSC_VER
+#ifndef _MVS
 pstr p;
 #endif
 
@@ -195,7 +195,7 @@
 
   UniBin = UniB;
 
-#ifndef _MSC_VER
+#ifndef _MVS
 
   gzipMode = gzMode;
   gzipIO   = ARCH_NONE;
@@ -273,7 +273,7 @@
 }
 
 Boolean  CFile::reset ( Boolean ReadOnly, int retry )  {
-#ifndef _MSC_VER
+#ifndef _MVS
 pstr p;
 int  i;
 #endif
@@ -305,7 +305,7 @@
 
       StdIO = False;
       if (gzipIO==ARCH_GZIP)  {
-#ifndef _MSC_VER
+#ifndef _MVS
         p = NULL;
         CreateConcat  ( p,ungzip_path,FName );
         for (i=0;(i<=retry) && (!hFile);i++)  {
@@ -316,7 +316,7 @@
 #endif
 
       } else if (gzipIO==ARCH_COMPRESS)  {
-#ifndef _MSC_VER
+#ifndef _MVS
         p = NULL;
         CreateConcat  ( p,uncompress_path,FName );
         for (i=0;(i<=retry) && (!hFile);i++)  {
@@ -328,7 +328,7 @@
 
       } else  {
 
-#ifndef _MSC_VER
+#ifndef _MVS
         for (i=0;(i<=retry) && (!hFile);i++)  {
           if (i>0)  sleep ( 1 );
 #endif
@@ -339,7 +339,7 @@
             if (ReadOnly)  hFile = fopen ( FName,"r"   );
                      else  hFile = fopen ( FName,"r+b" );
           }
-#ifndef _MSC_VER
+#ifndef _MVS
         }
 #endif
 
@@ -370,7 +370,7 @@
 }
 
 Boolean  CFile::rewrite()  {
-#ifndef _MSC_VER
+#ifndef _MVS
 pstr p;
 #endif
 
@@ -391,7 +391,7 @@
     BufCnt = 0;
 
     if (gzipIO==ARCH_GZIP)  {
-#ifndef _MSC_VER
+#ifndef _MVS
       p = NULL;
       CreateConcat  ( p,gzip_path,pstr(" > "),FName );
       hFile = popen ( p,"w" );
@@ -401,7 +401,7 @@
 #endif
       StdIO = False;
     } else if (gzipIO==ARCH_COMPRESS)  {
-#ifndef _MSC_VER
+#ifndef _MVS
       p = NULL;
       CreateConcat  ( p,compress_path,pstr(" > "),FName );
       hFile = popen ( p,"w" );
@@ -434,7 +434,7 @@
 }
 
 Boolean  CFile::append()  {
-#ifndef _MSC_VER
+#ifndef _MVS
 pstr p;
 #endif
 
@@ -455,7 +455,7 @@
     BufLen  = 0;
     BufCnt  = 0;
     if (gzipIO==ARCH_GZIP)  {
-#ifndef _MSC_VER
+#ifndef _MVS
       p = NULL;
       CreateConcat  ( p,gzip_path,pstr(" >> "),FName );
       hFile = popen ( p,"w" );
@@ -465,7 +465,7 @@
 #endif
       StdIO = False;
     } else if (gzipIO==ARCH_COMPRESS)  {
-#ifndef _MSC_VER
+#ifndef _MVS
       p = NULL;
       CreateConcat  ( p,compress_path,pstr(" >> "),FName );
       hFile = popen ( p,"w" );
@@ -596,7 +596,7 @@
 
   if (hFile!=NULL)  {
     if (!StdIO)  {
-#ifndef _MSC_VER
+#ifndef _MVS
       if (gzipIO!=ARCH_NONE)  pclose ( hFile );
                         else  fclose ( hFile );
 #else
@@ -1426,7 +1426,8 @@
   return IOSuccess;
 }
 
-Boolean  CFile::CreateReadVector ( rvector & V, int & len, int Shift )  {
+Boolean  CFile::CreateReadVector ( rvector & V, int & len,
+                                   int Shift )  {
 intUniBin  iUB;
 realUniBin rUB;
 int        i;
@@ -1462,7 +1463,8 @@
   return CreateReadVector ( V,len,Shift );
 }
 
-Boolean  CFile::CreateReadVector ( ivector & iV, int & len, int Shift )  {
+Boolean  CFile::CreateReadVector ( ivector & iV, int & len,
+                                   int Shift )  {
 intUniBin  iUB;
 int        i,iB;
   FreeVectorMemory ( iV,Shift );
@@ -1496,7 +1498,8 @@
   return CreateReadVector ( iV,len,Shift );
 }
 
-Boolean  CFile::CreateReadVector ( lvector & lV, int & len, int Shift )  {
+Boolean  CFile::CreateReadVector ( lvector & lV, int & len,
+                                   int Shift )  {
 intUniBin  iUB;
 longUniBin lUB;
 int        i;
@@ -1533,7 +1536,8 @@
 }
 
 
-Boolean  CFile::CreateReadVector ( bvector & B, int & len, int Shift )  {
+Boolean  CFile::CreateReadVector ( bvector & B, int & len,
+                                   int Shift )  {
 intUniBin  iUB;
 int        i;
 byte       t;
@@ -1591,7 +1595,8 @@
   return IOSuccess;
 }
 
-Boolean  CFile::CreateReadMatrix ( rmatrix & A, int ShiftN, int ShiftM )  {
+Boolean  CFile::CreateReadMatrix ( rmatrix & A, int ShiftN,
+                                   int ShiftM )  {
 int N,M;
   return CreateReadMatrix ( A,N,M,ShiftN,ShiftM );
 }
@@ -1686,7 +1691,8 @@
 
 
 int  CFile::CreateReadColumns ( rvector & X, rvector & Y, rvector & Z,
-                                int xCol, int yCol, int zCol, int Shift )  {
+                                int xCol, int yCol, int zCol,
+                                int Shift )  {
 //   ReadColumns reads data stored by WriteColumns. X, Y, and Z
 // must be set to NULL prior to call. They will be allocated
 // within the procedure.
@@ -1721,7 +1727,8 @@
         Ok = Ok && GetVectorMemory(Z,DataLen,Shift);
       if (Ok)  {
         reset();
-        _ReadColumns ( DataLen,S,sizeof(S),X,Y,Z,xCol,yCol,zCol,Shift );
+        _ReadColumns ( DataLen,S,sizeof(S),X,Y,Z,xCol,yCol,
+                       zCol,Shift );
       } else  ErrCode = FileError_NoMemory;
     } else  ErrCode = FileError_NoDataFound;
   } else  ErrCode = FileError_NoDataFound;
@@ -1735,7 +1742,8 @@
 
 void  CFile::_ReadColumns ( int & DLen, pstr S, int SLen,
                             rvector X, rvector Y, rvector Z,
-                            int xCol, int yCol, int zCol, int Shift )  {
+                            int xCol, int yCol, int zCol,
+                            int Shift )  {
 int      i,is,j,k,m,n,cmax;
 char     SV[256];
 realtype Res;
@@ -1810,13 +1818,13 @@
 
 pstr FileError ( int ErrCode )  {
   switch (ErrCode)  {
-    case 0                          : return pstr("Ok");
-    case FileError_NoMemory         : return pstr("Insufficient memory");
-    case FileError_NoDataFound      : return pstr("No data found");
-    case FileError_NoColumn         : return pstr("No column structure");
-    case FileError_BadData          : return pstr("Incorrect data format");
+    case 0                      : return pstr("Ok");
+    case FileError_NoMemory     : return pstr("Insufficient memory");
+    case FileError_NoDataFound  : return pstr("No data found");
+    case FileError_NoColumn     : return pstr("No column structure");
+    case FileError_BadData      : return pstr("Incorrect data format");
     case FileError_WrongMemoryAllocation
-                                    : return pstr("Wrong Memory Allocation");
+                              : return pstr("Wrong Memory Allocation");
     default : return pstr("Unknown I/O error");
   }
 }
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/file_.h ccp4-onlylibs-dev/lib/src/mmdb/file_.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/file_.h	2006-08-16 03:55:13.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/file_.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: file_.h,v 1.15 2006/08/16 10:55:13 fr45 Exp $
+//  $Id: file_.h,v 1.14 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/linalg_.cpp ccp4-onlylibs-dev/lib/src/mmdb/linalg_.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/linalg_.cpp	2006-08-16 03:55:13.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/linalg_.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: linalg_.cpp,v 1.13 2006/08/16 10:55:13 fr45 Exp $
+//  $Id: linalg_.cpp,v 1.6 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/linalg_.h ccp4-onlylibs-dev/lib/src/mmdb/linalg_.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/linalg_.h	2006-08-16 03:55:14.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/linalg_.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: linalg_.h,v 1.13 2006/08/16 10:55:14 fr45 Exp $
+//  $Id: linalg_.h,v 1.8 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/machine_.cpp ccp4-onlylibs-dev/lib/src/mmdb/machine_.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/machine_.cpp	2006-08-16 03:55:14.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/machine_.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: machine_.cpp,v 1.12 2006/08/16 10:55:14 fr45 Exp $
+//  $Id: machine_.cpp,v 1.4 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/machine_.h ccp4-onlylibs-dev/lib/src/mmdb/machine_.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/machine_.h	2006-08-16 06:18:17.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/machine_.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: machine_.h,v 1.19 2006/08/16 13:18:17 fr45 Exp $
+//  $Id: machine_.h,v 1.5 2007/04/04 13:59:58 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -46,7 +46,7 @@
 */
 
 
-//  ===================  List of known machines  ========================
+//  ==================  List of known machines  ========================
 
 #define  MACHINE_SGI         1
 #define  MACHINE_RS6000      2
@@ -118,12 +118,8 @@
 # define CALL_LIKE_VMS  1
 
 // MVS stands for Microsoft Visual Studio
-#elif defined(_MSC_VER)
-# if (_MSC_VER) >= 800
-# define CALL_LIKE_MVS  2
-# else
+#elif defined(_MVS) 
 # define CALL_LIKE_MVS  1
-# endif
 
 #elif defined(F2C) || defined(G77)
 # define CALL_LIKE_SUN  8
@@ -139,7 +135,7 @@
 
 
 
-//  =================  Machine-dependent definitions  ===================
+//  =================  Machine-dependent definitions  ==================
 
 #ifdef CALL_LIKE_STARDENT
   // SStrParam is used in Ardent-like machines' fortran calls
@@ -395,36 +391,6 @@
 
 #elif defined(CALL_LIKE_MVS)
 
-# if ( CALL_LIKE_MVS == 2 )
-
-  typedef pstr fpstr;
-
-# define FTN_STR(s)  s
-# define FTN_LEN(s)  s##_len
-
-# define char_struct(s)           \
-    pstr  s;                      \
-    int   s##_len;
-# define fill_char_struct(s,str)  \
-    s  = str;                     \
-    s##_len = strlen(str);
-
-# ifdef __cplusplus
-#   define FORTRAN_SUBR(NAME,name,p_sun,p_stardent,p_mvs) \
-    extern "C" void NAME p_sun
-# else
-#   define FORTRAN_SUBR(NAME,name,p_sun,p_stardent,p_mvs) \
-    void NAME p_sun
-# endif
-
-# define FORTRAN_EXTERN(NAME,name,p_sun,p_stardent,p_mvs) \
-    extern "C" void NAME p_sun
-
-# define FORTRAN_CALL(NAME,name,p_sun,p_stardent,p_mvs) \
-    NAME p_sun
-
-# else 
-
   typedef pstr fpstr;
 
 # define FTN_STR(s)  s
@@ -450,7 +416,7 @@
 
 # define FORTRAN_CALL(NAME,name,p_sun,p_stardent,p_mvs) \
     NAME p_mvs
-# endif
+
 #else
 
 # error  Unknown machine!!!
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/math_.cpp ccp4-onlylibs-dev/lib/src/mmdb/math_.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/math_.cpp	2006-08-16 03:55:14.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/math_.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: math_.cpp,v 1.12 2006/08/16 10:55:14 fr45 Exp $
+//  $Id: math_.cpp,v 1.5 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/math_.h ccp4-onlylibs-dev/lib/src/mmdb/math_.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/math_.h	2006-08-16 03:55:14.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/math_.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: math_.h,v 1.12 2006/08/16 10:55:14 fr45 Exp $
+//  $Id: math_.h,v 1.5 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mattype_.cpp ccp4-onlylibs-dev/lib/src/mmdb/mattype_.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mattype_.cpp	2006-08-16 03:55:14.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mattype_.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mattype_.cpp,v 1.17 2006/08/16 10:55:14 fr45 Exp $
+//  $Id: mattype_.cpp,v 1.11 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mattype_.h ccp4-onlylibs-dev/lib/src/mmdb/mattype_.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mattype_.h	2006-08-16 06:03:36.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mattype_.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mattype_.h,v 1.17 2006/08/16 13:03:36 fr45 Exp $
+//  $Id: mattype_.h,v 1.9 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -87,7 +87,7 @@
 #define   strchr    FirstOccurence
 #define   fstrchr   FirstOccurence
 
-#ifdef _MSC_VER
+#ifdef _MVS
 #define   strncasecmp _strnicmp
 #define   strcasecmp  _stricmp
 #define   strlen      (int)strlen
@@ -292,20 +292,27 @@
 //         the same as those at allocation !
 //        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
-extern  void FreeMatrix3Memory ( rmatrix3  & A,  word N, word M,
-                             word ShiftN=1, word ShiftM=1, word ShiftK=1 );
-extern  void FreeMatrix3Memory ( imatrix3  & A,  word N, word M,
-                             word ShiftN=1, word ShiftM=1, word ShiftK=1 );
-extern  void FreeMatrix3Memory ( wmatrix3  & A,  word N, word M,
-                             word ShiftN=1, word ShiftM=1, word ShiftK=1 );
-extern  void FreeMatrix3Memory ( bmatrix3  & A,  word N, word M,
-                             word ShiftN=1, word ShiftM=1, word ShiftK=1 );
-extern  void FreeMatrix3Memory ( lmatrix3  & A,  word N, word M,
-                             word ShiftN=1, word ShiftM=1, word ShiftK=1 );
-extern  void FreeMatrix3Memory ( lwmatrix3 & A,  word N, word M,
-                             word ShiftN=1, word ShiftM=1, word ShiftK=1 );
-extern  void FreeMatrix3Memory ( psmatrix3 & A,  word N, word M,
-                             word ShiftN=1, word ShiftM=1, word ShiftK=1 );
+extern void FreeMatrix3Memory
+               ( rmatrix3  & A, word N, word M,
+                 word ShiftN=1, word ShiftM=1, word ShiftK=1 );
+extern void FreeMatrix3Memory
+               ( imatrix3  & A, word N, word M,
+                 word ShiftN=1, word ShiftM=1, word ShiftK=1 );
+extern void FreeMatrix3Memory
+               ( wmatrix3  & A, word N, word M,
+                 word ShiftN=1, word ShiftM=1, word ShiftK=1 );
+extern void FreeMatrix3Memory
+               ( bmatrix3  & A, word N, word M,
+                 word ShiftN=1, word ShiftM=1, word ShiftK=1 );
+extern void FreeMatrix3Memory
+               ( lmatrix3  & A, word N, word M,
+                 word ShiftN=1, word ShiftM=1, word ShiftK=1 );
+extern void FreeMatrix3Memory
+               ( lwmatrix3 & A, word N, word M,
+                 word ShiftN=1, word ShiftM=1, word ShiftK=1 );
+extern void FreeMatrix3Memory
+               ( psmatrix3 & A, word N, word M,
+                 word ShiftN=1, word ShiftM=1, word ShiftK=1 );
 
 // -------------------------------------------------------------
 
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_align.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_align.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_align.cpp	2006-08-16 03:55:15.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_align.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_align.cpp,v 1.13 2006/08/16 10:55:15 fr45 Exp $
+//  $Id: mmdb_align.cpp,v 1.8 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_align.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_align.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_align.h	2006-08-16 03:55:15.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_align.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_align.h,v 1.13 2006/08/16 10:55:15 fr45 Exp $
+//  $Id: mmdb_align.h,v 1.6 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_atom.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_atom.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_atom.cpp	2006-08-16 03:55:15.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_atom.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_atom.cpp,v 1.17 2006/08/16 10:55:15 fr45 Exp $
+//  $Id: mmdb_atom.cpp,v 1.22 2007/08/15 10:59:31 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -633,7 +633,8 @@
 
   WhatIsSet |= ASET_Anis_tFac;
 
-  if (WhatIsSet & (ASET_Coordinates | ASET_CoordSigma | ASET_Anis_tFSigma))  
+  if (WhatIsSet & (ASET_Coordinates | ASET_CoordSigma |
+                   ASET_Anis_tFSigma))  
     // something was already submitted. check complience
     return CheckData ( S );
   else  
@@ -1727,7 +1728,7 @@
 
 
 
-//  ============================  CResidue  ============================
+//  ===========================  CResidue  ===========================
 
 
 void  SAtomStat::Init()  {
@@ -2279,8 +2280,10 @@
 
 }
 
-void  CResidue::_copy ( PCResidue res, PPCAtom atm, int & atom_index )  {
-//  modify both CResidue::_copy and CResidue::Copy methods simultaneously!
+void  CResidue::_copy ( PCResidue res, PPCAtom atm,
+                        int & atom_index )  {
+//  modify both CResidue::_copy and CResidue::Copy methods
+// simultaneously!
 //
 //  This function physically copies the atoms, creating new atom
 // instances and putting them into array 'atm' sequentially from
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_atom.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_atom.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_atom.h	2006-08-16 03:55:15.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_atom.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_atom.h,v 1.16 2006/08/16 10:55:15 fr45 Exp $
+//  $Id: mmdb_atom.h,v 1.15 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_bondmngr.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_bondmngr.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_bondmngr.cpp	2006-08-16 03:55:15.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_bondmngr.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_bondmngr.cpp,v 1.12 2006/08/16 10:55:15 fr45 Exp $
+//  $Id: mmdb_bondmngr.cpp,v 1.6 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_bondmngr.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_bondmngr.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_bondmngr.h	2006-08-16 03:55:15.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_bondmngr.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_bondmngr.h,v 1.12 2006/08/16 10:55:15 fr45 Exp $
+//  $Id: mmdb_bondmngr.h,v 1.4 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_chain.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_chain.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_chain.cpp	2007-07-09 08:39:28.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_chain.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_chain.cpp,v 1.16 2007/07/09 15:39:28 ccb Exp $
+//  $Id: mmdb_chain.cpp,v 1.14 2007/05/18 13:50:51 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_chain.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_chain.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_chain.h	2006-08-16 03:55:16.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_chain.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_chain.h,v 1.14 2006/08/16 10:55:16 fr45 Exp $
+//  $Id: mmdb_chain.h,v 1.10 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -21,15 +21,15 @@
 //       ~~~~~~~~~
 //  **** Project :  MacroMolecular Data Base (MMDB)
 //       ~~~~~~~~~
-//  **** Classes :  CProModel       ( a virtue of CModel               )
-//       ~~~~~~~~~  CChainContainer ( container of in-chain classes    )
-//                  CContainerChain ( chain containered class template )
-//                  CDBReference    ( DBREF  records                   )
-//                  CSeqAdv         ( SEQADV records                   )
-//                  CSeqRes         ( SEQRES records                   )
-//                  CModRes         ( MODRES records                   )
-//                  CHetRec         ( HET    records                   )
-//                  CChain          ( chain class                      )
+//  **** Classes :  CProModel       ( a virtue of CModel              )
+//       ~~~~~~~~~  CChainContainer ( container of in-chain classes   )
+//                  CContainerChain ( chain containered class template)
+//                  CDBReference    ( DBREF  records                  )
+//                  CSeqAdv         ( SEQADV records                  )
+//                  CSeqRes         ( SEQRES records                  )
+//                  CModRes         ( MODRES records                  )
+//                  CHetRec         ( HET    records                  )
+//                  CChain          ( chain class                     )
 //
 //  Copyright (C) E. Krissinel 2001-2004
 //
@@ -86,8 +86,11 @@
 
     //  GetNumberOfModels() returns TOTAL number of models
     virtual int GetNumberOfModels() { return 0;    }
-    //  GetNumberOfAllAtoms() returns TOTAL number of atoms in all models
+
+    //  GetNumberOfAllAtoms() returns TOTAL number of atoms in
+    // all models
     virtual int GetNumberOfAllAtoms() { return 0;    }
+
     //  returns pointer to the general Atom array
     virtual PPCAtom     GetAllAtoms() { return NULL; }
 
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_cifdefs.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_cifdefs.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_cifdefs.cpp	2006-08-16 03:55:16.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_cifdefs.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_cifdefs.cpp,v 1.12 2006/08/16 10:55:16 fr45 Exp $
+//  $Id: mmdb_cifdefs.cpp,v 1.4 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_cifdefs.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_cifdefs.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_cifdefs.h	2007-07-09 08:40:17.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_cifdefs.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_cifdefs.h,v 1.13 2007/07/09 15:40:17 ccb Exp $
+//  $Id: mmdb_cifdefs.h,v 1.5 2007/05/18 13:50:51 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_coormngr.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_coormngr.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_coormngr.cpp	2006-08-16 03:55:16.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_coormngr.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_coormngr.cpp,v 1.18 2006/08/16 10:55:16 fr45 Exp $
+//  $Id: mmdb_coormngr.cpp,v 1.22 2007/08/15 10:59:31 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -13,7 +13,7 @@
 //
 //  =================================================================
 //
-//    08.03.06   <--  Date of Last Modification.
+//    29.05.07   <--  Date of Last Modification.
 //                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 //  -----------------------------------------------------------------
 //
@@ -25,7 +25,7 @@
 //       ~~~~~~~~~  CMBrick          ( "multiple" space brick       )
 //                  CMMDBCoorManager ( MMDB atom coordinate manager )
 //
-//  Copyright (C) E. Krissinel 2001-2006
+//  Copyright (C) E. Krissinel 2001-2007
 //
 //  =================================================================
 //
@@ -580,6 +580,25 @@
   return DefPath.SetPath ( CID );
 }
 
+PCModel CMMDBCoorManager::GetFirstDefinedModel()  {
+PCModel mdl;
+int     i;
+  mdl = NULL;
+  for (i=0;(i<nModels) && (!mdl);i++)
+    mdl = Model[i];
+  return mdl;
+}
+
+int CMMDBCoorManager::GetFirstModelNum()  {
+PCModel mdl;
+int     i;
+  mdl = NULL;
+  for (i=0;(i<nModels) && (!mdl);i++)
+    mdl = Model[i];
+  if (mdl)  return mdl->GetSerNum();
+  return 1;
+}
+
 
 PCModel CMMDBCoorManager::GetModel ( int modelNo )  {
   if ((modelNo>=1) && (modelNo<=nModels))
@@ -4119,7 +4138,6 @@
       V[j][k] = -V[j][k];
   }
 
-
   //  4.3 Calculate rotational part of T
 
   for (j=1;j<=3;j++)
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_coormngr.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_coormngr.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_coormngr.h	2006-08-16 03:55:16.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_coormngr.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_coormngr.h,v 1.18 2006/08/16 10:55:16 fr45 Exp $
+//  $Id: mmdb_coormngr.h,v 1.17 2007/08/15 10:59:31 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -13,7 +13,7 @@
 //
 //  =================================================================
 //
-//    26.11.03   <--  Date of Last Modification.
+//    29.05.07   <--  Date of Last Modification.
 //                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 //  -----------------------------------------------------------------
 //
@@ -24,7 +24,7 @@
 //  **** Classes :  CBrick           ( space brick                  )
 //       ~~~~~~~~~  CMMDBCoorManager ( MMDB atom coordinate manager )
 //
-//  E. Krissinel 2001-2003
+//  (C) E. Krissinel 2001-2007
 //
 //  =================================================================
 //
@@ -243,6 +243,8 @@
     //  ----------------  Extracting models  ---------------------
 
     int GetNumberOfModels ()  { return nModels; }
+    int  GetFirstModelNum ();
+    PCModel GetFirstDefinedModel();
     PCModel      GetModel ( int   modelNo  );  // 1<=modelNo<=nModels
     PCModel      GetModel ( const pstr CID );
     void    GetModelTable ( PPCModel & modTable,
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_cryst.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_cryst.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_cryst.cpp	2007-07-09 08:40:57.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_cryst.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_cryst.cpp,v 1.18 2007/07/09 15:40:57 ccb Exp $
+//  $Id: mmdb_cryst.cpp,v 1.23 2007/01/08 16:42:41 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_cryst.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_cryst.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_cryst.h	2007-07-09 08:41:12.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_cryst.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_cryst.h,v 1.17 2007/07/09 15:41:12 ccb Exp $
+//  $Id: mmdb_cryst.h,v 1.17 2007/01/08 16:42:41 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_defs.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_defs.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_defs.h	2007-07-09 08:41:42.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_defs.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_defs.h,v 1.16 2007/07/09 15:41:42 ccb Exp $
+//  $Id: mmdb_defs.h,v 1.10 2007/05/18 13:50:51 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -13,7 +13,7 @@
 //
 //  =================================================================
 //
-//    11.05.07   <--  Date of Last Modification.
+//    10.09.07   <--  Date of Last Modification.
 //                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 //  -----------------------------------------------------------------
 //
@@ -221,7 +221,7 @@
 #define  ClassID_Helix             19
 #define  ClassID_Turn              20
 #define  ClassID_Link              21
-
+#define  ClassID_CisPep            22
 
 
 //  =====================  classes  ===============================
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_ficif.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_ficif.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_ficif.cpp	2006-08-16 03:55:17.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_ficif.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_ficif.cpp,v 1.12 2006/08/16 10:55:17 fr45 Exp $
+//  $Id: mmdb_ficif.cpp,v 1.5 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_ficif.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_ficif.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_ficif.h	2006-08-16 03:55:17.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_ficif.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_ficif.h,v 1.12 2006/08/16 10:55:17 fr45 Exp $
+//  $Id: mmdb_ficif.h,v 1.4 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_file.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_file.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_file.cpp	2007-07-09 08:42:22.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_file.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_file.cpp,v 1.22 2007/07/09 15:42:22 ccb Exp $
+//  $Id: mmdb_file.cpp,v 1.27 2007/05/18 13:50:51 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -238,7 +238,7 @@
 int  CMMDBFile::ReadPDBASCII ( RCFile f )  {
 PCContString ContString;
 word         cleanKey;
-int          RC;
+int          RC,modNum;
 Boolean      fixSpaceGroup,fend;
 
   //  remove previous data
@@ -325,7 +325,13 @@
          strncmp(S,"ENDMDL",6))  {
     if (!strncmp(S,"LINK  ",6))
       crModel->ConvertPDBString(S);
-    else  {
+    else if (!strncmp(S,"CISPEP",6)) {
+      GetInteger ( modNum,&(S[43]),3 );
+      if (modNum<=0)  modNum = 1;
+      if (modNum!=1)  SwitchModel ( modNum );
+      crModel->ConvertPDBString(S);
+      if (modNum!=1)  SwitchModel ( 1 );
+    } else  {
       ContString = new CContString(S);
       SA.AddData ( ContString );
     }
@@ -1784,11 +1790,13 @@
 
 
 int CMMDBFile::PutAtom ( int    index,  // same meaning as above
-                         PCAtom A,      // pointer to completed atom class
-                         int    serNum  // 0 means that the serial number
-                                        // will be set equal to index.
-                                        // Otherwise the serial number
-                                        // is set to the specified value
+                         PCAtom A,      // pointer to completed atom
+                                        // class
+                         int    serNum  // 0 means that the serial
+                                        // number will be set equal
+                                        // to "index". Otherwise,
+                                        // the serial number is set
+                                        // to the specified value
                        )  {
 int i,kndex,RC,sn;
 
@@ -2264,6 +2272,11 @@
   if (i<nModels)
     Model[i]->PDBASCIIDumpPS ( f );
 
+  // output cispep records
+  for (i=0;i<nModels;i++)
+    if (Model[i])
+      Model[i]->PDBASCIIDumpCP ( f );
+
   SA      .PDBASCIIDump ( f );
   Footnote.PDBASCIIDump ( f );
   Cryst   .PDBASCIIDump ( f );
@@ -2273,7 +2286,7 @@
     if (Model[i])
       Model[i]->PDBASCIIDump ( f );
 
-  SC   .PDBASCIIDump ( f );
+  SC.PDBASCIIDump ( f );
 
   f.WriteLine ( pstr("END") );
 
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_file.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_file.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_file.h	2007-07-09 08:42:32.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_file.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_file.h,v 1.19 2007/07/09 15:42:32 ccb Exp $
+//  $Id: mmdb_file.h,v 1.22 2007/03/30 17:08:04 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_graph.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_graph.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_graph.cpp	2007-07-09 08:42:51.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_graph.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_graph.cpp,v 1.16 2007/07/09 15:42:51 ccb Exp $
+//  $Id: mmdb_graph.cpp,v 1.17 2007/08/15 10:59:32 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -700,7 +700,7 @@
     e1--;
     for (j=i+1;j<nVertices;j++)  {
       a2 = Vertex[j]->id;
-      e2 = Vertex[i]->type;
+      e2 = Vertex[j]->type;
       if (e2>nElementNames)  e2 = 6;
       e2--;
       dx = R->atom[a2]->x - R->atom[a1]->x;
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_graph.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_graph.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_graph.h	2007-07-09 08:43:11.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_graph.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_graph.h,v 1.15 2007/07/09 15:43:11 ccb Exp $
+//  $Id: mmdb_graph.h,v 1.13 2007/04/04 13:59:58 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_manager.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_manager.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_manager.cpp	2007-07-09 08:43:24.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_manager.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_manager.cpp,v 1.15 2007/07/09 15:43:24 ccb Exp $
+//  $Id: mmdb_manager.cpp,v 1.9 2007/05/18 13:50:51 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_manager.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_manager.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_manager.h	2007-07-09 08:43:48.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_manager.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_manager.h,v 1.14 2007/07/09 15:43:48 ccb Exp $
+//  $Id: mmdb_manager.h,v 1.6 2007/05/18 13:50:51 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_mask.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_mask.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_mask.cpp	2006-08-16 03:55:18.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_mask.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_mask.cpp,v 1.12 2006/08/16 10:55:18 fr45 Exp $
+//  $Id: mmdb_mask.cpp,v 1.5 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_mask.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_mask.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_mask.h	2006-08-16 03:55:19.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_mask.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_mask.h,v 1.12 2006/08/16 10:55:19 fr45 Exp $
+//  $Id: mmdb_mask.h,v 1.4 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_mmcif.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_mmcif.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_mmcif.cpp	2006-08-16 03:55:19.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_mmcif.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_mmcif.cpp,v 1.14 2006/08/16 10:55:19 fr45 Exp $
+//  $Id: mmdb_mmcif.cpp,v 1.10 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_mmcif.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_mmcif.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_mmcif.h	2006-08-16 03:55:19.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_mmcif.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_mmcif.h,v 1.13 2006/08/16 10:55:19 fr45 Exp $
+//  $Id: mmdb_mmcif.h,v 1.8 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_model.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_model.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_model.cpp	2007-07-09 08:44:09.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_model.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_model.cpp,v 1.16 2007/07/09 15:44:09 ccb Exp $
+//  $Id: mmdb_model.cpp,v 1.16 2007/05/18 13:50:51 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -13,7 +13,7 @@
 //
 //  =================================================================
 //
-//    14.05.07   <--  Date of Last Modification.
+//    10.09.07   <--  Date of Last Modification.
 //                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 //  -----------------------------------------------------------------
 //
@@ -29,8 +29,10 @@
 //                  CSheet        ( sheet info                      )
 //                  CSheets       ( container for sheets            )
 //                  CTurn         ( turn info                       )
-//                  CLinkContainer ( container for link data        )
-//                  CLink         ( link data                       )
+//                  CLinkContainer   ( container for link data      )
+//                  CLink            ( link data                    )
+//                  CCisPepContainer ( container for CisPep data    )
+//                  CCisPep          ( CisPep data                  )
 //                  CModel        ( PDB model                       )
 //
 //  Copyright (C) E. Krissinel 2000-2007
@@ -2040,6 +2042,7 @@
 MakeStreamFunctions(CLinkContainer)
 
 
+
 //  ========================  CLink  ===========================
 
 CLink::CLink() : CContainerClass()  {
@@ -2380,6 +2383,158 @@
 MakeStreamFunctions(CLink)
 
 
+//  ===================  CCisPepContainer  ======================
+
+PCContainerClass CCisPepContainer::MakeContainerClass ( int ClassID ) {
+  switch (ClassID)  {
+    default :
+    case ClassID_Template : return
+                        CClassContainer::MakeContainerClass(ClassID);
+    case ClassID_CisPep   : return new CCisPep();
+  }
+}
+
+MakeStreamFunctions(CCisPepContainer)
+
+
+//  ========================  CCisPep  ==========================
+
+CCisPep::CCisPep() : CContainerClass()  {
+  InitCisPep();
+}
+
+CCisPep::CCisPep ( const pstr S ) : CContainerClass()  {
+  InitCisPep();
+  ConvertPDBASCII ( S );
+}
+
+CCisPep::CCisPep ( RPCStream Object ) : CContainerClass(Object)  {
+  InitCisPep();
+}
+
+CCisPep::~CCisPep() {}
+
+void CCisPep::InitCisPep()  {
+  serNum  = 1;                //  record serial number
+  strcpy ( pep1    ,"---" );  //  residue name
+  strcpy ( chainID1," "   );  //  chain identifier 1
+  seqNum1 = 0;                //  residue sequence number 1
+  strcpy ( icode1  ," "   );  //  insertion code 1
+  strcpy ( pep2    ,"---" );  //  residue name 2
+  strcpy ( chainID2," "   );  //  chain identifier 2
+  seqNum2 = 0;                //  residue sequence number 2
+  strcpy ( icode2  ," "   );  //  insertion code 2
+  modNum  = 0;                //  model number
+  measure = 0.0;              //  measure of the angle in degrees.
+}
+
+void  CCisPep::PDBASCIIDump ( pstr S, int N )  {
+
+  strcpy     ( S,"CISPEP" );
+  PadSpaces  ( S,80 );
+
+  PutInteger ( &(S[7]),serNum,3 );
+
+  strcpy_n1  ( &(S[11]),pep1    ,3 );
+  strcpy_n1  ( &(S[15]),chainID1,1 );
+  PutIntIns  ( &(S[17]),seqNum1 ,4,icode1 );
+
+  strcpy_n1  ( &(S[25]),pep2    ,3 );
+  strcpy_n1  ( &(S[29]),chainID2,1 );
+  PutIntIns  ( &(S[31]),seqNum2 ,4,icode1 );
+
+  PutInteger ( &(S[43]),modNum,3 );
+  PutRealF   ( &(S[53]),measure,6,2 );
+
+}
+
+
+int CCisPep::ConvertPDBASCII ( const pstr S )  {
+
+  GetInteger   ( serNum  ,&(S[7]) ,3 );
+
+  strcpy_ncss  ( pep1    ,&(S[11]),3 );
+  strcpy_ncss  ( chainID1,&(S[15]),1 );
+  GetIntIns    ( seqNum1,icode1,&(S[17]),4 ); 
+
+  strcpy_ncss  ( pep2    ,&(S[25]),3 );
+  strcpy_ncss  ( chainID2,&(S[29]),1 );
+  GetIntIns    ( seqNum2,icode2,&(S[31]),4 ); 
+
+  GetInteger   ( modNum  ,&(S[43]),3 );
+  GetReal      ( measure ,&(S[53]),6 );
+
+  return 0;
+
+}
+
+
+void  CCisPep::Copy ( PCContainerClass CisPep )  {
+
+  serNum  = PCCisPep(CisPep)->serNum;
+
+  strcpy ( pep1    ,PCCisPep(CisPep)->pep1     );
+  strcpy ( chainID1,PCCisPep(CisPep)->chainID1 );
+  seqNum1 = PCCisPep(CisPep)->seqNum1;
+  strcpy ( icode1  ,PCCisPep(CisPep)->icode1   );
+
+  strcpy ( pep2    ,PCCisPep(CisPep)->pep2     );
+  strcpy ( chainID2,PCCisPep(CisPep)->chainID2 );
+  seqNum2 = PCCisPep(CisPep)->seqNum2;
+  strcpy ( icode2  ,PCCisPep(CisPep)->icode2   );
+
+  modNum  = PCCisPep(CisPep)->modNum;
+  measure = PCCisPep(CisPep)->measure;
+
+}
+    
+void  CCisPep::write ( RCFile f )  {
+byte Version=1;
+
+  f.WriteByte    ( &Version   );
+
+  f.WriteInt     ( &serNum );
+
+  f.WriteTerLine ( pep1    ,False );
+  f.WriteTerLine ( chainID1,False );
+  f.WriteInt     ( &seqNum1 );
+  f.WriteTerLine ( icode1  ,False );
+
+  f.WriteTerLine ( pep2    ,False );
+  f.WriteTerLine ( chainID2,False );
+  f.WriteInt     ( &seqNum2 );
+  f.WriteTerLine ( icode2  ,False );
+
+  f.WriteInt     ( &modNum  );
+  f.WriteReal    ( &measure );
+
+}
+
+void  CCisPep::read ( RCFile f )  {
+byte Version;
+
+  f.ReadByte    ( &Version   );
+
+  f.ReadInt     ( &serNum );
+
+  f.ReadTerLine ( pep1    ,False );
+  f.ReadTerLine ( chainID1,False );
+  f.ReadInt     ( &seqNum1 );
+  f.ReadTerLine ( icode1  ,False );
+
+  f.ReadTerLine ( pep2    ,False );
+  f.ReadTerLine ( chainID2,False );
+  f.ReadInt     ( &seqNum2 );
+  f.ReadTerLine ( icode2  ,False );
+
+  f.ReadInt     ( &modNum  );
+  f.ReadReal    ( &measure );
+
+}
+
+MakeStreamFunctions(CCisPep)
+
+
 
 //  =====================   CModel   =======================
 
@@ -2422,6 +2577,7 @@
   RemoveSecStructure();
   RemoveHetInfo     ();
   RemoveLinks       ();
+  RemoveCisPeps     ();
 
 }
 
@@ -3482,6 +3638,7 @@
 PCHelix  helix;
 PCTurn   turn;
 PCLink   link;
+PCCisPep cispep;
 int      RC;
 
   //  pad input line with spaces, if necessary
@@ -3563,6 +3720,14 @@
           else  delete link;
     return RC;
 
+  } else if (!strncmp(PDBString,"CISPEP",6))  {
+
+    cispep = new CCisPep();
+    RC   = cispep->ConvertPDBASCII(PDBString);
+    if (RC==0)  CisPeps.AddData ( cispep );
+          else  delete cispep;
+    return RC;
+
   } else
     return Error_WrongSection;
 
@@ -3600,6 +3765,10 @@
 
 }
 
+void  CModel::PDBASCIIDumpCP ( RCFile f )  {
+  CisPeps.PDBASCIIDump ( f );
+}
+
 void  CModel::PDBASCIIDump ( RCFile f )  {
 char    S[100];
 int     i;
@@ -4205,6 +4374,24 @@
 }
 
 
+
+int  CModel::GetNumberOfCisPeps()  {
+  return  CisPeps.Length();
+}
+
+PCCisPep CModel::GetCisPep ( int CisPepNum )  {
+  return (PCCisPep)CisPeps.GetContainerClass ( CisPepNum-1 );
+}
+
+void  CModel::RemoveCisPeps()  {
+  CisPeps.FreeContainer();
+}
+
+void  CModel::AddCisPep ( PCCisPep CisPep )  {
+  CisPeps.AddData ( CisPep );
+}
+
+
 void  CModel::ApplyTransform ( mat44 & TMatrix )  {
 // transforms all coordinates by multiplying with matrix TMatrix
 int i;
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_model.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_model.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_model.h	2007-07-09 08:44:54.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_model.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_model.h,v 1.15 2007/07/09 15:44:54 ccb Exp $
+//  $Id: mmdb_model.h,v 1.10 2007/05/18 13:50:51 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -13,7 +13,7 @@
 //
 //  =================================================================
 //
-//    14.05.07   <--  Date of Last Modification.
+//    10.09.07   <--  Date of Last Modification.
 //                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 //  -----------------------------------------------------------------
 //
@@ -29,8 +29,10 @@
 //                  CSheet        ( sheet info                      )
 //                  CSheets       ( container for sheets            )
 //                  CTurn         ( turn info                       )
-//                  CLinkContainer ( container for link data        )
-//                  CLink         ( link data                       )
+//                  CLinkContainer   ( container for link data      )
+//                  CLink            ( link data                    )
+//                  CCisPepContainer ( container for CisPep data    )
+//                  CCisPep          ( CisPep data                  )
 //                  CModel        ( PDB model                       )
 //
 //  Copyright (C) E. Krissinel 2000-2007
@@ -381,6 +383,7 @@
 
 };
 
+
 //  ===================  CLinkContainer  =====================
 
 DefineClass(CLinkContainer)
@@ -446,6 +449,72 @@
 };
 
 
+
+//  ===================  CCisPepContainer  =====================
+
+DefineClass(CCisPepContainer)
+DefineStreamFunctions(CCisPepContainer)
+
+class CCisPepContainer : public CClassContainer  {
+
+  public :
+
+    CCisPepContainer  () : CClassContainer() {}
+    CCisPepContainer  ( RPCStream Object )
+                     : CClassContainer ( Object ) {} 
+    ~CCisPepContainer () {}
+
+    PCContainerClass MakeContainerClass ( int ClassID );
+
+};
+
+
+//  =====================  CCisPep  ===========================
+
+DefineClass(CCisPep)
+DefineStreamFunctions(CCisPep)
+
+class CCisPep : public CContainerClass  {
+
+  public :
+    int      serNum;   //  record serial number
+    ResName  pep1;     //  residue name
+    ChainID  chainID1; //  chain identifier 1
+    int      seqNum1;  //  residue sequence number 1
+    InsCode  icode1;   //  insertion code 1
+    ResName  pep2;     //  residue name 2
+    ChainID  chainID2; //  chain identifier 2
+    int      seqNum2;  //  residue sequence number 2
+    InsCode  icode2;   //  insertion code 2
+    int      modNum;   //  model number
+    realtype measure;  //  measure of the angle in degrees.
+
+    CCisPep ();
+    CCisPep ( const pstr S );
+    CCisPep ( RPCStream Object );
+    ~CCisPep();
+
+    void  PDBASCIIDump    ( pstr S, int N );
+    int   ConvertPDBASCII ( const pstr S );
+
+//    void  MakeCIF         ( PCMMCIFData CIF, int N );
+//    void  GetCIF          ( PCMMCIFData CIF, int & Signal );
+
+    int   GetClassID      () { return ClassID_CisPep; }
+
+    void  Copy  ( PCContainerClass CisPep );
+
+    void  write ( RCFile f );
+    void  read  ( RCFile f );
+
+  protected :
+
+    void InitCisPep();
+
+};
+
+
+
 //  ====================  CModel  ===============================
 
 #define  SSERC_Ok            0
@@ -714,9 +783,13 @@
     int   ConvertPDBString ( pstr PDBString );
 
     // PDBASCIIDumpPS(..) makes output of PDB primary structure records
+    // excluding cispeps
     void  PDBASCIIDumpPS   ( RCFile f );
 
-    // PDBASCIIDumpPS(..) makes output of PDB coordinate (ATOM etc.)
+    // PDBASCIIDumpCP(..) makes output of cispep records
+    void  PDBASCIIDumpCP   ( RCFile f );
+
+    // PDBASCIIDump(..) makes output of PDB coordinate (ATOM etc.)
     // records
     void  PDBASCIIDump     ( RCFile f );
 
@@ -789,14 +862,24 @@
     void  RemoveHetInfo     ();
 
 
-    //  ----  Getting Links
+    //  ----  Working Links
 
     int    GetNumberOfLinks ();
     PCLink          GetLink ( int serialNum ); // 1<=serNum<=NofLinks
     PCLinkContainer GetLinks() { return &Links; }
 
-    void   RemoveLinks      ();
-    void   AddLink ( PCLink Link );
+    void   RemoveLinks();
+    void   AddLink    ( PCLink Link );
+
+
+    //  ----  Working CisPeps
+
+    int       GetNumberOfCisPeps();
+    PCCisPep          GetCisPep ( int CisPepNum );
+    PCCisPepContainer GetCisPeps() { return &CisPeps; }
+
+    void  RemoveCisPeps();
+    void  AddCisPep    ( PCCisPep CisPep );
 
 
 
@@ -825,20 +908,21 @@
 
   protected :
 
-    int             serNum;       // the model serial number
-    PCMMDBManager   manager;      // pointer to mmdbmanager class
+    int              serNum;       // the model serial number
+    PCMMDBManager    manager;      // pointer to mmdbmanager class
 
-    CHetCompounds   HetCompounds; // information on heterocompounds
-    CSSContainer    Helices;      // information on helices
-    CSheets         Sheets;       // information on sheets
-    CSSContainer    Turns;        // information on turns
-    CLinkContainer  Links;        // information on links
-
-    int             nChains;      // number of chains
-    int             nChainsAlloc; // actual length of Chain[]
-    PPCChain        Chain;        // array of chains
+    CHetCompounds    HetCompounds; // information on heterocompounds
+    CSSContainer     Helices;      // information on helices
+    CSheets          Sheets;       // information on sheets
+    CSSContainer     Turns;        // information on turns
+    CLinkContainer   Links;        // information on links
+    CCisPepContainer CisPeps;      // information on cispeps
+
+    int              nChains;      // number of chains
+    int              nChainsAlloc; // actual length of Chain[]
+    PPCChain         Chain;        // array of chains
 
-    Boolean         Exclude;      // used internally
+    Boolean          Exclude;      // used internally
 
     void  InitModel        ();
     void  FreeMemory       ();
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_rwbrook.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_rwbrook.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_rwbrook.cpp	2007-10-15 03:45:54.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_rwbrook.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_rwbrook.cpp,v 1.35 2007/10/15 10:45:54 nds65 Exp $
+//  $Id: mmdb_rwbrook.cpp,v 1.15 2006/07/28 10:57:23 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -1469,6 +1469,7 @@
 SegID    sgID;
 Element  element;
 PCAtom   atom;
+pstr     p;
 char     charge[10];
 
   strcpy ( LastFunc,"MMDB_F_Atom" );
@@ -1544,7 +1545,7 @@
 
     if (FTN_STR(ID)[0]==' ')  {
       atomName[0] = char(0);
-      if ((FTN_STR(AtNam)[1]=='H') && (FTN_STR(AtNam)[0]!='H') ||
+      if ((FTN_STR(AtNam)[1]=='H') ||
           ((FTN_STR(AtNam)[1]=='D') && (FTN_STR(ID)[2]=='D')))  {
         i = 0;
         while ((i<nHydAtomNames) && 
@@ -1552,12 +1553,7 @@
         if (i<nHydAtomNames)
           GetStrTer ( atomName,FTN_STR(AtNam),4,5,FTN_LEN(AtNam) );
       }
-
-      if ((FTN_STR(AtNam)[0]=='A') || ((FTN_STR(AtNam)[0]=='N') && (FTN_STR(ID)[1]!='N'))) {
-        GetStrTer ( atomName,FTN_STR(AtNam),4,5,FTN_LEN(AtNam) );
-      } else if ((FTN_STR(ID)[1]=='N') && ( (FTN_STR(AtNam)[0]=='N') && (FTN_STR(AtNam)[1]=='N') )) {
-        GetStrTer ( atomName,FTN_STR(AtNam),4,5,FTN_LEN(AtNam) );
-      } else if (!atomName[0])  {
+      if (!atomName[0])  {
         atomName[0] = ' ';
         GetStrTer ( &(atomName[1]),FTN_STR(AtNam),3,4,FTN_LEN(AtNam) );
       }
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_rwbrook.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_rwbrook.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_rwbrook.h	2006-08-16 03:55:20.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_rwbrook.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_rwbrook.h,v 1.12 2006/08/16 10:55:20 fr45 Exp $
+//  $Id: mmdb_rwbrook.h,v 1.4 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_sbase.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_sbase.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_sbase.cpp	2006-08-16 03:55:20.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_sbase.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_sbase.cpp,v 1.15 2006/08/16 10:55:20 fr45 Exp $
+//  $Id: mmdb_sbase.cpp,v 1.11 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_sbase.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_sbase.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_sbase.h	2006-08-16 03:55:20.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_sbase.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_sbase.h,v 1.14 2006/08/16 10:55:20 fr45 Exp $
+//  $Id: mmdb_sbase.h,v 1.9 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_sbase0.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_sbase0.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_sbase0.cpp	2007-07-09 08:45:24.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_sbase0.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,10 +1,10 @@
-//  $Id: mmdb_sbase0.cpp,v 1.9 2007/07/09 15:45:24 ccb Exp $
+//  $Id: mmdb_sbase0.cpp,v 1.7 2007/08/15 10:59:32 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
 //   functionality in protein crystallography applications.
 //
-//   Copyright (C) Eugene Krissinel 2000-2006.
+//   Copyright (C) Eugene Krissinel 2000-2007.
 //
 //   This code is distributed under the terms and conditions of the
 //   CCP4 Program Suite Licence Agreement as a CCP4 Library.
@@ -13,7 +13,7 @@
 //
 //  =================================================================
 //
-//    24.02.06   <--  Date of Last Modification.
+//    14.08.07   <--  Date of Last Modification.
 //                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 //  -----------------------------------------------------------------
 //
@@ -25,7 +25,7 @@
 //                  CSBStructure ( SB structure (monomer) class )
 //                  CSBIndex     ( SB index class               )
 //
-//    E. Krissinel 2001-2006
+//    (C) E. Krissinel 2001-2007
 //
 //  =================================================================
 //
@@ -66,33 +66,35 @@
 CSBAtom::~CSBAtom() {}
 
 void CSBAtom::SBAtomInit()  {
-  sca_name  [0]  = char(0);
-  pdb_name  [0]  = char(0);
-  element   [0]  = char(0);
-  energyType[0]  = char(0);
-  x              = -MaxReal;
-  y              = -MaxReal;
-  z              = -MaxReal;
-  x_esd          = 0.0;
-  y_esd          = 0.0;
-  z_esd          = 0.0;
-  ccp4_charge    = 0.0;  // atom charge from ccp4 libs
-  sca_charge     = 0.0;  // formal atom charge (MSD)
-  partial_charge = 0.0;  // partial atom charge (MSD)
-  vdw_radius     = 0.0;
-  vdwh_radius    = 0.0;
-  ion_radius     = 0.0;
-  valency        = 0;
-  chirality      = 'N';
-  leaving        = 'N';
-  hb_type        = 'N';
+  sca_name    [0] = char(0);
+  pdb_name    [0] = char(0);
+  old_pdb_name[0] = char(0);
+  element     [0] = char(0);
+  energyType  [0] = char(0);
+  x               = -MaxReal;
+  y               = -MaxReal;
+  z               = -MaxReal;
+  x_esd           = 0.0;
+  y_esd           = 0.0;
+  z_esd           = 0.0;
+  ccp4_charge     = 0.0;  // atom charge from ccp4 libs
+  sca_charge      = 0.0;  // formal atom charge (MSD)
+  partial_charge  = 0.0;  // partial atom charge (MSD)
+  vdw_radius      = 0.0;
+  vdwh_radius     = 0.0;
+  ion_radius      = 0.0;
+  valency         = 0;
+  chirality       = 'N';
+  leaving         = 'N';
+  hb_type         = 'N';
 }
 
 void CSBAtom::Copy ( PCSBAtom A )  {
-  strcpy ( sca_name  ,A->sca_name   );
-  strcpy ( pdb_name  ,A->pdb_name   );
-  strcpy ( element   ,A->element    );
-  strcpy ( energyType,A->energyType );
+  strcpy ( sca_name    ,A->sca_name     );
+  strcpy ( pdb_name    ,A->pdb_name     );
+  strcpy ( old_pdb_name,A->old_pdb_name );
+  strcpy ( element     ,A->element      );
+  strcpy ( energyType  ,A->energyType   );
   x              = A->x;
   y              = A->y;
   z              = A->z;
@@ -133,12 +135,13 @@
 
 
 void CSBAtom::write ( RCFile f )  {
-int Version=4;
+int Version=5;
   f.WriteInt  ( &Version                      );
-  f.WriteFile ( sca_name  ,sizeof(sca_name)   );
-  f.WriteFile ( pdb_name  ,sizeof(pdb_name)   );
-  f.WriteFile ( element   ,sizeof(element)    );
-  f.WriteFile ( energyType,sizeof(energyType) );
+  f.WriteFile ( sca_name    ,sizeof(sca_name)     );
+  f.WriteFile ( pdb_name    ,sizeof(pdb_name)     );
+  f.WriteFile ( old_pdb_name,sizeof(old_pdb_name) );
+  f.WriteFile ( element     ,sizeof(element)      );
+  f.WriteFile ( energyType  ,sizeof(energyType)   );
   f.WriteReal ( &x                            );
   f.WriteReal ( &y                            );
   f.WriteReal ( &z                            );
@@ -162,6 +165,9 @@
   f.ReadInt  ( &Version                      );
   f.ReadFile ( sca_name  ,sizeof(sca_name)   );
   f.ReadFile ( pdb_name  ,sizeof(pdb_name)   );
+  if (Version>4)
+    f.ReadFile ( old_pdb_name,sizeof(old_pdb_name) );
+  else  strcpy ( old_pdb_name,pdb_name );
   f.ReadFile ( element   ,sizeof(element)    );
   f.ReadFile ( energyType,sizeof(energyType) );
   f.ReadReal ( &x                            );
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_sbase0.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_sbase0.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_sbase0.h	2006-08-16 03:55:20.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_sbase0.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,10 +1,10 @@
-//  $Id: mmdb_sbase0.h,v 1.7 2006/08/16 10:55:20 fr45 Exp $
+//  $Id: mmdb_sbase0.h,v 1.5 2007/08/15 10:59:32 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
 //   functionality in protein crystallography applications.
 //
-//   Copyright (C) Eugene Krissinel 2000-2006.
+//   Copyright (C) Eugene Krissinel 2000-2007.
 //
 //   This code is distributed under the terms and conditions of the
 //   CCP4 Program Suite Licence Agreement as a CCP4 Library.
@@ -13,7 +13,7 @@
 //
 //  =================================================================
 //
-//    21.02.06   <--  Date of Last Modification.
+//    14.08.07   <--  Date of Last Modification.
 //                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 //  -----------------------------------------------------------------
 //
@@ -25,7 +25,7 @@
 //                  CSBStructure ( SB structure (monomer) class )
 //                  CSBIndex     ( SB index class               )
 //
-//    E. Krissinel 2001-2006
+//    (C) E. Krissinel 2001-2007
 //
 //  =================================================================
 //
@@ -78,6 +78,7 @@
   public :
     char sca_name  [sca_name_len+1];    // SCA atom name
     char pdb_name  [pdb_name_len+1];    // PDB atom name (aligned)
+    char old_pdb_name[pdb_name_len+1];  // old PDB atom name (aligned)
     char element   [element_len+1];     // chemical element (aligned)
     char energyType[energy_type_len+1]; // energy type; set to empty
                                         // string "" if not provided
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_selmngr.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_selmngr.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_selmngr.cpp	2006-08-16 03:55:21.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_selmngr.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_selmngr.cpp,v 1.15 2006/08/16 10:55:21 fr45 Exp $
+//  $Id: mmdb_selmngr.cpp,v 1.24 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -777,7 +777,7 @@
 }
 
 
-#define  hetIndicator ''
+#define  hetIndicator '@'
 
 void  CMMDBSelManager::Select (
              int      selHnd,   // must be obtained from NewSelection()
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_selmngr.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_selmngr.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_selmngr.h	2006-08-16 03:55:21.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_selmngr.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_selmngr.h,v 1.14 2006/08/16 10:55:21 fr45 Exp $
+//  $Id: mmdb_selmngr.h,v 1.13 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_symop.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_symop.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_symop.cpp	2006-08-16 03:55:21.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_symop.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_symop.cpp,v 1.16 2006/08/16 10:55:21 fr45 Exp $
+//  $Id: mmdb_symop.cpp,v 1.13 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_symop.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_symop.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_symop.h	2007-07-09 08:45:44.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_symop.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_symop.h,v 1.14 2007/07/09 15:45:44 ccb Exp $
+//  $Id: mmdb_symop.h,v 1.10 2007/01/08 16:42:41 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_tables.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_tables.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_tables.cpp	2006-08-16 03:55:21.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_tables.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_tables.cpp,v 1.16 2006/08/16 10:55:21 fr45 Exp $
+//  $Id: mmdb_tables.cpp,v 1.13 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_tables.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_tables.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_tables.h	2006-08-16 03:55:22.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_tables.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_tables.h,v 1.16 2006/08/16 10:55:22 fr45 Exp $
+//  $Id: mmdb_tables.h,v 1.12 2007/08/15 10:59:32 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
@@ -31,7 +31,7 @@
 //                   RName1 ( 1-characters amino acid names         )
 //
 //
-//  E. Krissinel  2001-2002
+//  (C) E. Krissinel  2001-2002
 //
 //  =================================================================
 //
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_title.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_title.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_title.cpp	2006-08-16 03:55:22.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_title.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_title.cpp,v 1.14 2006/08/16 10:55:22 fr45 Exp $
+//  $Id: mmdb_title.cpp,v 1.9 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_title.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_title.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_title.h	2006-08-16 03:55:22.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_title.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_title.h,v 1.13 2006/08/16 10:55:22 fr45 Exp $
+//  $Id: mmdb_title.h,v 1.7 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_uddata.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_uddata.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_uddata.cpp	2006-08-16 03:55:22.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_uddata.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_uddata.cpp,v 1.12 2006/08/16 10:55:22 fr45 Exp $
+//  $Id: mmdb_uddata.cpp,v 1.8 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_uddata.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_uddata.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_uddata.h	2006-08-16 03:55:22.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_uddata.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_uddata.h,v 1.12 2006/08/16 10:55:22 fr45 Exp $
+//  $Id: mmdb_uddata.h,v 1.5 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_utils.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_utils.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_utils.cpp	2006-08-16 03:55:22.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_utils.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_utils.cpp,v 1.22 2006/08/16 10:55:22 fr45 Exp $
+//  $Id: mmdb_utils.cpp,v 1.23 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_utils.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_utils.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_utils.h	2006-08-16 03:55:22.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_utils.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_utils.h,v 1.17 2006/08/16 10:55:22 fr45 Exp $
+//  $Id: mmdb_utils.h,v 1.15 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_xml.cpp ccp4-onlylibs-dev/lib/src/mmdb/mmdb_xml.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_xml.cpp	2006-08-16 03:55:23.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_xml.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_xml.cpp,v 1.17 2006/08/16 10:55:23 fr45 Exp $
+//  $Id: mmdb_xml.cpp,v 1.10 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_xml.h ccp4-onlylibs-dev/lib/src/mmdb/mmdb_xml.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/mmdb_xml.h	2006-08-16 03:55:23.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/mmdb_xml.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: mmdb_xml.h,v 1.13 2006/08/16 10:55:23 fr45 Exp $
+//  $Id: mmdb_xml.h,v 1.5 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/random_n.cpp ccp4-onlylibs-dev/lib/src/mmdb/random_n.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/random_n.cpp	2006-08-16 03:55:23.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/random_n.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: random_n.cpp,v 1.11 2006/08/16 10:55:23 fr45 Exp $
+//  $Id: random_n.cpp,v 1.4 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/random_n.h ccp4-onlylibs-dev/lib/src/mmdb/random_n.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/random_n.h	2006-08-16 03:55:23.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/random_n.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: random_n.h,v 1.11 2006/08/16 10:55:23 fr45 Exp $
+//  $Id: random_n.h,v 1.4 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/stream_.cpp ccp4-onlylibs-dev/lib/src/mmdb/stream_.cpp
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/stream_.cpp	2006-08-16 03:55:23.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/stream_.cpp	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: stream_.cpp,v 1.12 2006/08/16 10:55:23 fr45 Exp $
+//  $Id: stream_.cpp,v 1.4 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
diff -ruN ccp4-onlylibs-dev-orig/lib/src/mmdb/stream_.h ccp4-onlylibs-dev/lib/src/mmdb/stream_.h
--- ccp4-onlylibs-dev-orig/lib/src/mmdb/stream_.h	2006-08-16 03:55:23.000000000 -0700
+++ ccp4-onlylibs-dev/lib/src/mmdb/stream_.h	2007-10-21 22:33:35.000000000 -0700
@@ -1,4 +1,4 @@
-//  $Id: stream_.h,v 1.12 2006/08/16 10:55:23 fr45 Exp $
+//  $Id: stream_.h,v 1.4 2006/07/28 10:57:24 keb Exp $
 //  =================================================================
 //
 //   CCP4 Coordinate Library: support of coordinate-related
