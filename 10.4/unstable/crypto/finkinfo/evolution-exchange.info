Package: evolution-exchange
Version: 2.21.1
Revision: 2
Source-MD5: 18081eeccc0f47e3c358809b4547a0de
Source: mirror:gnome:sources/%n/2.21/%n-%v.tar.bz2
BuildDepends: <<
 atk1, audiofile, avahi-dev, cyrus-sasl2-dev, db44-aes, dbus-dev, esound, evolution-2.12-dev, evolution-data-server-1.12-dev,
 expat1, fontconfig2-dev, freetype219, gail18-dev, gconf2-dev, gettext-tools, glib2-dev, glitz, gnome-keyring-dev, 
 gnome-vfs2-unified-dev, gnutls26, gtk-doc, gtk+2-dev, gtkhtml3.14-dev, intltool, libart2, libavahi-glib1-dev, libbonobo2-dev,
 libbonoboui2-dev, libgcrypt, libgettext3-dev, libglade2, libgnome2-dev, libgnomecanvas2-dev, libgnomeprint2.2-dev,
 libgnomeprintui2.2-dev, libgnomeui2-dev, libgpg-error, libhowl-dev, libiconv-dev, libjpeg, libpng3, libsoup2.2.8-ssl,
 libtasn1-3, libxml2, openldap23-dev, openssl098-dev, orbit2-dev, pango1-xft2-ft219-dev (>= 1.18.4-4), pkgconfig, popt, pth2-dev,
 seamonkey-dev, x11-dev, sed
<<
Depends: evolution
Conflicts: ximian-connector
Replaces: ximian-connector
NoSetLDFLAGS: true
SetLDFLAGS: -L%p/lib/pango-ft219/lib -L%p/lib/freetype219/lib -L%p/lib/fontconfig2/lib -L%p/lib/seamonkey
SetLIBRARY_PATH: %p/lib:/usr/X11R6/lib
NoSetCPPFLAGS: true
SetCPPFLAGS: -I%p/lib/pango-ft219/include/pango-1.0 -I%p/lib/pango-ft219/include -I%p/lib/freetype219/include -I%p/lib/freetype219/include/freetype2 -I%p/lib/fontconfig2/include -I%p/include/seamonkey/nspr -I%p/include/seamonkey/nss
SetCFLAGS: -O3 -DLDAP_DEPRECATED=1
# no -fstrict-aliasing, else "dereferencing type-punned pointer will break strict-aliasing rules" warning
NoSetMAKEFLAGS: true
SetMAKEFLAGS: -j1
PatchScript: <<
#!/bin/sh -ev
  perl -pi.bak -e 's,libdir\)/locale,datadir)/locale,' po/Makefile.in.in
  perl -pi -e 's/hardcode_direct=yes/hardcode_direct=no/g' configure
  perl -pi.bak -e 's,unistd.h>,$&\n\#include <string.h>,' mail/mail-stub-listener.c
  perl -pi.bak -e 's,session.h>,$&\n\#include "camel/camel-exchange-summary.h",' camel/camel-exchange-store.c
# cf e-d-s for next :
  for f in `find . -name ltmain.sh` ; do sed -ri.bak -e 's,(s%%/)(\[\^/\]\*\$%%%%),\1\\+\2,' $f ; done
  for f in `find . -name configure` ; do sed -ri.bak -e '/(host_os ld.so|Apple)/,+3{
/sys_lib_search_path_spec.*\/usr\/local\/lib/c\
sys_lib_search_path_spec=$(echo $(for f in `$CC -print-search-dirs|egrep "^libraries:"|sed -e "s,.*=,," -e "s,$PATH_SEPARATOR, ,g" -e "s,$, /lib /usr/lib /usr/local/lib,"`; do cd $f 2>/dev/null && pwd || : ; done|uniq))
}' $f ; done
<<
ConfigureParams: --libexecdir=%p/sbin --enable-static=yes --enable-gtk-doc --mandir=%p/share/man --with-openldap=yes --with-krb5=/usr --enable-maintainer-mode --enable-compile-warnings=yes
CompileScript: <<
#!/bin/sh -ev
  export CPATH=%p/include:/usr/X11R6/include
  export PKG_CONFIG_PATH=%p/lib/pango-ft219/lib/pkgconfig:%p/lib/fontconfig2/lib/pkgconfig:%p/lib/freetype219/lib/pkgconfig:$PKG_CONFIG_PATH
  ./configure %c
  perl -pi -e 's,\-L(/usr|%p)/lib([^/]),\2,g; s/-Wl\\,-R[^ ]*//g; s,\-I(/usr|%p)/include([^/]),\2,g' config.status
  make
  make -i check
<<
InstallScript: make DESTDIR=%d install
DocFiles: AUTHORS COPYING NEWS README
Description: Advanced email client
DescPort: <<
 Original package and port for evolution < 1.4 by Max Horn
<<
DescPackaging: <<
config.status thing is to avoid a BuildConflict with libytnef-dev (and possibly others).
--enable-maintainer-mode is to make the config-status thing work.
<<
Homepage: http://gnome.org/projects/evolution/
License: GPL
Maintainer: The Gnome Core Team <fink-gnome-core@lists.sourceforge.net>

